
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{Wombat\_WP2\_3yr\_74}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \hypertarget{with-gm-wombat-jun16z-wed-poly-maude-rise-wind-isolation-3yr-perturbation}{%
\subsection{1973 with GM Wombat Jun16z Wed Poly Maude Rise wind
isolation 3yr
perturbation}\label{with-gm-wombat-jun16z-wed-poly-maude-rise-wind-isolation-3yr-perturbation}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{c+c1}{\PYZsh{} Load modules}
        \PY{o}{\PYZpc{}}\PY{k}{pylab} inline
        \PY{k+kn}{from} \PY{n+nn}{netCDF4} \PY{k+kn}{import} \PY{n}{Dataset} \PY{c+c1}{\PYZsh{} to work with NetCDF files}
        \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k+kn}{as} \PY{n+nn}{np}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib.pyplot} \PY{k+kn}{as} \PY{n+nn}{plt} \PY{c+c1}{\PYZsh{} to generate plots}
        \PY{k+kn}{from} \PY{n+nn}{mpl\PYZus{}toolkits.basemap} \PY{k+kn}{import} \PY{n}{Basemap} \PY{c+c1}{\PYZsh{} plot on map projections}
        \PY{k+kn}{from} \PY{n+nn}{os.path} \PY{k+kn}{import} \PY{n}{expanduser}
        \PY{n}{home} \PY{o}{=} \PY{n}{expanduser}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZti{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{} Get users home directory}
        \PY{k+kn}{import} \PY{n+nn}{os} \PY{c+c1}{\PYZsh{} operating system interface}
        \PY{k+kn}{import} \PY{n+nn}{scipy} \PY{k+kn}{as} \PY{n+nn}{sp}
        \PY{k+kn}{import} \PY{n+nn}{xarray} \PY{k+kn}{as} \PY{n+nn}{xr}
        \PY{k+kn}{from} \PY{n+nn}{xarray.ufuncs} \PY{k+kn}{import} \PY{n}{square}\PY{p}{,} \PY{n}{sqrt}
        \PY{k+kn}{import} \PY{n+nn}{scipy.interpolate}
        \PY{k+kn}{import} \PY{n+nn}{scipy.ndimage}
        \PY{k+kn}{import} \PY{n+nn}{scipy.io}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Populating the interactive namespace from numpy and matplotlib

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{c+c1}{\PYZsh{}extract the MOM model grid info \PYZhy{} 50 and 75 vertical levels}
        \PY{n}{hgrid\PYZus{}file} \PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/g/data1/v45/pas561/mom/archive/gfdl\PYZus{}nyf\PYZus{}1080/mom025\PYZus{}ocean\PYZus{}grid.nc}\PY{l+s+s1}{\PYZsq{}}
        \PY{n}{vgrid\PYZus{}file} \PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/g/data1/v45/pas561/mom/archive/gfdl\PYZus{}nyf\PYZus{}1080/ocean.ncra501\PYZhy{}520.nc}\PY{l+s+s1}{\PYZsq{}}
        
        \PY{c+c1}{\PYZsh{} Extract the variables}
        \PY{n}{nc} \PY{o}{=} \PY{n}{Dataset}\PY{p}{(}\PY{n}{hgrid\PYZus{}file}\PY{p}{,} \PY{n}{mode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{} file handle, open in read only mode}
        \PY{n}{geolon\PYZus{}t} \PY{o}{=} \PY{n}{nc}\PY{o}{.}\PY{n}{variables}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{geolon\PYZus{}t}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{]}
        \PY{n}{geolat\PYZus{}t} \PY{o}{=} \PY{n}{nc}\PY{o}{.}\PY{n}{variables}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{geolat\PYZus{}t}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{]}
        \PY{n}{area\PYZus{}t} \PY{o}{=} \PY{n}{nc}\PY{o}{.}\PY{n}{variables}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{area\PYZus{}t}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{]}
        \PY{n}{dxt} \PY{o}{=} \PY{n}{nc}\PY{o}{.}\PY{n}{variables}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dxt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{]}
        \PY{n}{dyt} \PY{o}{=} \PY{n}{nc}\PY{o}{.}\PY{n}{variables}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dyt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{]}
        \PY{n}{kmu} \PY{o}{=} \PY{n}{nc}\PY{o}{.}\PY{n}{variables}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{kmu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{]}
        \PY{n}{kmt} \PY{o}{=} \PY{n}{nc}\PY{o}{.}\PY{n}{variables}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{kmt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{]}
        \PY{n}{ht} \PY{o}{=} \PY{n}{nc}\PY{o}{.}\PY{n}{variables}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ht}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{]}
        \PY{n}{fcor} \PY{o}{=} \PY{n}{nc}\PY{o}{.}\PY{n}{variables}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{f\PYZus{}coriolis}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{]}
        \PY{n}{nc}\PY{o}{.}\PY{n}{close}\PY{p}{(}\PY{p}{)} \PY{c+c1}{\PYZsh{} close the file}
        \PY{k}{print} \PY{n}{geolon\PYZus{}t}\PY{o}{.}\PY{n}{shape}
        
        \PY{n}{fh}\PY{o}{=}\PY{n}{fcor}\PY{o}{/}\PY{n}{ht}
        \PY{k}{print} \PY{n}{fh}\PY{o}{.}\PY{n}{shape}
        
        \PY{n}{nc} \PY{o}{=} \PY{n}{Dataset}\PY{p}{(}\PY{n}{vgrid\PYZus{}file}\PY{p}{,} \PY{n}{mode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{} file handle, open in read only mode}
        \PY{n}{sw\PYZus{}ocean} \PY{o}{=} \PY{n}{nc}\PY{o}{.}\PY{n}{variables}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sw\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{]}
        \PY{n}{st\PYZus{}ocean} \PY{o}{=} \PY{n}{nc}\PY{o}{.}\PY{n}{variables}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{st\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{]}
        \PY{n}{yt\PYZus{}ocean} \PY{o}{=} \PY{n}{nc}\PY{o}{.}\PY{n}{variables}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{]}
        \PY{n}{yu\PYZus{}ocean} \PY{o}{=} \PY{n}{nc}\PY{o}{.}\PY{n}{variables}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yu\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{]}
        \PY{n}{xt\PYZus{}ocean} \PY{o}{=} \PY{n}{nc}\PY{o}{.}\PY{n}{variables}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{]}
        \PY{n}{potrho} \PY{o}{=} \PY{n}{nc}\PY{o}{.}\PY{n}{variables}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{potrho}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{]}
        \PY{n}{nc}\PY{o}{.}\PY{n}{close}\PY{p}{(}\PY{p}{)} \PY{c+c1}{\PYZsh{} close the file}
        \PY{k}{print} \PY{n}{st\PYZus{}ocean}\PY{o}{.}\PY{n}{shape}
        \PY{k}{print} \PY{n}{potrho}\PY{o}{.}\PY{n}{shape}
        \PY{k}{print} \PY{n}{yt\PYZus{}ocean}\PY{o}{.}\PY{n}{shape}
        
        \PY{n}{nc} \PY{o}{=} \PY{n}{Dataset}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/g/data1/v45/pas561/mom/archive/gfdl\PYZus{}nyf\PYZus{}1080/output200/ocean.nc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{mode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{} file handle, open in read only mode}
        \PY{n}{dzt} \PY{o}{=} \PY{n}{nc}\PY{o}{.}\PY{n}{variables}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dzt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}
        \PY{n}{nc}\PY{o}{.}\PY{n}{close}\PY{p}{(}\PY{p}{)} \PY{c+c1}{\PYZsh{} close the file}
        
        \PY{k}{print} \PY{n}{dzt}\PY{o}{.}\PY{n}{shape}
        \PY{c+c1}{\PYZsh{}dzt=np.squeeze(dzt)}
        \PY{c+c1}{\PYZsh{}print dzt.shape}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(1080, 1440)
(1080, 1440)
(50,)
(80,)
(1080,)
(50, 1080, 1440)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{c+c1}{\PYZsh{}A = xr.DataArray(np.arange(100))}
        \PY{c+c1}{\PYZsh{}A.cumsum(axis=0)}
        \PY{k}{print} \PY{p}{(}\PY{n}{xr}\PY{o}{.}\PY{n}{\PYZus{}\PYZus{}version\PYZus{}\PYZus{}}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{}my xarray version is old, no cumsum. Should be version 0.9.2 or newer?}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
0.10.0

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{n}{NYFCntrlDir} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/g/data1/v45/pas561/mom/archive/wombat\PYZus{}jun16z/}\PY{l+s+s1}{\PYZsq{}}
        \PY{c+c1}{\PYZsh{}this has 3 years of a wind perturbation \PYZhy{} get a nice 3 year polynya.}
        \PY{n}{NYFPertDir} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/g/data1/v45/pas561/mom/archive/wombat\PYZus{}jun16z\PYZus{}wp2\PYZus{}74/}\PY{l+s+s1}{\PYZsq{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{n}{Ocean\PYZus{}File} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Tdim\PYZus{}output197*/ocean\PYZus{}\PYZus{}*.nc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{k}{print} \PY{n}{Ocean\PYZus{}File}
        \PY{n}{cntrl}\PY{o}{=}\PY{n}{xr}\PY{o}{.}\PY{n}{open\PYZus{}mfdataset}\PY{p}{(}\PY{n}{Ocean\PYZus{}File}\PY{p}{,}\PY{n}{engine}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{netcdf4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{concat\PYZus{}dim}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{decode\PYZus{}times}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
        \PY{k}{print} \PY{n}{cntrl}\PY{o}{.}\PY{n}{mld}\PY{o}{.}\PY{n}{shape}
        \PY{k}{print} \PY{n}{cntrl}\PY{o}{.}\PY{n}{pot\PYZus{}rho\PYZus{}0}\PY{o}{.}\PY{n}{shape} 
        
        \PY{n}{Ocean\PYZus{}File} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{output*/ocean\PYZus{}\PYZus{}*.nc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{k}{print} \PY{n}{Ocean\PYZus{}File}
        \PY{n}{cntrl2}\PY{o}{=}\PY{n}{xr}\PY{o}{.}\PY{n}{open\PYZus{}mfdataset}\PY{p}{(}\PY{n}{Ocean\PYZus{}File}\PY{p}{,}\PY{n}{engine}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{netcdf4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{concat\PYZus{}dim}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{decode\PYZus{}times}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
        \PY{k}{print} \PY{n}{cntrl2}\PY{o}{.}\PY{n}{mld}\PY{o}{.}\PY{n}{shape}
        \PY{k}{print} \PY{n}{cntrl}\PY{o}{.}\PY{n}{pot\PYZus{}rho\PYZus{}0}\PY{o}{.}\PY{n}{shape} 
        
        
        \PY{n}{Ocean\PYZus{}File} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{output*/ocean\PYZus{}\PYZus{}*.nc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{k}{print} \PY{n}{Ocean\PYZus{}File}
        \PY{n}{pert}\PY{o}{=}\PY{n}{xr}\PY{o}{.}\PY{n}{open\PYZus{}mfdataset}\PY{p}{(}\PY{n}{Ocean\PYZus{}File}\PY{p}{,}\PY{n}{engine}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{netcdf4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{concat\PYZus{}dim}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{decode\PYZus{}times}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
        \PY{k}{print} \PY{n}{pert}\PY{o}{.}\PY{n}{mld}\PY{o}{.}\PY{n}{shape}
        \PY{k}{print} \PY{n}{pert}\PY{o}{.}\PY{n}{pot\PYZus{}rho\PYZus{}0}\PY{o}{.}\PY{n}{shape} 
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
/g/data1/v45/pas561/mom/archive/wombat\_jun16z/Tdim\_output197*/ocean\_\_*.nc
(9, 1080, 1440)
(9, 50, 1080, 1440)
/g/data1/v45/pas561/mom/archive/wombat\_jun16z/output*/ocean\_\_*.nc
(40, 1080, 1440)
(9, 50, 1080, 1440)
/g/data1/v45/pas561/mom/archive/wombat\_jun16z\_wp2\_74/output*/ocean\_\_*.nc
(40, 1080, 1440)
(40, 50, 1080, 1440)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}9}]:} \PY{n}{Ocean\PYZus{}File} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Tdim\PYZus{}output197*/ocean\PYZus{}force*.nc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{k}{print} \PY{n}{Ocean\PYZus{}File}
        \PY{n}{cntrl}\PY{o}{=}\PY{n}{xr}\PY{o}{.}\PY{n}{open\PYZus{}mfdataset}\PY{p}{(}\PY{n}{Ocean\PYZus{}File}\PY{p}{,}\PY{n}{engine}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{netcdf4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{concat\PYZus{}dim}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{decode\PYZus{}times}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
        
        \PY{n}{Ocean\PYZus{}File} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{output*/ocean\PYZus{}force*.nc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{k}{print} \PY{n}{Ocean\PYZus{}File}
        \PY{n}{pert}\PY{o}{=}\PY{n}{xr}\PY{o}{.}\PY{n}{open\PYZus{}mfdataset}\PY{p}{(}\PY{n}{Ocean\PYZus{}File}\PY{p}{,}\PY{n}{engine}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{netcdf4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{concat\PYZus{}dim}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{decode\PYZus{}times}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
/g/data1/v45/pas561/mom/archive/wombat\_jun16z/Tdim\_output197*/ocean\_force*.nc
/g/data1/v45/pas561/mom/archive/wombat\_jun16z\_wp2\_74/output*/ocean\_force*.nc

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{c+c1}{\PYZsh{}plot wind stress}
        \PY{k}{print} \PY{n}{cntrl}\PY{o}{.}\PY{n}{tau\PYZus{}x}\PY{o}{.}\PY{n}{shape}
        \PY{c+c1}{\PYZsh{}cntrl\PYZus{}tx=ff.tau\PYZus{}x.load()}
        \PY{c+c1}{\PYZsh{}cntrl\PYZus{}ty=ff.tau\PYZus{}y.load()}
        
        \PY{k}{print} \PY{n}{pert}\PY{o}{.}\PY{n}{tau\PYZus{}x}\PY{o}{.}\PY{n}{shape}
        \PY{c+c1}{\PYZsh{}pert\PYZus{}tx=ff.tau\PYZus{}x.load()}
        \PY{c+c1}{\PYZsh{}pert\PYZus{}ty=ff.tau\PYZus{}y.load()}
        \PY{c+c1}{\PYZsh{}print pert\PYZus{}tx.shape}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(108, 1080, 1440)
(408, 1080, 1440)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{k}{print} \PY{n}{pert}\PY{o}{.}\PY{n}{tau\PYZus{}x}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{shape}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{12.5}\PY{p}{,}\PY{l+m+mf}{9.5}\PY{p}{)}\PY{p}{)}
        \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}plt.suptitle(\PYZsq{}Wind Stress\PYZsq{})}
        
        \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{o}{.}\PY{l+m+mi}{2}\PY{p}{,}\PY{o}{.}\PY{l+m+mi}{2}\PY{p}{,}\PY{o}{.}\PY{l+m+mo}{01}\PY{p}{)}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{55}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
        \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{)} 
        \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{cntrl}\PY{o}{.}\PY{n}{tau\PYZus{}x}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{12}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
        \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.7)}
        \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}N/m2\PYZsq{})}
        \PY{n}{clev3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{5000}\PY{p}{,}\PY{l+m+mi}{1000}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{ht}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev3}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Control Zonal Wind Stress}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{}clev = np.arange(\PYZhy{}.1,.1,.01)}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{55}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
        \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{)} 
        \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{pert}\PY{o}{.}\PY{n}{tau\PYZus{}x}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{12}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl}\PY{o}{.}\PY{n}{tau\PYZus{}x}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{12}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
        \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.5)}
        \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}N/m2\PYZsq{})}
        \PY{n}{clev3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{5000}\PY{p}{,}\PY{l+m+mi}{1000}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{ht}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev3}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Anomaly}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{n}{ax3} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{axes}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.92}\PY{p}{,}\PY{l+m+mf}{0.38}\PY{p}{,}\PY{l+m+mf}{0.015}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{]}\PY{p}{)}
        \PY{n}{cb} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{p1}\PY{p}{,}\PY{n}{cax}\PY{o}{=}\PY{n}{ax3}\PY{p}{,}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
        \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{N/m2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}tau\PYZus{}x.pdf\PYZsq{})}
        \PY{c+c1}{\PYZsh{}print of}
        \PY{c+c1}{\PYZsh{}plt.savefig(of)}
        \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tau\PYZus{}x.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(1080, 1440)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/mpl\_toolkits/basemap/\_\_init\_\_.py:1711: MatplotlibDeprecationWarning: The axesPatch function was deprecated in version 2.1. Use Axes.patch instead.
  if limb is not ax.axesPatch:
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/dask/array/numpy\_compat.py:45: RuntimeWarning: invalid value encountered in divide
  x = np.divide(x1, x2, out)

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_8_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{o}{.}\PY{l+m+mi}{2}\PY{p}{,}\PY{o}{.}\PY{l+m+mi}{2}\PY{p}{,}\PY{o}{.}\PY{l+m+mo}{01}\PY{p}{)}
        \PY{n}{clev3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{5000}\PY{p}{,}\PY{l+m+mi}{1000}\PY{p}{)}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{321}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}color}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.25}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{p1}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{p}{,}\PY{n}{yt\PYZus{}ocean}\PY{p}{,}\PY{n}{cntrl}\PY{o}{.}\PY{n}{tau\PYZus{}x}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{12}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.7)}
        \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}N/m\PYZca{}2\PYZsq{})}
        \PY{n}{clev3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{5000}\PY{p}{,}\PY{l+m+mi}{1000}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{p}{,}\PY{n}{yt\PYZus{}ocean}\PY{p}{,}\PY{n}{ht}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev3}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{55}\PY{p}{)}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Longitude (\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{})}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Latitude (\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{})}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{l+m+mi}{40}\PY{p}{]}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Control Zonal Wind Stress}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        
        \PY{n}{yrs}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1973}\PY{p}{,}\PY{l+m+mi}{2016}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
        
        \PY{n}{ii}\PY{o}{=}\PY{l+m+mi}{0}
        \PY{k}{for} \PY{n}{yr} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{)}\PY{p}{:}
            
            \PY{c+c1}{\PYZsh{}print yr*12, yr*12+12}
                
            \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{n}{yr}\PY{o}{+}\PY{l+m+mi}{2}\PY{p}{)}
            \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}color}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.25}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            \PY{n}{p1}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{p}{,}\PY{n}{yt\PYZus{}ocean}\PY{p}{,}\PY{n}{pert}\PY{o}{.}\PY{n}{tau\PYZus{}x}\PY{p}{[}\PY{n}{yr}\PY{o}{*}\PY{l+m+mi}{12}\PY{p}{:}\PY{n}{yr}\PY{o}{*}\PY{l+m+mi}{12}\PY{o}{+}\PY{l+m+mi}{12}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl}\PY{o}{.}\PY{n}{tau\PYZus{}x}\PY{p}{[}\PY{n}{yr}\PY{o}{*}\PY{l+m+mi}{12}\PY{p}{:}\PY{n}{yr}\PY{o}{*}\PY{l+m+mi}{12}\PY{o}{+}\PY{l+m+mi}{12}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.7)}
            \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}N/m\PYZca{}2\PYZsq{})}
            \PY{n}{clev3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{5000}\PY{p}{,}\PY{l+m+mi}{1000}\PY{p}{)}
            \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{p}{,}\PY{n}{yt\PYZus{}ocean}\PY{p}{,}\PY{n}{ht}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev3}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
            \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
            \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{55}\PY{p}{)}\PY{p}{)}
            \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Longitude (\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{})}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Latitude (\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{})}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{l+m+mi}{40}\PY{p}{]}\PY{p}{)}
            \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{n}{yr}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
            
            \PY{c+c1}{\PYZsh{}ii+=12}
            
        \PY{n}{ax3} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{axes}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.92}\PY{p}{,}\PY{l+m+mf}{0.38}\PY{p}{,}\PY{l+m+mf}{0.015}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{]}\PY{p}{)}
        \PY{n}{cb} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{p1}\PY{p}{,}\PY{n}{cax}\PY{o}{=}\PY{n}{ax3}\PY{p}{,}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
        \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{N/m\PYZca{}2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}wpm2\PYZus{}cn.pdf\PYZsq{})}
        \PY{c+c1}{\PYZsh{}print of}
        \PY{c+c1}{\PYZsh{}plt.savefig(of)}
        \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}wpm2\PYZus{}cn.png\PYZsq{})}
        \PY{c+c1}{\PYZsh{}plt.savefig(of,dpi=220)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}8}]:} Text(0.5,0,u'N/m\^{}2')
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_9_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}9}]:} \PY{c+c1}{\PYZsh{}plot wind stress curl ... Ekman pumping anomalies.}
        \PY{c+c1}{\PYZsh{}(d(Tau\PYZus{}y/f) /dx \PYZhy{} d(Tau\PYZus{}x/f) / dy) /rho\PYZus{}0}
        
        \PY{c+c1}{\PYZsh{}drhodx=np.gradient(rho[0,:,:,:],dxt,axis=2)}
        \PY{c+c1}{\PYZsh{}print drhodx.shape}
        
        \PY{k}{print} \PY{n}{cntrl}\PY{o}{.}\PY{n}{tau\PYZus{}x}\PY{o}{.}\PY{n}{shape}
        \PY{n}{cntrl\PYZus{}Txf}\PY{o}{=}\PY{n}{cntrl}\PY{o}{.}\PY{n}{tau\PYZus{}x}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{12}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{/}\PY{n}{fcor}
        \PY{n}{cntrl\PYZus{}Tyf}\PY{o}{=}\PY{n}{cntrl}\PY{o}{.}\PY{n}{tau\PYZus{}y}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{12}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{/}\PY{n}{fcor}
        \PY{k}{print} \PY{n}{cntrl\PYZus{}Txf}\PY{o}{.}\PY{n}{shape}
        
        \PY{n}{cntrl\PYZus{}dTyfdx}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{gradient}\PY{p}{(}\PY{n}{cntrl\PYZus{}Tyf}\PY{p}{,}\PY{n}{dxt}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{k}{print} \PY{n}{cntrl\PYZus{}dTyfdx}\PY{o}{.}\PY{n}{shape}
        \PY{n}{cntrl\PYZus{}dTxfdy}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{gradient}\PY{p}{(}\PY{n}{cntrl\PYZus{}Txf}\PY{p}{,}\PY{n}{dyt}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
        \PY{k}{print} \PY{n}{cntrl\PYZus{}dTxfdy}\PY{o}{.}\PY{n}{shape}
        
        \PY{n}{rho0}\PY{o}{=}\PY{l+m+mf}{1035.0}
        \PY{n}{cntrl\PYZus{}we}\PY{o}{=}\PY{p}{(}\PY{n}{cntrl\PYZus{}dTyfdx}\PY{o}{\PYZhy{}}\PY{n}{cntrl\PYZus{}dTxfdy}\PY{p}{)}\PY{o}{/}\PY{n}{rho0}
        
        
        \PY{k}{print} \PY{n}{pert}\PY{o}{.}\PY{n}{tau\PYZus{}x}\PY{o}{.}\PY{n}{shape}
        \PY{n}{pert\PYZus{}Txf}\PY{o}{=}\PY{n}{pert}\PY{o}{.}\PY{n}{tau\PYZus{}x}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{12}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{/}\PY{n}{fcor}
        \PY{n}{pert\PYZus{}Tyf}\PY{o}{=}\PY{n}{pert}\PY{o}{.}\PY{n}{tau\PYZus{}y}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{12}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{/}\PY{n}{fcor}
        \PY{k}{print} \PY{n}{pert\PYZus{}Tyf}\PY{o}{.}\PY{n}{shape}
        
        \PY{n}{pert\PYZus{}dTyfdx}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{gradient}\PY{p}{(}\PY{n}{pert\PYZus{}Tyf}\PY{p}{,}\PY{n}{dxt}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{k}{print} \PY{n}{pert\PYZus{}dTyfdx}\PY{o}{.}\PY{n}{shape}
        \PY{n}{pert\PYZus{}dTxfdy}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{gradient}\PY{p}{(}\PY{n}{pert\PYZus{}Txf}\PY{p}{,}\PY{n}{dyt}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
        \PY{k}{print} \PY{n}{pert\PYZus{}dTxfdy}\PY{o}{.}\PY{n}{shape}
        
        \PY{n}{rho0}\PY{o}{=}\PY{l+m+mf}{1035.0}
        \PY{n}{pert\PYZus{}we}\PY{o}{=}\PY{p}{(}\PY{n}{pert\PYZus{}dTyfdx}\PY{o}{\PYZhy{}}\PY{n}{pert\PYZus{}dTxfdy}\PY{p}{)}\PY{o}{/}\PY{n}{rho0}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(108, 1080, 1440)
(1080, 1440)
(1080, 1440)
(1080, 1440)
(408, 1080, 1440)
(1080, 1440)
(1080, 1440)
(1080, 1440)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{n}{m}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{nanmax}\PY{p}{(}\PY{n}{cntrl\PYZus{}we}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{300}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)}
         \PY{k}{print} \PY{n}{m}
         \PY{n}{m}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{nanmin}\PY{p}{(}\PY{n}{cntrl\PYZus{}we}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{300}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)}
         \PY{k}{print} \PY{n}{m}
         
         \PY{n}{m}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{nanmax}\PY{p}{(}\PY{n}{pert\PYZus{}we}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{300}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)}
         \PY{k}{print} \PY{n}{m}
         \PY{n}{m}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{nanmin}\PY{p}{(}\PY{n}{pert\PYZus{}we}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{300}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)}
         \PY{k}{print} \PY{n}{m}
         
         \PY{c+c1}{\PYZsh{}convert from m/s to m/day}
         \PY{n}{s\PYZus{}day}\PY{o}{=}\PY{l+m+mi}{60}\PY{o}{*}\PY{l+m+mi}{60}\PY{o}{*}\PY{l+m+mi}{24}
         \PY{k}{print} \PY{n}{s\PYZus{}day}
         \PY{n}{cntrl\PYZus{}we}\PY{o}{=}\PY{n}{cntrl\PYZus{}we}\PY{o}{*}\PY{n}{s\PYZus{}day}
         \PY{n}{pert\PYZus{}we}\PY{o}{=}\PY{n}{pert\PYZus{}we}\PY{o}{*}\PY{n}{s\PYZus{}day}
         
         \PY{n}{m}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{nanmax}\PY{p}{(}\PY{n}{cntrl\PYZus{}we}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{300}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)}
         \PY{k}{print} \PY{n}{m}
         \PY{n}{m}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{nanmin}\PY{p}{(}\PY{n}{cntrl\PYZus{}we}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{300}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)}
         \PY{k}{print} \PY{n}{m}
         
         \PY{n}{m}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{nanmax}\PY{p}{(}\PY{n}{pert\PYZus{}we}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{300}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)}
         \PY{k}{print} \PY{n}{m}
         \PY{n}{m}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{nanmin}\PY{p}{(}\PY{n}{pert\PYZus{}we}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{300}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)}
         \PY{k}{print} \PY{n}{m}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
5.95872585237e-05
-5.08694792028e-05
5.88202383991e-05
-5.00777539599e-05
86400
5.14833913645
-4.39512300312
5.08206859768
-4.32671794214

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{k}{print} \PY{n}{cntrl\PYZus{}we}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(1080, 1440)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{12.5}\PY{p}{,}\PY{l+m+mf}{9.5}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Ekman Pumping}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{o}{.}\PY{l+m+mi}{4}\PY{p}{,}\PY{o}{.}\PY{l+m+mi}{4}\PY{p}{,}\PY{o}{.}\PY{l+m+mo}{02}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{50}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
         \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{)} 
         \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{cntrl\PYZus{}we}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cm/s}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{clev3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{5000}\PY{p}{,}\PY{l+m+mi}{1000}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{ht}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev3}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Control}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{50}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
         \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{)} 
         \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{pert\PYZus{}we}\PY{o}{\PYZhy{}}\PY{n}{cntrl\PYZus{}we}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cm/s}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{clev3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{5000}\PY{p}{,}\PY{l+m+mi}{1000}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{ht}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev3}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Anomaly}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}we.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{we.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_13_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{c+c1}{\PYZsh{}plot stamps of sea ice concentration.}
         \PY{n}{Ocean\PYZus{}File} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Tdim\PYZus{}output197*/ice\PYZus{}\PYZus{}*.nc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cntrl\PYZus{}i}\PY{o}{=}\PY{n}{xr}\PY{o}{.}\PY{n}{open\PYZus{}mfdataset}\PY{p}{(}\PY{n}{Ocean\PYZus{}File}\PY{p}{,}\PY{n}{engine}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{netcdf4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{concat\PYZus{}dim}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{decode\PYZus{}times}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         \PY{k}{print} \PY{n}{cntrl\PYZus{}i}\PY{o}{.}\PY{n}{CN}\PY{o}{.}\PY{n}{shape}
         \PY{c+c1}{\PYZsh{}nyf\PYZus{}cn=ff.CN.sum(\PYZsq{}ct\PYZsq{}).load()}
         \PY{c+c1}{\PYZsh{}print nyf\PYZus{}cn.shape}
         
         \PY{n}{Ocean\PYZus{}File} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{output*/ice\PYZus{}\PYZus{}*.nc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{pert\PYZus{}i}\PY{o}{=}\PY{n}{xr}\PY{o}{.}\PY{n}{open\PYZus{}mfdataset}\PY{p}{(}\PY{n}{Ocean\PYZus{}File}\PY{p}{,}\PY{n}{engine}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{netcdf4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{concat\PYZus{}dim}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{decode\PYZus{}times}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         \PY{k}{print} \PY{n}{pert\PYZus{}i}\PY{o}{.}\PY{n}{CN}\PY{o}{.}\PY{n}{shape}
         \PY{c+c1}{\PYZsh{}pert\PYZus{}cn=ff.CN.sum(\PYZsq{}ct\PYZsq{}).load()}
         \PY{c+c1}{\PYZsh{}print pert\PYZus{}cn.shape}
         
         \PY{c+c1}{\PYZsh{}print nyf\PYZus{}cn.shape}
         \PY{c+c1}{\PYZsh{}print pert\PYZus{}cn.shape}
         \PY{c+c1}{\PYZsh{}cn = np.concatenate((nyf\PYZus{}cn[0:12,:],pert\PYZus{}cn),axis=0)}
         \PY{c+c1}{\PYZsh{}print cn.shape}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(108, 5, 1080, 1440)
(408, 5, 1080, 1440)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}15}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{12.5}\PY{p}{,}\PY{l+m+mf}{9.5}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sea Ice Conc.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{tits}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{June}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{July}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Aug.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sept.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Oct.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Nov.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{yrs}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1972}\PY{p}{,}\PY{l+m+mi}{2016}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{k}{print} \PY{n}{tits}
         
         
         \PY{n}{ii}\PY{o}{=}\PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{yr} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{:}
             \PY{c+c1}{\PYZsh{}print yr}
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{11}\PY{p}{)}\PY{p}{:} 
                 
                 \PY{c+c1}{\PYZsh{}print yr*12+i}
             
                 \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{o}{.}\PY{l+m+mi}{1}\PY{p}{)}
                 \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{6}\PY{p}{,}\PY{n}{ii}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}
                 \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}color}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.25}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                 
                 \PY{k}{if} \PY{n}{yr}\PY{o}{==}\PY{l+m+mi}{0}\PY{p}{:}
                     \PY{n}{p1}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{p}{,}\PY{n}{yt\PYZus{}ocean}\PY{p}{,}\PY{n}{cntrl\PYZus{}i}\PY{o}{.}\PY{n}{CN}\PY{p}{[}\PY{n}{yr}\PY{o}{*}\PY{l+m+mi}{12}\PY{o}{+}\PY{n}{i}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ct}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{CMRmap\PYZus{}r}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                 \PY{k}{else}\PY{p}{:}
                     \PY{n}{p1}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{p}{,}\PY{n}{yt\PYZus{}ocean}\PY{p}{,}\PY{n}{pert\PYZus{}i}\PY{o}{.}\PY{n}{CN}\PY{p}{[}\PY{p}{(}\PY{n}{yr}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{*}\PY{l+m+mi}{12}\PY{o}{+}\PY{n}{i}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ct}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{CMRmap\PYZus{}r}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                     
                 \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.7)}
                 \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}Conc.\PYZsq{})}
                 \PY{c+c1}{\PYZsh{}clev3 = np.arange(0,5000,1000)}
                 \PY{c+c1}{\PYZsh{}plt.contour(xt\PYZus{}ocean,yt\PYZus{}ocean,ht,levels=clev3,colors=\PYZsq{}k\PYZsq{},linewidths=0.25)}
                 \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
                 \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{80}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{55}\PY{p}{)}\PY{p}{)}
                 \PY{c+c1}{\PYZsh{}plt.xlabel(\PYZsq{}Longitude (\PYZdl{}\PYZca{}\PYZbs{}circ\PYZdl{})\PYZsq{})}
                 \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{n}{yr}\PY{p}{]}\PY{p}{)}
                 \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{80}\PY{p}{,}\PY{l+m+mi}{40}\PY{p}{]}\PY{p}{)}
                 \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{tits}\PY{p}{[}\PY{n}{i}\PY{o}{\PYZhy{}}\PY{l+m+mi}{5}\PY{p}{]}\PY{p}{)}     
                 \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{axes}\PY{o}{.}\PY{n}{get\PYZus{}xaxis}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{set\PYZus{}ticks}\PY{p}{(}\PY{p}{[}\PY{p}{]}\PY{p}{)}
                 \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{axes}\PY{o}{.}\PY{n}{get\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{set\PYZus{}ticks}\PY{p}{(}\PY{p}{[}\PY{p}{]}\PY{p}{)}
                 
                 \PY{n}{ii}\PY{o}{+}\PY{o}{=}\PY{l+m+mi}{1}
         
         \PY{n}{ax3} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{axes}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.92}\PY{p}{,}\PY{l+m+mf}{0.38}\PY{p}{,}\PY{l+m+mf}{0.015}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{]}\PY{p}{)}
         \PY{n}{cb} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{p1}\PY{p}{,}\PY{n}{cax}\PY{o}{=}\PY{n}{ax3}\PY{p}{,}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Conc.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}cn.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cn.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
['June', 'July', 'Aug.', 'Sept.', 'Oct.', 'Nov.']

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_15_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{n}{Ocean\PYZus{}File} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Tdim\PYZus{}output197*/ocean\PYZus{}\PYZus{}*.nc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{k}{print} \PY{n}{Ocean\PYZus{}File}
        \PY{n}{cntrl}\PY{o}{=}\PY{n}{xr}\PY{o}{.}\PY{n}{open\PYZus{}mfdataset}\PY{p}{(}\PY{n}{Ocean\PYZus{}File}\PY{p}{,}\PY{n}{engine}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{netcdf4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{concat\PYZus{}dim}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{decode\PYZus{}times}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
        \PY{k}{print} \PY{n}{cntrl}\PY{o}{.}\PY{n}{mld}\PY{o}{.}\PY{n}{shape}
        
        \PY{n}{Ocean\PYZus{}File} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{output*/ocean\PYZus{}\PYZus{}*.nc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{k}{print} \PY{n}{Ocean\PYZus{}File}
        \PY{n}{cntrl2}\PY{o}{=}\PY{n}{xr}\PY{o}{.}\PY{n}{open\PYZus{}mfdataset}\PY{p}{(}\PY{n}{Ocean\PYZus{}File}\PY{p}{,}\PY{n}{engine}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{netcdf4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{concat\PYZus{}dim}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{decode\PYZus{}times}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
        \PY{k}{print} \PY{n}{cntrl2}\PY{o}{.}\PY{n}{mld}\PY{o}{.}\PY{n}{shape}
        
        
        \PY{n}{Ocean\PYZus{}File} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{output*/ocean\PYZus{}\PYZus{}*.nc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{k}{print} \PY{n}{Ocean\PYZus{}File}
        \PY{n}{pert}\PY{o}{=}\PY{n}{xr}\PY{o}{.}\PY{n}{open\PYZus{}mfdataset}\PY{p}{(}\PY{n}{Ocean\PYZus{}File}\PY{p}{,}\PY{n}{engine}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{netcdf4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{concat\PYZus{}dim}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{decode\PYZus{}times}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
        \PY{k}{print} \PY{n}{pert}\PY{o}{.}\PY{n}{mld}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
/g/data1/v45/pas561/mom/archive/wombat\_jun16z/Tdim\_output197*/ocean\_\_*.nc
(9, 1080, 1440)
/g/data1/v45/pas561/mom/archive/wombat\_jun16z/output*/ocean\_\_*.nc
(40, 1080, 1440)
/g/data1/v45/pas561/mom/archive/wombat\_jun16z\_wp2\_74/output*/ocean\_\_*.nc
(40, 1080, 1440)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{k}{print} \PY{n}{cntrl}\PY{o}{.}\PY{n}{mld}\PY{o}{.}\PY{n}{shape}
        \PY{k}{print} \PY{n}{cntrl2}\PY{o}{.}\PY{n}{mld}\PY{o}{.}\PY{n}{shape}
        \PY{k}{print} \PY{n}{pert}\PY{o}{.}\PY{n}{mld}\PY{o}{.}\PY{n}{shape}
        \PY{n}{numyrs}\PY{o}{=}\PY{n}{pert}\PY{o}{.}\PY{n}{mld}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
        \PY{k}{print} \PY{n}{numyrs}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(9, 1080, 1440)
(40, 1080, 1440)
(38, 1080, 1440)
38

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}23}]:} \PY{c+c1}{\PYZsh{}plot MLD}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{12.5}\PY{p}{,}\PY{l+m+mf}{9.5}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{MLD}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{2000}\PY{p}{,}\PY{l+m+mi}{50}\PY{p}{)}
         \PY{n}{yrs}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1972}\PY{p}{,}\PY{l+m+mi}{2018}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{4}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{55}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
         \PY{c+c1}{\PYZsh{}map.drawparallels(np.arange(\PYZhy{}80.,81.,15.))}
         \PY{c+c1}{\PYZsh{}map.drawmeridians(np.arange(\PYZhy{}160.,181.,40.),labels=[True,True,True,True])}
         \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{)} 
         \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{cntrl}\PY{o}{.}\PY{n}{mld}\PY{p}{[}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
         \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.7)}
         \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}N/m2\PYZsq{})}
         \PY{n}{clev3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{5000}\PY{p}{,}\PY{l+m+mi}{1000}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{ht}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev3}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NYF 10yr Avg.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{k}{print} \PY{n}{numyrs}
         \PY{n}{ii}\PY{o}{=}\PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{yr} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{15}\PY{p}{)}\PY{p}{:}
             \PY{c+c1}{\PYZsh{}print yr}
         
             \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{4}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{,}\PY{n}{yr}\PY{o}{+}\PY{l+m+mi}{2}\PY{p}{)}
             \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{55}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
             \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
             \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
             \PY{c+c1}{\PYZsh{}map.drawparallels(np.arange(\PYZhy{}80.,81.,15.))}
             \PY{c+c1}{\PYZsh{}map.drawmeridians(np.arange(\PYZhy{}160.,181.,40.),labels=[True,True,True,True])}
             \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{)} 
             \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{pert}\PY{o}{.}\PY{n}{mld}\PY{p}{[}\PY{n}{yr}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
             \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.5)}
             \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}N/m2\PYZsq{})}
             \PY{n}{clev3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{5000}\PY{p}{,}\PY{l+m+mi}{1000}\PY{p}{)}
             \PY{n+nb}{map}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{ht}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev3}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{n}{yr}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
         
         \PY{n}{ax3} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{axes}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.95}\PY{p}{,}\PY{l+m+mf}{0.38}\PY{p}{,}\PY{l+m+mf}{0.015}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{]}\PY{p}{)}
         \PY{n}{cb} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{p1}\PY{p}{,}\PY{n}{cax}\PY{o}{=}\PY{n}{ax3}\PY{p}{,}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{m}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}mld.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mld.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
34

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_18_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}27}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{12.5}\PY{p}{,}\PY{l+m+mf}{9.5}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{MLD}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{100}\PY{p}{,}\PY{l+m+mi}{2000}\PY{p}{,}\PY{l+m+mi}{100}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{55}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
         \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{)} 
         \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{cntrl}\PY{o}{.}\PY{n}{mld}\PY{p}{[}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{m}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{clev3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{5000}\PY{p}{,}\PY{l+m+mi}{1000}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{ht}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev3}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NYF 10yr Avg.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{55}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
         \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{)} 
         \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{pert}\PY{o}{.}\PY{n}{mld}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{l+m+mi}{4}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{m}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{clev3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1000}\PY{p}{,}\PY{l+m+mi}{5001}\PY{p}{,}\PY{l+m+mi}{1000}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{ht}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev3}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{MLD 1974\PYZhy{}1976}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}mld\PYZus{}1975anom.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mld\PYZus{}1974\PYZhy{}76.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_19_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{calc-the-gmoc-from-ty_trans_rho}{%
\subsection{Calc the GMOC from
ty\_trans\_rho}\label{calc-the-gmoc-from-ty_trans_rho}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}28}]:} \PY{k}{print} \PY{n}{pert}\PY{o}{.}\PY{n}{ty\PYZus{}trans\PYZus{}rho}\PY{o}{.}\PY{n}{shape}
         
         \PY{c+c1}{\PYZsh{}pert\PYZus{}gmoc=pert.ty\PYZus{}trans\PYZus{}rho[:,:,:,:].sum(\PYZsq{}grid\PYZus{}xt\PYZus{}ocean\PYZsq{}).cumsum(\PYZsq{}potrho\PYZsq{}).load()}
         
         \PY{c+c1}{\PYZsh{}print pert\PYZus{}gmoc.shape}
         
         \PY{c+c1}{\PYZsh{}of=os.path.join(NYFPertDir,\PYZsq{}gmoc\PYZus{}adv\PYZus{}rho.npy\PYZsq{})}
         \PY{c+c1}{\PYZsh{}a=np.save(of,pert\PYZus{}gmoc)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(34, 80, 1080, 1440)
(34, 80, 1080)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}56}]:} \PY{k}{print} \PY{n}{cntrl}\PY{o}{.}\PY{n}{ty\PYZus{}trans\PYZus{}rho}\PY{o}{.}\PY{n}{shape}
         \PY{n}{cntrl\PYZus{}gmoc}\PY{o}{=}\PY{n}{cntrl}\PY{o}{.}\PY{n}{ty\PYZus{}trans\PYZus{}rho}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{grid\PYZus{}xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{cumsum}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{potrho}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
         \PY{k}{print} \PY{n}{cntrl\PYZus{}gmoc}\PY{o}{.}\PY{n}{shape}
         
         \PY{k}{print} \PY{n}{cntrl2}\PY{o}{.}\PY{n}{ty\PYZus{}trans\PYZus{}rho}\PY{o}{.}\PY{n}{shape}
         \PY{n}{cntrl2\PYZus{}gmoc}\PY{o}{=}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{ty\PYZus{}trans\PYZus{}rho}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{grid\PYZus{}xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{cumsum}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{potrho}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
         \PY{k}{print} \PY{n}{cntrl2\PYZus{}gmoc}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{cntrl\PYZus{}gmoc}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{concatenate}\PY{p}{(}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc}\PY{p}{,}\PY{n}{cntrl2\PYZus{}gmoc}\PY{p}{)}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{k}{print} \PY{n}{cntrl\PYZus{}gmoc}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gmoc\PYZus{}adv\PYZus{}rho.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{a}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{cntrl\PYZus{}gmoc}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(9, 80, 1080, 1440)
(9, 80, 1080)
(40, 80, 1080, 1440)
(40, 80, 1080)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{k}{print} \PY{n}{cntrl\PYZus{}gmoc}\PY{o}{.}\PY{n}{shape}
         \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gmoc\PYZus{}adv\PYZus{}rho.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{a}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{cntrl\PYZus{}gmoc}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]

        ---------------------------------------------------------------------------

        NameError                                 Traceback (most recent call last)

        <ipython-input-12-1f9eb1adb75b> in <module>()
    ----> 1 print cntrl\_gmoc.shape
          2 of=os.path.join(NYFCntrlDir,'gmoc\_adv\_rho.npy')
          3 a=np.save(of,cntrl\_gmoc)


        NameError: name 'cntrl\_gmoc' is not defined

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{c+c1}{\PYZsh{}load gmoc in rho space}
         \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gmoc\PYZus{}adv\PYZus{}rho.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{pert\PYZus{}gmoc}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n}{of}\PY{p}{)}
         \PY{k}{print} \PY{n}{pert\PYZus{}gmoc}\PY{o}{.}\PY{n}{shape}
         
         \PY{c+c1}{\PYZsh{}of=os.path.join(NYFCntrlDir,\PYZsq{}cntrl\PYZus{}gmocs.npy\PYZsq{})}
         \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gmoc\PYZus{}adv\PYZus{}rho.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cntrl\PYZus{}gmoc}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n}{of}\PY{p}{)}
         \PY{k}{print} \PY{n}{cntrl\PYZus{}gmoc}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(34, 80, 1080)
(49, 80, 1080)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{k}{print} \PY{n}{cntrl}\PY{o}{.}\PY{n}{ty\PYZus{}trans\PYZus{}rho\PYZus{}gm}\PY{o}{.}\PY{n}{shape}
        \PY{n}{cntrl\PYZus{}gmoc\PYZus{}gm}\PY{o}{=}\PY{n}{cntrl}\PY{o}{.}\PY{n}{ty\PYZus{}trans\PYZus{}rho\PYZus{}gm}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{grid\PYZus{}xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
        \PY{k}{print} \PY{n}{cntrl\PYZus{}gmoc\PYZus{}gm}\PY{o}{.}\PY{n}{shape}
        
        \PY{c+c1}{\PYZsh{}no cntrl gm past 1979}
        \PY{c+c1}{\PYZsh{}print cntrl2.ty\PYZus{}trans\PYZus{}rho\PYZus{}gm.shape}
        \PY{c+c1}{\PYZsh{}cntrl2\PYZus{}gmoc\PYZus{}gm=cntrl2.ty\PYZus{}trans\PYZus{}rho\PYZus{}gm[:,:,:,:].sum(\PYZsq{}grid\PYZus{}xt\PYZus{}ocean\PYZsq{}).load()}
        \PY{c+c1}{\PYZsh{}print cntrl2\PYZus{}gmoc\PYZus{}gm.shape}
        
        \PY{c+c1}{\PYZsh{}cntrl\PYZus{}gmoc\PYZus{}gm=np.concatenate((cntrl\PYZus{}gmoc\PYZus{}gm,cntrl2\PYZus{}gmoc\PYZus{}gm),axis=0)}
        
        \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gmoc\PYZus{}gm\PYZus{}rho.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{a}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{cntrl\PYZus{}gmoc\PYZus{}gm}\PY{p}{)}
        
        
        \PY{c+c1}{\PYZsh{}of=os.path.join(NYFCntrlDir,\PYZsq{}gmoc\PYZus{}rho\PYZus{}gm.npy\PYZsq{})}
        \PY{c+c1}{\PYZsh{}a=np.save(of,cntrl\PYZus{}gmoc\PYZus{}gm)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}77}]:} \PY{k}{print} \PY{n}{pert}\PY{o}{.}\PY{n}{ty\PYZus{}trans\PYZus{}rho\PYZus{}gm}\PY{o}{.}\PY{n}{shape}
         \PY{n}{pert\PYZus{}gmoc\PYZus{}gm}\PY{o}{=}\PY{n}{pert}\PY{o}{.}\PY{n}{ty\PYZus{}trans\PYZus{}rho\PYZus{}gm}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{grid\PYZus{}xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
         \PY{k}{print} \PY{n}{pert\PYZus{}gmoc\PYZus{}gm}\PY{o}{.}\PY{n}{shape}
         \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gmoc\PYZus{}gm\PYZus{}rho.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{a}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{pert\PYZus{}gmoc\PYZus{}gm}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(34, 80, 1080, 1440)
(34, 80, 1080)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gmoc\PYZus{}gm\PYZus{}rho.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cntrl\PYZus{}gmoc\PYZus{}gm}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n}{of}\PY{p}{)}
         \PY{k}{print} \PY{n}{cntrl\PYZus{}gmoc\PYZus{}gm}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gmoc\PYZus{}gm\PYZus{}rho.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{pert\PYZus{}gmoc\PYZus{}gm}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n}{of}\PY{p}{)}
         \PY{k}{print} \PY{n}{pert\PYZus{}gmoc\PYZus{}gm}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(9, 80, 1080)
(34, 80, 1080)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{n}{yrs}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1973}\PY{p}{,}\PY{l+m+mi}{2016}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{k}{print} \PY{n}{yrs}
        \PY{k}{print} \PY{n}{yrs}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[1973 1974 1975 1976 1977 1978 1979 1980 1981 1982 1983 1984 1985 1986 1987
 1988 1989 1990 1991 1992 1993 1994 1995 1996 1997 1998 1999 2000 2001 2002
 2003 2004 2005 2006 2007 2008 2009 2010 2011 2012 2013 2014 2015]
['1973' '1974' '1975' '1976' '1977' '1978' '1979' '1980' '1981' '1982'
 '1983' '1984' '1985' '1986' '1987' '1988' '1989' '1990' '1991' '1992'
 '1993' '1994' '1995' '1996' '1997' '1998' '1999' '2000' '2001' '2002'
 '2003' '2004' '2005' '2006' '2007' '2008' '2009' '2010' '2011' '2012'
 '2013' '2014' '2015']

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}70}]:} \PY{c+c1}{\PYZsh{}plot gmoc adv in rho space}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{9.5}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.suptitle(\PYZsq{}Advective GMOC\PYZsq{})}
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{30}\PY{p}{,}\PY{l+m+mi}{32}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         
         \PY{n}{t1}\PY{o}{=}\PY{l+m+mi}{0}
         \PY{n}{t2}\PY{o}{=}\PY{l+m+mi}{9}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{541}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{p}{[}\PY{l+m+mf}{0.0}\PY{p}{,}\PY{p}{]}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{(}\PY{l+m+mf}{1037.2}\PY{p}{,}\PY{l+m+mi}{1036}\PY{p}{)}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Density (kg m\PYZdl{}\PYZca{}\PYZob{}\PYZhy{}3\PYZcb{}\PYZdl{})}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Latitude (\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{})}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{)}
         \PY{n}{tit}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NYF 10yr Avg}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{tit}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{1036.86}\PY{p}{,}\PY{l+m+mf}{1036.86}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         
         \PY{n}{ii}\PY{o}{=}\PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{yr} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{19}\PY{p}{)}\PY{p}{:}
             
             \PY{c+c1}{\PYZsh{}np.mean(pert\PYZus{}gmoc[t1:t2,:,:],axis=0)\PYZhy{}np.mean(cntrl\PYZus{}gmoc[t1:t2,:,:],axis=0)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{,}\PY{n}{yr}\PY{o}{+}\PY{l+m+mi}{2}\PY{p}{)}
             \PY{n}{p1}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{pert\PYZus{}gmoc}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.7)}
             \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}Sv\PYZsq{})}
             \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{pert\PYZus{}gmoc}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{pert\PYZus{}gmoc}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{p}{[}\PY{l+m+mf}{0.0}\PY{p}{,}\PY{p}{]}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{(}\PY{l+m+mf}{1037.2}\PY{p}{,}\PY{l+m+mi}{1036}\PY{p}{)}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}plt.ylabel(\PYZsq{}Density (kg m\PYZdl{}\PYZca{}\PYZob{}\PYZhy{}3\PYZcb{}\PYZdl{})\PYZsq{})}
             \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Latitude (\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{})}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{)}
             \PY{n}{tit}\PY{o}{=}\PY{n}{yrs}\PY{p}{[}\PY{n}{yr}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{n}{yr}\PY{p}{]}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{1036.86}\PY{p}{,}\PY{l+m+mf}{1036.86}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         
         \PY{n}{ax3} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{axes}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.99}\PY{p}{,}\PY{l+m+mf}{0.38}\PY{p}{,}\PY{l+m+mf}{0.015}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{]}\PY{p}{)}
         \PY{n}{cb} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{p1}\PY{p}{,}\PY{n}{cax}\PY{o}{=}\PY{n}{ax3}\PY{p}{,}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}wpm2\PYZus{}cn.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}wpm2\PYZus{}cn.png\PYZsq{})}
         \PY{c+c1}{\PYZsh{}plt.savefig(of,dpi=220)}
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}gmoc.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gmoc\PYZus{}adv.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_29_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}15}]:} \PY{c+c1}{\PYZsh{}plot gmoc anom in rho space}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{9.5}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.suptitle(\PYZsq{}GMOC Adv Anomaly\PYZsq{})}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{30}\PY{p}{,}\PY{l+m+mi}{32}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         
         \PY{n}{t1}\PY{o}{=}\PY{l+m+mi}{0}
         \PY{n}{t2}\PY{o}{=}\PY{l+m+mi}{9}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{541}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{p}{[}\PY{l+m+mf}{0.0}\PY{p}{,}\PY{p}{]}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{(}\PY{l+m+mf}{1037.2}\PY{p}{,}\PY{l+m+mf}{1036.4}\PY{p}{)}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Density (kg m\PYZdl{}\PYZca{}\PYZob{}\PYZhy{}3\PYZcb{}\PYZdl{})}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Latitude (\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{})}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{)}
         \PY{n}{tit}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Control}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{tit}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{1036.86}\PY{p}{,}\PY{l+m+mf}{1036.86}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{yrs}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1973}\PY{p}{,}\PY{l+m+mi}{2016}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{ii}\PY{o}{=}\PY{l+m+mi}{0}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mf}{5.25}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{)}
         
         
         \PY{k}{for} \PY{n}{yr} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{19}\PY{p}{)}\PY{p}{:}
             
             \PY{c+c1}{\PYZsh{}np.mean(pert\PYZus{}gmoc[t1:t2,:,:],axis=0)\PYZhy{}np.mean(cntrl\PYZus{}gmoc[t1:t2,:,:],axis=0)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{,}\PY{n}{yr}\PY{o}{+}\PY{l+m+mi}{2}\PY{p}{)}
             \PY{n}{p1}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{pert\PYZus{}gmoc}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{n}{cntrl\PYZus{}gmoc}\PY{p}{[}\PY{n}{yr}\PY{o}{+}\PY{l+m+mi}{3}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.7)}
             \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}Sv\PYZsq{})}
             \PY{c+c1}{\PYZsh{}plt.contour(yu\PYZus{}ocean,potrho,pert\PYZus{}gmoc[yr,:,:]\PYZhy{}cntrl\PYZus{}gmoc[yr,:,:],levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=0.25)}
             \PY{c+c1}{\PYZsh{}plt.contour(yu\PYZus{}ocean,potrho,pert\PYZus{}gmoc[yr,:,:]\PYZhy{}cntrl\PYZus{}gmoc[yr,:,:],levels=[0.0,],colors=\PYZsq{}k\PYZsq{},linewidths=0.5)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{(}\PY{l+m+mf}{1037.2}\PY{p}{,}\PY{l+m+mf}{1036.4}\PY{p}{)}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}plt.ylabel(\PYZsq{}Density (kg m\PYZdl{}\PYZca{}\PYZob{}\PYZhy{}3\PYZcb{}\PYZdl{})\PYZsq{})}
             \PY{c+c1}{\PYZsh{}plt.xlabel(\PYZsq{}Latitude (\PYZdl{}\PYZca{}\PYZbs{}circ\PYZdl{})\PYZsq{})}
             \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{)}
             \PY{n}{tit}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Anom. }\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{yrs}\PY{p}{[}\PY{n}{yr}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{n}{yr}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{1036.86}\PY{p}{,}\PY{l+m+mf}{1036.86}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
             
         \PY{n}{ax3} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{axes}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.99}\PY{p}{,}\PY{l+m+mf}{0.38}\PY{p}{,}\PY{l+m+mf}{0.015}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{]}\PY{p}{)}
         \PY{n}{cb} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{p1}\PY{p}{,}\PY{n}{cax}\PY{o}{=}\PY{n}{ax3}\PY{p}{,}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}wpm2\PYZus{}cn.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}wpm2\PYZus{}cn.png\PYZsq{})}
         \PY{c+c1}{\PYZsh{}plt.savefig(of,dpi=220)}
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}gmoc\PYZus{}anom.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gmoc\PYZus{}adv\PYZus{}anom.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/matplotlib/figure.py:1999: UserWarning: This figure includes Axes that are not compatible with tight\_layout, so results might be incorrect.
  warnings.warn("This figure includes Axes that are not compatible "

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_30_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}83}]:} \PY{c+c1}{\PYZsh{}plot GM gmoc in rho space}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{9.5}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Annual Mean GM GMOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{30}\PY{p}{,}\PY{l+m+mi}{32}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         
         \PY{n}{t1}\PY{o}{=}\PY{l+m+mi}{0}
         \PY{n}{t2}\PY{o}{=}\PY{l+m+mi}{9}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{541}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc\PYZus{}gm}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc\PYZus{}gm}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc\PYZus{}gm}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{p}{[}\PY{l+m+mf}{0.0}\PY{p}{,}\PY{p}{]}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{(}\PY{l+m+mf}{1037.2}\PY{p}{,}\PY{l+m+mi}{1036}\PY{p}{)}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Density (kg m\PYZdl{}\PYZca{}\PYZob{}\PYZhy{}3\PYZcb{}\PYZdl{})}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Latitude (\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{})}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{)}
         \PY{n}{tit}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1972}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{tit}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{1036.86}\PY{p}{,}\PY{l+m+mf}{1036.86}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{ii}\PY{o}{=}\PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{yr} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{19}\PY{p}{)}\PY{p}{:}
             
             \PY{c+c1}{\PYZsh{}np.mean(pert\PYZus{}gmoc[t1:t2,:,:],axis=0)\PYZhy{}np.mean(cntrl\PYZus{}gmoc[t1:t2,:,:],axis=0)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{,}\PY{n}{yr}\PY{o}{+}\PY{l+m+mi}{2}\PY{p}{)}
             \PY{n}{p1}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{pert\PYZus{}gmoc\PYZus{}gm}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.7)}
             \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}Sv\PYZsq{})}
             \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{pert\PYZus{}gmoc\PYZus{}gm}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{pert\PYZus{}gmoc\PYZus{}gm}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{p}{[}\PY{l+m+mf}{0.0}\PY{p}{,}\PY{p}{]}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{(}\PY{l+m+mf}{1037.2}\PY{p}{,}\PY{l+m+mi}{1036}\PY{p}{)}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}plt.ylabel(\PYZsq{}Density (kg m\PYZdl{}\PYZca{}\PYZob{}\PYZhy{}3\PYZcb{}\PYZdl{})\PYZsq{})}
             \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Latitude (\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{})}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{)}
             \PY{n}{tit}\PY{o}{=}\PY{n}{yrs}\PY{p}{[}\PY{n}{yr}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{n}{yr}\PY{p}{]}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{1036.86}\PY{p}{,}\PY{l+m+mf}{1036.86}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         
         \PY{n}{ax3} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{axes}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.99}\PY{p}{,}\PY{l+m+mf}{0.38}\PY{p}{,}\PY{l+m+mf}{0.015}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{]}\PY{p}{)}
         \PY{n}{cb} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{p1}\PY{p}{,}\PY{n}{cax}\PY{o}{=}\PY{n}{ax3}\PY{p}{,}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}wpm2\PYZus{}cn.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}wpm2\PYZus{}cn.png\PYZsq{})}
         \PY{c+c1}{\PYZsh{}plt.savefig(of,dpi=220)}
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}gmoc.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gmoc\PYZus{}gm.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_31_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{9.5}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Annual Mean GM GMOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{30}\PY{p}{,}\PY{l+m+mi}{32}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         
         \PY{n}{t1}\PY{o}{=}\PY{l+m+mi}{0}
         \PY{n}{t2}\PY{o}{=}\PY{l+m+mi}{8}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{211}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc\PYZus{}gm}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc\PYZus{}gm}\PY{p}{[}\PY{n}{t1}\PY{o}{+}\PY{l+m+mi}{3}\PY{p}{:}\PY{n}{t2}\PY{o}{+}\PY{l+m+mi}{3}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc\PYZus{}gm}\PY{p}{[}\PY{n}{t1}\PY{o}{+}\PY{l+m+mi}{3}\PY{p}{:}\PY{n}{t2}\PY{o}{+}\PY{l+m+mi}{3}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{p}{[}\PY{l+m+mf}{0.0}\PY{p}{,}\PY{p}{]}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{(}\PY{l+m+mf}{1037.2}\PY{p}{,}\PY{l+m+mi}{1036}\PY{p}{)}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Density (kg m\PYZdl{}\PYZca{}\PYZob{}\PYZhy{}3\PYZcb{}\PYZdl{})}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Latitude (\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{})}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{)}
         \PY{n}{tit}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Control 1970\PYZhy{}1979}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{tit}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{1036.86}\PY{p}{,}\PY{l+m+mf}{1036.86}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{212}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{pert\PYZus{}gmoc\PYZus{}gm}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{pert\PYZus{}gmoc\PYZus{}gm}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{pert\PYZus{}gmoc\PYZus{}gm}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{p}{[}\PY{l+m+mf}{0.0}\PY{p}{,}\PY{p}{]}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{(}\PY{l+m+mf}{1037.2}\PY{p}{,}\PY{l+m+mi}{1036}\PY{p}{)}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Density (kg m\PYZdl{}\PYZca{}\PYZob{}\PYZhy{}3\PYZcb{}\PYZdl{})}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Latitude (\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{})}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{)}
         \PY{n}{tit}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Perturbation 1973\PYZhy{}1980}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{tit}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{1036.86}\PY{p}{,}\PY{l+m+mf}{1036.86}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gmoc\PYZus{}gm\PYZus{}73\PYZhy{}80.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_32_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}90}]:} \PY{c+c1}{\PYZsh{}plot gmoc anom in rho space}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{9.5}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.suptitle(\PYZsq{}GMOC GM Anomaly\PYZsq{})}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{30}\PY{p}{,}\PY{l+m+mi}{32}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         
         \PY{n}{t1}\PY{o}{=}\PY{l+m+mi}{0}
         \PY{n}{t2}\PY{o}{=}\PY{l+m+mi}{5}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{541}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc\PYZus{}gm}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc\PYZus{}gm}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc\PYZus{}gm}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{p}{[}\PY{l+m+mf}{0.0}\PY{p}{,}\PY{p}{]}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{(}\PY{l+m+mf}{1037.2}\PY{p}{,}\PY{l+m+mf}{1036.4}\PY{p}{)}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Density (kg m\PYZdl{}\PYZca{}\PYZob{}\PYZhy{}3\PYZcb{}\PYZdl{})}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Latitude (\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{})}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{)}
         \PY{n}{tit}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Control}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{tit}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{1036.86}\PY{p}{,}\PY{l+m+mf}{1036.86}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{yrs}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1973}\PY{p}{,}\PY{l+m+mi}{2018}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{ii}\PY{o}{=}\PY{l+m+mi}{0}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mf}{1.05}\PY{p}{,}\PY{l+m+mf}{0.05}\PY{p}{)}
         
         
         \PY{k}{for} \PY{n}{yr} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{19}\PY{p}{)}\PY{p}{:}
             
             \PY{c+c1}{\PYZsh{}np.mean(pert\PYZus{}gmoc[t1:t2,:,:],axis=0)\PYZhy{}np.mean(cntrl\PYZus{}gmoc[t1:t2,:,:],axis=0)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{,}\PY{n}{yr}\PY{o}{+}\PY{l+m+mi}{2}\PY{p}{)}
             \PY{n}{p1}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{pert\PYZus{}gmoc\PYZus{}gm}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc\PYZus{}gm}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.7)}
             \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}Sv\PYZsq{})}
             \PY{c+c1}{\PYZsh{}plt.contour(yu\PYZus{}ocean,potrho,pert\PYZus{}gmoc[yr,:,:]\PYZhy{}cntrl\PYZus{}gmoc[yr,:,:],levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=0.25)}
             \PY{c+c1}{\PYZsh{}plt.contour(yu\PYZus{}ocean,potrho,pert\PYZus{}gmoc[yr,:,:]\PYZhy{}cntrl\PYZus{}gmoc[yr,:,:],levels=[0.0,],colors=\PYZsq{}k\PYZsq{},linewidths=0.5)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{(}\PY{l+m+mf}{1037.2}\PY{p}{,}\PY{l+m+mf}{1036.4}\PY{p}{)}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}plt.ylabel(\PYZsq{}Density (kg m\PYZdl{}\PYZca{}\PYZob{}\PYZhy{}3\PYZcb{}\PYZdl{})\PYZsq{})}
             \PY{c+c1}{\PYZsh{}plt.xlabel(\PYZsq{}Latitude (\PYZdl{}\PYZca{}\PYZbs{}circ\PYZdl{})\PYZsq{})}
             \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{)}
             \PY{n}{tit}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Anom. }\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{yrs}\PY{p}{[}\PY{n}{yr}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{n}{yr}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{1036.86}\PY{p}{,}\PY{l+m+mf}{1036.86}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
             
         \PY{n}{ax3} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{axes}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.99}\PY{p}{,}\PY{l+m+mf}{0.38}\PY{p}{,}\PY{l+m+mf}{0.015}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{]}\PY{p}{)}
         \PY{n}{cb} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{p1}\PY{p}{,}\PY{n}{cax}\PY{o}{=}\PY{n}{ax3}\PY{p}{,}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
         
         
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}wpm2\PYZus{}cn.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}wpm2\PYZus{}cn.png\PYZsq{})}
         \PY{c+c1}{\PYZsh{}plt.savefig(of,dpi=220)}
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}gmoc\PYZus{}anom.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gmoc\PYZus{}gm\PYZus{}anom.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_33_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}91}]:} \PY{c+c1}{\PYZsh{}plot GM Net in rho space}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{9.5}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.suptitle(\PYZsq{}Annual Mean GMOC Net\PYZsq{})}
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{30}\PY{p}{,}\PY{l+m+mi}{32}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         
         \PY{n}{t1}\PY{o}{=}\PY{l+m+mi}{0}
         \PY{n}{t2}\PY{o}{=}\PY{l+m+mi}{5}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{541}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{+}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc\PYZus{}gm}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{+}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc\PYZus{}gm}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{+}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc\PYZus{}gm}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{p}{[}\PY{l+m+mf}{0.0}\PY{p}{,}\PY{p}{]}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{(}\PY{l+m+mf}{1037.2}\PY{p}{,}\PY{l+m+mi}{1036}\PY{p}{)}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Density (kg m\PYZdl{}\PYZca{}\PYZob{}\PYZhy{}3\PYZcb{}\PYZdl{})}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Latitude (\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{})}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{)}
         \PY{n}{tit}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1972}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{tit}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{1036.86}\PY{p}{,}\PY{l+m+mf}{1036.86}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         
         \PY{n}{ii}\PY{o}{=}\PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{yr} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{19}\PY{p}{)}\PY{p}{:}
             
             \PY{c+c1}{\PYZsh{}np.mean(pert\PYZus{}gmoc[t1:t2,:,:],axis=0)\PYZhy{}np.mean(cntrl\PYZus{}gmoc[t1:t2,:,:],axis=0)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{,}\PY{n}{yr}\PY{o}{+}\PY{l+m+mi}{2}\PY{p}{)}
             \PY{n}{p1}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{pert\PYZus{}gmoc\PYZus{}gm}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{+}\PY{n}{pert\PYZus{}gmoc}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.7)}
             \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}Sv\PYZsq{})}
             \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{pert\PYZus{}gmoc\PYZus{}gm}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{+}\PY{n}{pert\PYZus{}gmoc}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{pert\PYZus{}gmoc\PYZus{}gm}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{+}\PY{n}{pert\PYZus{}gmoc}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{p}{[}\PY{l+m+mf}{0.0}\PY{p}{,}\PY{p}{]}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{(}\PY{l+m+mf}{1037.2}\PY{p}{,}\PY{l+m+mi}{1036}\PY{p}{)}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}plt.ylabel(\PYZsq{}Density (kg m\PYZdl{}\PYZca{}\PYZob{}\PYZhy{}3\PYZcb{}\PYZdl{})\PYZsq{})}
             \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Latitude (\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{})}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{)}
             \PY{n}{tit}\PY{o}{=}\PY{n}{yrs}\PY{p}{[}\PY{n}{yr}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{n}{yr}\PY{p}{]}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{1036.86}\PY{p}{,}\PY{l+m+mf}{1036.86}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         
         \PY{n}{ax3} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{axes}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.99}\PY{p}{,}\PY{l+m+mf}{0.38}\PY{p}{,}\PY{l+m+mf}{0.015}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{]}\PY{p}{)}
         \PY{n}{cb} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{p1}\PY{p}{,}\PY{n}{cax}\PY{o}{=}\PY{n}{ax3}\PY{p}{,}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}wpm2\PYZus{}cn.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}wpm2\PYZus{}cn.png\PYZsq{})}
         \PY{c+c1}{\PYZsh{}plt.savefig(of,dpi=220)}
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}gmoc.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gmoc\PYZus{}net.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_35_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}94}]:} \PY{c+c1}{\PYZsh{}plot gmoc anom in rho space}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{9.5}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.suptitle(\PYZsq{}GMOC Net Anomaly\PYZsq{})}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{30}\PY{p}{,}\PY{l+m+mi}{32}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         
         \PY{n}{t1}\PY{o}{=}\PY{l+m+mi}{0}
         \PY{n}{t2}\PY{o}{=}\PY{l+m+mi}{5}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{541}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc\PYZus{}gm}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{+}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc\PYZus{}gm}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{+}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc\PYZus{}gm}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{+}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{p}{[}\PY{l+m+mf}{0.0}\PY{p}{,}\PY{p}{]}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{(}\PY{l+m+mf}{1037.2}\PY{p}{,}\PY{l+m+mf}{1036.4}\PY{p}{)}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Density (kg m\PYZdl{}\PYZca{}\PYZob{}\PYZhy{}3\PYZcb{}\PYZdl{})}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Latitude (\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{})}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{)}
         \PY{n}{tit}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Control}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{tit}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{1036.86}\PY{p}{,}\PY{l+m+mf}{1036.86}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{yrs}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1973}\PY{p}{,}\PY{l+m+mi}{2016}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{ii}\PY{o}{=}\PY{l+m+mi}{0}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mf}{5.25}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{)}
         
         
         \PY{k}{for} \PY{n}{yr} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{19}\PY{p}{)}\PY{p}{:}
             
             \PY{c+c1}{\PYZsh{}np.mean(pert\PYZus{}gmoc[t1:t2,:,:],axis=0)\PYZhy{}np.mean(cntrl\PYZus{}gmoc[t1:t2,:,:],axis=0)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{,}\PY{n}{yr}\PY{o}{+}\PY{l+m+mi}{2}\PY{p}{)}
             \PY{n}{p1}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{pert\PYZus{}gmoc\PYZus{}gm}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{+}\PY{n}{pert\PYZus{}gmoc}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc\PYZus{}gm}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.7)}
             \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}Sv\PYZsq{})}
             \PY{c+c1}{\PYZsh{}plt.contour(yu\PYZus{}ocean,potrho,pert\PYZus{}gmoc[yr,:,:]\PYZhy{}cntrl\PYZus{}gmoc[yr,:,:],levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=0.25)}
             \PY{c+c1}{\PYZsh{}plt.contour(yu\PYZus{}ocean,potrho,pert\PYZus{}gmoc[yr,:,:]\PYZhy{}cntrl\PYZus{}gmoc[yr,:,:],levels=[0.0,],colors=\PYZsq{}k\PYZsq{},linewidths=0.5)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{(}\PY{l+m+mf}{1037.2}\PY{p}{,}\PY{l+m+mf}{1036.4}\PY{p}{)}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}plt.ylabel(\PYZsq{}Density (kg m\PYZdl{}\PYZca{}\PYZob{}\PYZhy{}3\PYZcb{}\PYZdl{})\PYZsq{})}
             \PY{c+c1}{\PYZsh{}plt.xlabel(\PYZsq{}Latitude (\PYZdl{}\PYZca{}\PYZbs{}circ\PYZdl{})\PYZsq{})}
             \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{)}
             \PY{n}{tit}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Anom. }\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{yrs}\PY{p}{[}\PY{n}{yr}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{n}{yr}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{1036.86}\PY{p}{,}\PY{l+m+mf}{1036.86}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
             
         \PY{n}{ax3} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{axes}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.99}\PY{p}{,}\PY{l+m+mf}{0.38}\PY{p}{,}\PY{l+m+mf}{0.015}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{]}\PY{p}{)}
         \PY{n}{cb} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{p1}\PY{p}{,}\PY{n}{cax}\PY{o}{=}\PY{n}{ax3}\PY{p}{,}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}wpm2\PYZus{}cn.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}wpm2\PYZus{}cn.png\PYZsq{})}
         \PY{c+c1}{\PYZsh{}plt.savefig(of,dpi=220)}
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}gmoc\PYZus{}anom.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gmoc\PYZus{}net\PYZus{}anom.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_36_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{c+c1}{\PYZsh{}plot time series of AABW or full transports (with GM ... only 9 yrs for CNTRL) so using cntrl mean}
         \PY{n}{T}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{50}\PY{p}{)}
         \PY{k}{print} \PY{n}{T}\PY{o}{.}\PY{n}{shape}
         
         
         \PY{n}{z1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{potrho}\PY{o}{\PYZlt{}}\PY{l+m+mf}{1036.86}\PY{p}{)}
         \PY{n}{z1}\PY{o}{=}\PY{n}{z1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         
         \PY{n}{ts}\PY{o}{=}\PY{n}{pert\PYZus{}gmoc}\PY{o}{.}\PY{n}{shape}
         \PY{n}{ts}\PY{o}{=}\PY{n}{ts}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         \PY{k}{print} \PY{n}{ts}
         
         \PY{c+c1}{\PYZsh{} do lower cell average between lats 60\PYZhy{}65S}
         \PY{n}{j1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mf}{69.9}\PY{p}{)}
         \PY{n}{j2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{60}\PY{p}{)}
         \PY{n}{j1}\PY{o}{=}\PY{n}{j1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{j2}\PY{o}{=}\PY{n}{j2}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         
         \PY{n}{lc\PYZus{}cntrl60\PYZus{}psj} \PY{o}{=} \PY{n}{cntrl\PYZus{}gmoc}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{9}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}\PY{o}{+}\PY{n}{cntrl\PYZus{}gmoc\PYZus{}gm}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}
         \PY{n}{lc\PYZus{}cntrl60\PYZus{}psj\PYZus{}bar} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{lc\PYZus{}cntrl60\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{lc\PYZus{}cntrl60\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{lc\PYZus{}cntrl60\PYZus{}psj\PYZus{}bar}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{lc\PYZus{}pert60\PYZus{}psj} \PY{o}{=} \PY{n}{pert\PYZus{}gmoc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}\PY{o}{+}\PY{n}{pert\PYZus{}gmoc\PYZus{}gm}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}
         \PY{n}{lc\PYZus{}pert60\PYZus{}psj\PYZus{}bar} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{lc\PYZus{}pert60\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{lc\PYZus{}pert60\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{lc\PYZus{}pert60\PYZus{}psj\PYZus{}bar}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{lc\PYZus{}anom60\PYZus{}psj} \PY{o}{=} \PY{n}{pert\PYZus{}gmoc}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{ts}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}\PY{o}{+}\PY{n}{pert\PYZus{}gmoc\PYZus{}gm}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{ts}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc\PYZus{}gm}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{n}{lc\PYZus{}max\PYZus{}anom60\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{lc\PYZus{}anom60\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{lc\PYZus{}max\PYZus{}anom60\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{lc\PYZus{}max\PYZus{}anom60\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{lc\PYZus{}max\PYZus{}anom60\PYZus{}psj\PYZus{}ts}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{insert}\PY{p}{(}\PY{n}{lc\PYZus{}max\PYZus{}anom60\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{n}{lc\PYZus{}max60\PYZus{}ts} \PY{o}{=} \PY{n}{lc\PYZus{}max\PYZus{}anom60\PYZus{}psj\PYZus{}ts} \PY{o}{+} \PY{n}{lc\PYZus{}cntrl60\PYZus{}psj\PYZus{}ts}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         
         \PY{n}{lc\PYZus{}min\PYZus{}anom60\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{lc\PYZus{}anom60\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{lc\PYZus{}min\PYZus{}anom60\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{lc\PYZus{}min\PYZus{}anom60\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{lc\PYZus{}min\PYZus{}anom60\PYZus{}psj\PYZus{}ts}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{insert}\PY{p}{(}\PY{n}{lc\PYZus{}min\PYZus{}anom60\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{n}{lc\PYZus{}min60\PYZus{}ts} \PY{o}{=} \PY{n}{lc\PYZus{}min\PYZus{}anom60\PYZus{}psj\PYZus{}ts} \PY{o}{+} \PY{n}{lc\PYZus{}cntrl60\PYZus{}psj\PYZus{}ts}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         
         \PY{c+c1}{\PYZsh{}print lc\PYZus{}max\PYZus{}ts}
         \PY{c+c1}{\PYZsh{}print lc\PYZus{}min\PYZus{}ts}
         
         \PY{c+c1}{\PYZsh{} do lower cell average between lats 40\PYZhy{}45S}
         \PY{n}{j1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mf}{49.9}\PY{p}{)}
         \PY{n}{j2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{40}\PY{p}{)}
         \PY{n}{j1}\PY{o}{=}\PY{n}{j1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{j2}\PY{o}{=}\PY{n}{j2}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         
         \PY{n}{lc\PYZus{}cntrl40\PYZus{}psj} \PY{o}{=} \PY{n}{cntrl\PYZus{}gmoc}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{9}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}\PY{o}{+}\PY{n}{cntrl\PYZus{}gmoc\PYZus{}gm}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}
         \PY{n}{lc\PYZus{}cntrl40\PYZus{}psj\PYZus{}bar} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{lc\PYZus{}cntrl40\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{lc\PYZus{}cntrl40\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{lc\PYZus{}cntrl40\PYZus{}psj\PYZus{}bar}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{lc\PYZus{}pert40\PYZus{}psj} \PY{o}{=} \PY{n}{pert\PYZus{}gmoc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}\PY{o}{+}\PY{n}{pert\PYZus{}gmoc\PYZus{}gm}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}
         \PY{n}{lc\PYZus{}pert40\PYZus{}psj\PYZus{}bar} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{lc\PYZus{}pert40\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{lc\PYZus{}pert40\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{lc\PYZus{}pert40\PYZus{}psj\PYZus{}bar}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{lc\PYZus{}anom40\PYZus{}psj} \PY{o}{=} \PY{n}{pert\PYZus{}gmoc}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{ts}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}\PY{o}{+}\PY{n}{pert\PYZus{}gmoc\PYZus{}gm}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{ts}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc\PYZus{}gm}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
         
         \PY{n}{lc\PYZus{}max\PYZus{}anom40\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{lc\PYZus{}anom40\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{lc\PYZus{}max\PYZus{}anom40\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{lc\PYZus{}max\PYZus{}anom40\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{lc\PYZus{}max\PYZus{}anom40\PYZus{}psj\PYZus{}ts}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{insert}\PY{p}{(}\PY{n}{lc\PYZus{}max\PYZus{}anom40\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{n}{lc\PYZus{}max40\PYZus{}ts} \PY{o}{=} \PY{n}{lc\PYZus{}max\PYZus{}anom40\PYZus{}psj\PYZus{}ts} \PY{o}{+} \PY{n}{lc\PYZus{}cntrl40\PYZus{}psj\PYZus{}ts}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         
         \PY{n}{lc\PYZus{}min\PYZus{}anom40\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{lc\PYZus{}anom40\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{lc\PYZus{}min\PYZus{}anom40\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{lc\PYZus{}min\PYZus{}anom40\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{lc\PYZus{}min\PYZus{}anom40\PYZus{}psj\PYZus{}ts}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{insert}\PY{p}{(}\PY{n}{lc\PYZus{}min\PYZus{}anom40\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{n}{lc\PYZus{}min40\PYZus{}ts} \PY{o}{=} \PY{n}{lc\PYZus{}min\PYZus{}anom40\PYZus{}psj\PYZus{}ts} \PY{o}{+} \PY{n}{lc\PYZus{}cntrl40\PYZus{}psj\PYZus{}ts}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         
         \PY{c+c1}{\PYZsh{} do lower cell average between lats 20\PYZhy{}25S}
         \PY{n}{j1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mf}{59.9}\PY{p}{)}
         \PY{n}{j2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{50}\PY{p}{)}
         \PY{n}{j1}\PY{o}{=}\PY{n}{j1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{j2}\PY{o}{=}\PY{n}{j2}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         
         \PY{n}{lc\PYZus{}cntrl50\PYZus{}psj} \PY{o}{=} \PY{n}{cntrl\PYZus{}gmoc}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{9}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}\PY{o}{+}\PY{n}{cntrl\PYZus{}gmoc\PYZus{}gm}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}
         \PY{n}{lc\PYZus{}cntrl50\PYZus{}psj\PYZus{}bar} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{lc\PYZus{}cntrl50\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{lc\PYZus{}cntrl50\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{lc\PYZus{}cntrl50\PYZus{}psj\PYZus{}bar}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{lc\PYZus{}pert50\PYZus{}psj} \PY{o}{=} \PY{n}{pert\PYZus{}gmoc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}\PY{o}{+}\PY{n}{pert\PYZus{}gmoc\PYZus{}gm}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}
         \PY{n}{lc\PYZus{}pert50\PYZus{}psj\PYZus{}bar} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{lc\PYZus{}pert50\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{lc\PYZus{}pert50\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{lc\PYZus{}pert50\PYZus{}psj\PYZus{}bar}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{lc\PYZus{}anom50\PYZus{}psj} \PY{o}{=} \PY{n}{pert\PYZus{}gmoc}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{ts}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}\PY{o}{+}\PY{n}{pert\PYZus{}gmoc\PYZus{}gm}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{ts}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc\PYZus{}gm}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
         
         
         \PY{n}{lc\PYZus{}max\PYZus{}anom50\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{lc\PYZus{}anom50\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{lc\PYZus{}max\PYZus{}anom50\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{lc\PYZus{}max\PYZus{}anom50\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{lc\PYZus{}max\PYZus{}anom50\PYZus{}psj\PYZus{}ts}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{insert}\PY{p}{(}\PY{n}{lc\PYZus{}max\PYZus{}anom50\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{n}{lc\PYZus{}max50\PYZus{}ts} \PY{o}{=} \PY{n}{lc\PYZus{}max\PYZus{}anom50\PYZus{}psj\PYZus{}ts} \PY{o}{+} \PY{n}{lc\PYZus{}cntrl50\PYZus{}psj\PYZus{}ts}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         
         \PY{n}{lc\PYZus{}min\PYZus{}anom50\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{lc\PYZus{}anom50\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{lc\PYZus{}min\PYZus{}anom50\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{lc\PYZus{}min\PYZus{}anom50\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{lc\PYZus{}min\PYZus{}anom50\PYZus{}psj\PYZus{}ts}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{insert}\PY{p}{(}\PY{n}{lc\PYZus{}min\PYZus{}anom50\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{n}{lc\PYZus{}min50\PYZus{}ts} \PY{o}{=} \PY{n}{lc\PYZus{}min\PYZus{}anom50\PYZus{}psj\PYZus{}ts} \PY{o}{+} \PY{n}{lc\PYZus{}cntrl50\PYZus{}psj\PYZus{}ts}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{211}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{9}\PY{p}{]}\PY{p}{,}\PY{n}{lc\PYZus{}cntrl60\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{60\PYZhy{}70\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}S}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{34}\PY{p}{]}\PY{p}{,}\PY{n}{lc\PYZus{}pert60\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{60\PYZhy{}70\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}S}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{9}\PY{p}{]}\PY{p}{,}\PY{n}{lc\PYZus{}cntrl50\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{50\PYZhy{}60\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}S}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{34}\PY{p}{]}\PY{p}{,}\PY{n}{lc\PYZus{}pert50\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{50\PYZhy{}60\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}S}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{9}\PY{p}{]}\PY{p}{,}\PY{n}{lc\PYZus{}cntrl40\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{40\PYZhy{}50\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}S}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{34}\PY{p}{]}\PY{p}{,}\PY{n}{lc\PYZus{}pert40\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{40\PYZhy{}50\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}S}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.plot(lc\PYZus{}max40\PYZus{}ts,linestyle=\PYZsq{}:\PYZsq{},color=\PYZsq{}g\PYZsq{},linewidth=1.5)}
         \PY{c+c1}{\PYZsh{}plt.plot(lc\PYZus{}min40\PYZus{}ts,linestyle=\PYZsq{}:\PYZsq{},color=\PYZsq{}b\PYZsq{},linewidth=1.5)}
         \PY{c+c1}{\PYZsh{}plt.plot(lc\PYZus{}cntrl40\PYZus{}psj\PYZus{}ts,linestyle=\PYZsq{}:\PYZsq{},color=\PYZsq{}k\PYZsq{},label=\PYZsq{}40\PYZhy{}50\PYZdl{}\PYZca{}\PYZbs{}circ\PYZdl{}S\PYZsq{},linewidth=2)}
         \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1035))}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Transport (Sv)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Years}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.xlim([\PYZhy{}75,85])}
         \PY{n}{tit}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GMOC Lower Cell Rho \PYZgt{} }\PY{l+s+s1}{\PYZsq{}} \PY{o}{+}\PY{n+nb}{str}\PY{p}{(}\PY{n}{potrho}\PY{p}{[}\PY{n}{z1}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{tit}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{212}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{35}\PY{p}{]}\PY{p}{,}\PY{n}{lc\PYZus{}max60\PYZus{}ts}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max 60\PYZhy{}70\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}S}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{1.5}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{35}\PY{p}{]}\PY{p}{,}\PY{n}{lc\PYZus{}min60\PYZus{}ts}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{min 60\PYZhy{}70\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}S}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{1.5}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{9}\PY{p}{]}\PY{p}{,}\PY{n}{lc\PYZus{}cntrl60\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{60\PYZhy{}70\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}S}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{35}\PY{p}{]}\PY{p}{,}\PY{n}{lc\PYZus{}max50\PYZus{}ts}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max 50\PYZhy{}60\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}S}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{1.5}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{35}\PY{p}{]}\PY{p}{,}\PY{n}{lc\PYZus{}min50\PYZus{}ts}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{min 50\PYZhy{}60\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}S}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{1.5}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{9}\PY{p}{]}\PY{p}{,}\PY{n}{lc\PYZus{}cntrl50\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{50\PYZhy{}60\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}S}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.plot(lc\PYZus{}max40\PYZus{}ts,linestyle=\PYZsq{}:\PYZsq{},color=\PYZsq{}g\PYZsq{},linewidth=1.5)}
         \PY{c+c1}{\PYZsh{}plt.plot(lc\PYZus{}min40\PYZus{}ts,linestyle=\PYZsq{}:\PYZsq{},color=\PYZsq{}b\PYZsq{},linewidth=1.5)}
         \PY{c+c1}{\PYZsh{}plt.plot(lc\PYZus{}cntrl40\PYZus{}psj\PYZus{}ts,linestyle=\PYZsq{}:\PYZsq{},color=\PYZsq{}k\PYZsq{},label=\PYZsq{}40\PYZhy{}50\PYZdl{}\PYZca{}\PYZbs{}circ\PYZdl{}S\PYZsq{},linewidth=2)}
         \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1035))}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Transport (Sv)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Years}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.xlim([\PYZhy{}75,85])}
         \PY{n}{tit}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GMOC Lower Cell Rho Min/Max Anom \PYZgt{} }\PY{l+s+s1}{\PYZsq{}} \PY{o}{+}\PY{n+nb}{str}\PY{p}{(}\PY{n}{potrho}\PY{p}{[}\PY{n}{z1}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{tit}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
         
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}gmoc\PYZus{}ts.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gmoc\PYZus{}ts.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(50,)
34

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/ipykernel/\_\_main\_\_.py:19: VisibleDeprecationWarning: converting an array with ndim > 0 to an index will result in an error in the future
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/ipykernel/\_\_main\_\_.py:23: VisibleDeprecationWarning: converting an array with ndim > 0 to an index will result in an error in the future
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/ipykernel/\_\_main\_\_.py:27: VisibleDeprecationWarning: converting an array with ndim > 0 to an index will result in an error in the future
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/ipykernel/\_\_main\_\_.py:47: VisibleDeprecationWarning: converting an array with ndim > 0 to an index will result in an error in the future
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/ipykernel/\_\_main\_\_.py:51: VisibleDeprecationWarning: converting an array with ndim > 0 to an index will result in an error in the future
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/ipykernel/\_\_main\_\_.py:55: VisibleDeprecationWarning: converting an array with ndim > 0 to an index will result in an error in the future
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/ipykernel/\_\_main\_\_.py:73: VisibleDeprecationWarning: converting an array with ndim > 0 to an index will result in an error in the future
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/ipykernel/\_\_main\_\_.py:77: VisibleDeprecationWarning: converting an array with ndim > 0 to an index will result in an error in the future
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/ipykernel/\_\_main\_\_.py:81: VisibleDeprecationWarning: converting an array with ndim > 0 to an index will result in an error in the future

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_37_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{c+c1}{\PYZsh{}plot time series of AABW for adv transports (no GM)}
         \PY{n}{T}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{50}\PY{p}{)}
         \PY{k}{print} \PY{n}{T}\PY{o}{.}\PY{n}{shape}
         
         
         \PY{n}{z1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{potrho}\PY{o}{\PYZlt{}}\PY{l+m+mf}{1036.86}\PY{p}{)}
         \PY{n}{z1}\PY{o}{=}\PY{n}{z1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         
         \PY{n}{ts}\PY{o}{=}\PY{n}{pert\PYZus{}gmoc}\PY{o}{.}\PY{n}{shape}
         \PY{n}{ts}\PY{o}{=}\PY{n}{ts}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         \PY{k}{print} \PY{n}{ts}
         
         \PY{c+c1}{\PYZsh{} do lower cell average between lats 60\PYZhy{}65S}
         \PY{n}{j1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mf}{69.9}\PY{p}{)}
         \PY{n}{j2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{60}\PY{p}{)}
         \PY{n}{j1}\PY{o}{=}\PY{n}{j1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{j2}\PY{o}{=}\PY{n}{j2}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         
         \PY{n}{lc\PYZus{}cntrl60\PYZus{}psj} \PY{o}{=} \PY{n}{cntrl\PYZus{}gmoc}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{:}\PY{n}{ts}\PY{o}{+}\PY{l+m+mi}{3}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}
         \PY{n}{lc\PYZus{}cntrl60\PYZus{}psj\PYZus{}bar} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{lc\PYZus{}cntrl60\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{lc\PYZus{}cntrl60\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{lc\PYZus{}cntrl60\PYZus{}psj\PYZus{}bar}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{lc\PYZus{}pert60\PYZus{}psj} \PY{o}{=} \PY{n}{pert\PYZus{}gmoc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}
         \PY{n}{lc\PYZus{}pert60\PYZus{}psj\PYZus{}bar} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{lc\PYZus{}pert60\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{lc\PYZus{}pert60\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{lc\PYZus{}pert60\PYZus{}psj\PYZus{}bar}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{lc\PYZus{}anom60\PYZus{}psj} \PY{o}{=} \PY{n}{pert\PYZus{}gmoc}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{ts}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{n}{cntrl\PYZus{}gmoc}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{ts}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}
         \PY{n}{lc\PYZus{}max\PYZus{}anom60\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{lc\PYZus{}anom60\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{lc\PYZus{}max\PYZus{}anom60\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{lc\PYZus{}max\PYZus{}anom60\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{lc\PYZus{}max\PYZus{}anom60\PYZus{}psj\PYZus{}ts}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{insert}\PY{p}{(}\PY{n}{lc\PYZus{}max\PYZus{}anom60\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{n}{lc\PYZus{}max60\PYZus{}ts} \PY{o}{=} \PY{n}{lc\PYZus{}max\PYZus{}anom60\PYZus{}psj\PYZus{}ts} \PY{o}{+} \PY{n}{lc\PYZus{}cntrl60\PYZus{}psj\PYZus{}ts}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         
         \PY{n}{lc\PYZus{}min\PYZus{}anom60\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{lc\PYZus{}anom60\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{lc\PYZus{}min\PYZus{}anom60\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{lc\PYZus{}min\PYZus{}anom60\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{lc\PYZus{}min\PYZus{}anom60\PYZus{}psj\PYZus{}ts}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{insert}\PY{p}{(}\PY{n}{lc\PYZus{}min\PYZus{}anom60\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{n}{lc\PYZus{}min60\PYZus{}ts} \PY{o}{=} \PY{n}{lc\PYZus{}min\PYZus{}anom60\PYZus{}psj\PYZus{}ts} \PY{o}{+} \PY{n}{lc\PYZus{}cntrl60\PYZus{}psj\PYZus{}ts}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         
         \PY{c+c1}{\PYZsh{}print lc\PYZus{}max\PYZus{}ts}
         \PY{c+c1}{\PYZsh{}print lc\PYZus{}min\PYZus{}ts}
         
         \PY{c+c1}{\PYZsh{} do lower cell average between lats 40\PYZhy{}45S}
         \PY{n}{j1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mf}{49.9}\PY{p}{)}
         \PY{n}{j2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{40}\PY{p}{)}
         \PY{n}{j1}\PY{o}{=}\PY{n}{j1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{j2}\PY{o}{=}\PY{n}{j2}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         
         \PY{n}{lc\PYZus{}cntrl40\PYZus{}psj} \PY{o}{=} \PY{n}{cntrl\PYZus{}gmoc}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{:}\PY{n}{ts}\PY{o}{+}\PY{l+m+mi}{3}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}
         \PY{n}{lc\PYZus{}cntrl40\PYZus{}psj\PYZus{}bar} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{lc\PYZus{}cntrl40\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{lc\PYZus{}cntrl40\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{lc\PYZus{}cntrl40\PYZus{}psj\PYZus{}bar}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{lc\PYZus{}pert40\PYZus{}psj} \PY{o}{=} \PY{n}{pert\PYZus{}gmoc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}
         \PY{n}{lc\PYZus{}pert40\PYZus{}psj\PYZus{}bar} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{lc\PYZus{}pert40\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{lc\PYZus{}pert40\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{lc\PYZus{}pert40\PYZus{}psj\PYZus{}bar}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{lc\PYZus{}anom40\PYZus{}psj} \PY{o}{=} \PY{n}{pert\PYZus{}gmoc}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{ts}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{n}{cntrl\PYZus{}gmoc}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{ts}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}
         
         \PY{n}{lc\PYZus{}max\PYZus{}anom40\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{lc\PYZus{}anom40\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{lc\PYZus{}max\PYZus{}anom40\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{lc\PYZus{}max\PYZus{}anom40\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{lc\PYZus{}max\PYZus{}anom40\PYZus{}psj\PYZus{}ts}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{insert}\PY{p}{(}\PY{n}{lc\PYZus{}max\PYZus{}anom40\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{n}{lc\PYZus{}max40\PYZus{}ts} \PY{o}{=} \PY{n}{lc\PYZus{}max\PYZus{}anom40\PYZus{}psj\PYZus{}ts} \PY{o}{+} \PY{n}{lc\PYZus{}cntrl40\PYZus{}psj\PYZus{}ts}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         
         \PY{n}{lc\PYZus{}min\PYZus{}anom40\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{lc\PYZus{}anom40\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{lc\PYZus{}min\PYZus{}anom40\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{lc\PYZus{}min\PYZus{}anom40\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{lc\PYZus{}min\PYZus{}anom40\PYZus{}psj\PYZus{}ts}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{insert}\PY{p}{(}\PY{n}{lc\PYZus{}min\PYZus{}anom40\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{n}{lc\PYZus{}min40\PYZus{}ts} \PY{o}{=} \PY{n}{lc\PYZus{}min\PYZus{}anom40\PYZus{}psj\PYZus{}ts} \PY{o}{+} \PY{n}{lc\PYZus{}cntrl40\PYZus{}psj\PYZus{}ts}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         
         \PY{c+c1}{\PYZsh{} do lower cell average between lats 20\PYZhy{}25S}
         \PY{n}{j1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mf}{59.9}\PY{p}{)}
         \PY{n}{j2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{50}\PY{p}{)}
         \PY{n}{j1}\PY{o}{=}\PY{n}{j1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{j2}\PY{o}{=}\PY{n}{j2}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         
         \PY{n}{lc\PYZus{}cntrl50\PYZus{}psj} \PY{o}{=} \PY{n}{cntrl\PYZus{}gmoc}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{:}\PY{n}{ts}\PY{o}{+}\PY{l+m+mi}{3}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}
         \PY{n}{lc\PYZus{}cntrl50\PYZus{}psj\PYZus{}bar} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{lc\PYZus{}cntrl50\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{lc\PYZus{}cntrl50\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{lc\PYZus{}cntrl50\PYZus{}psj\PYZus{}bar}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{lc\PYZus{}pert50\PYZus{}psj} \PY{o}{=} \PY{n}{pert\PYZus{}gmoc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}
         \PY{n}{lc\PYZus{}pert50\PYZus{}psj\PYZus{}bar} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{lc\PYZus{}pert50\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{lc\PYZus{}pert50\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{lc\PYZus{}pert50\PYZus{}psj\PYZus{}bar}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{lc\PYZus{}anom50\PYZus{}psj} \PY{o}{=} \PY{n}{pert\PYZus{}gmoc}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{ts}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{n}{cntrl\PYZus{}gmoc}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{ts}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}
         
         \PY{n}{lc\PYZus{}max\PYZus{}anom50\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{lc\PYZus{}anom50\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{lc\PYZus{}max\PYZus{}anom50\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{lc\PYZus{}max\PYZus{}anom50\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{lc\PYZus{}max\PYZus{}anom50\PYZus{}psj\PYZus{}ts}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{insert}\PY{p}{(}\PY{n}{lc\PYZus{}max\PYZus{}anom50\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{n}{lc\PYZus{}max50\PYZus{}ts} \PY{o}{=} \PY{n}{lc\PYZus{}max\PYZus{}anom50\PYZus{}psj\PYZus{}ts} \PY{o}{+} \PY{n}{lc\PYZus{}cntrl50\PYZus{}psj\PYZus{}ts}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         
         \PY{n}{lc\PYZus{}min\PYZus{}anom50\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{lc\PYZus{}anom50\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{lc\PYZus{}min\PYZus{}anom50\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{lc\PYZus{}min\PYZus{}anom50\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{lc\PYZus{}min\PYZus{}anom50\PYZus{}psj\PYZus{}ts}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{insert}\PY{p}{(}\PY{n}{lc\PYZus{}min\PYZus{}anom50\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{n}{lc\PYZus{}min50\PYZus{}ts} \PY{o}{=} \PY{n}{lc\PYZus{}min\PYZus{}anom50\PYZus{}psj\PYZus{}ts} \PY{o}{+} \PY{n}{lc\PYZus{}cntrl50\PYZus{}psj\PYZus{}ts}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{211}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{ts}\PY{p}{]}\PY{p}{,}\PY{n}{lc\PYZus{}cntrl60\PYZus{}psj\PYZus{}ts}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{ts}\PY{p}{]}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{60\PYZhy{}70\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}S}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{ts}\PY{p}{]}\PY{p}{,}\PY{n}{lc\PYZus{}pert60\PYZus{}psj\PYZus{}ts}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{ts}\PY{p}{]}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{60\PYZhy{}70\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}S}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{ts}\PY{p}{]}\PY{p}{,}\PY{n}{lc\PYZus{}cntrl50\PYZus{}psj\PYZus{}ts}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{ts}\PY{p}{]}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{50\PYZhy{}60\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}S}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{ts}\PY{p}{]}\PY{p}{,}\PY{n}{lc\PYZus{}pert50\PYZus{}psj\PYZus{}ts}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{ts}\PY{p}{]}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{50\PYZhy{}60\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}S}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{ts}\PY{p}{]}\PY{p}{,}\PY{n}{lc\PYZus{}cntrl40\PYZus{}psj\PYZus{}ts}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{ts}\PY{p}{]}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{40\PYZhy{}50\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}S}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{ts}\PY{p}{]}\PY{p}{,}\PY{n}{lc\PYZus{}pert40\PYZus{}psj\PYZus{}ts}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{ts}\PY{p}{]}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{40\PYZhy{}50\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}S}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.plot(lc\PYZus{}max40\PYZus{}ts,linestyle=\PYZsq{}:\PYZsq{},color=\PYZsq{}g\PYZsq{},linewidth=1.5)}
         \PY{c+c1}{\PYZsh{}plt.plot(lc\PYZus{}min40\PYZus{}ts,linestyle=\PYZsq{}:\PYZsq{},color=\PYZsq{}b\PYZsq{},linewidth=1.5)}
         \PY{c+c1}{\PYZsh{}plt.plot(lc\PYZus{}cntrl40\PYZus{}psj\PYZus{}ts,linestyle=\PYZsq{}:\PYZsq{},color=\PYZsq{}k\PYZsq{},label=\PYZsq{}40\PYZhy{}50\PYZdl{}\PYZca{}\PYZbs{}circ\PYZdl{}S\PYZsq{},linewidth=2)}
         \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1035))}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Transport (Sv)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Years}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.xlim([\PYZhy{}75,85])}
         \PY{n}{tit}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GMOC Lower Cell Rho \PYZgt{} }\PY{l+s+s1}{\PYZsq{}} \PY{o}{+}\PY{n+nb}{str}\PY{p}{(}\PY{n}{potrho}\PY{p}{[}\PY{n}{z1}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{tit}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{212}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{ts}\PY{p}{]}\PY{p}{,}\PY{n}{lc\PYZus{}max60\PYZus{}ts}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{ts}\PY{p}{]}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max 60\PYZhy{}70\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}S}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{1.5}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{ts}\PY{p}{]}\PY{p}{,}\PY{n}{lc\PYZus{}min60\PYZus{}ts}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{ts}\PY{p}{]}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{min 60\PYZhy{}70\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}S}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{1.5}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{ts}\PY{p}{]}\PY{p}{,}\PY{n}{lc\PYZus{}cntrl60\PYZus{}psj\PYZus{}ts}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{ts}\PY{p}{]}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{60\PYZhy{}70\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}S}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{ts}\PY{p}{]}\PY{p}{,}\PY{n}{lc\PYZus{}max50\PYZus{}ts}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{ts}\PY{p}{]}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max 50\PYZhy{}60\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}S}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{1.5}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{ts}\PY{p}{]}\PY{p}{,}\PY{n}{lc\PYZus{}min50\PYZus{}ts}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{ts}\PY{p}{]}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{min 50\PYZhy{}60\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}S}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{1.5}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{ts}\PY{p}{]}\PY{p}{,}\PY{n}{lc\PYZus{}cntrl50\PYZus{}psj\PYZus{}ts}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{ts}\PY{p}{]}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{50\PYZhy{}60\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}S}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.plot(lc\PYZus{}max40\PYZus{}ts,linestyle=\PYZsq{}:\PYZsq{},color=\PYZsq{}g\PYZsq{},linewidth=1.5)}
         \PY{c+c1}{\PYZsh{}plt.plot(lc\PYZus{}min40\PYZus{}ts,linestyle=\PYZsq{}:\PYZsq{},color=\PYZsq{}b\PYZsq{},linewidth=1.5)}
         \PY{c+c1}{\PYZsh{}plt.plot(lc\PYZus{}cntrl40\PYZus{}psj\PYZus{}ts,linestyle=\PYZsq{}:\PYZsq{},color=\PYZsq{}k\PYZsq{},label=\PYZsq{}40\PYZhy{}50\PYZdl{}\PYZca{}\PYZbs{}circ\PYZdl{}S\PYZsq{},linewidth=2)}
         \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1035))}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Transport (Sv)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Years}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.xlim([\PYZhy{}75,85])}
         \PY{n}{tit}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GMOC Lower Cell Rho Min/Max Anom \PYZgt{} }\PY{l+s+s1}{\PYZsq{}} \PY{o}{+}\PY{n+nb}{str}\PY{p}{(}\PY{n}{potrho}\PY{p}{[}\PY{n}{z1}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{tit}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
         
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}gmoc\PYZus{}ts.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gmoc\PYZus{}ts\PYZus{}adv.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(50,)
34

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/ipykernel/\_\_main\_\_.py:19: VisibleDeprecationWarning: converting an array with ndim > 0 to an index will result in an error in the future
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/ipykernel/\_\_main\_\_.py:23: VisibleDeprecationWarning: converting an array with ndim > 0 to an index will result in an error in the future
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/ipykernel/\_\_main\_\_.py:27: VisibleDeprecationWarning: converting an array with ndim > 0 to an index will result in an error in the future
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/ipykernel/\_\_main\_\_.py:47: VisibleDeprecationWarning: converting an array with ndim > 0 to an index will result in an error in the future
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/ipykernel/\_\_main\_\_.py:51: VisibleDeprecationWarning: converting an array with ndim > 0 to an index will result in an error in the future
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/ipykernel/\_\_main\_\_.py:55: VisibleDeprecationWarning: converting an array with ndim > 0 to an index will result in an error in the future
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/ipykernel/\_\_main\_\_.py:73: VisibleDeprecationWarning: converting an array with ndim > 0 to an index will result in an error in the future
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/ipykernel/\_\_main\_\_.py:77: VisibleDeprecationWarning: converting an array with ndim > 0 to an index will result in an error in the future
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/ipykernel/\_\_main\_\_.py:81: VisibleDeprecationWarning: converting an array with ndim > 0 to an index will result in an error in the future

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_38_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{}calc tx transport, acc transport}
        \PY{n}{cntrl\PYZus{}psi}\PY{o}{=}\PY{n}{cntrl}\PY{o}{.}\PY{n}{tx\PYZus{}trans}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{st\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{cumsum}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
        \PY{k}{print} \PY{n}{cntrl\PYZus{}psi}\PY{o}{.}\PY{n}{shape}
        
        \PY{c+c1}{\PYZsh{}calc tx transport, acc transport}
        \PY{n}{cntrl2\PYZus{}psi}\PY{o}{=}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{tx\PYZus{}trans}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{st\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{cumsum}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
        \PY{k}{print} \PY{n}{cntrl2\PYZus{}psi}\PY{o}{.}\PY{n}{shape}
        
        \PY{n}{cntrl\PYZus{}psi}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{concatenate}\PY{p}{(}\PY{p}{(}\PY{n}{cntrl\PYZus{}psi}\PY{p}{,}\PY{n}{cntrl2\PYZus{}psi}\PY{p}{)}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
        \PY{k}{print} \PY{n}{cntrl\PYZus{}psi}\PY{o}{.}\PY{n}{shape}
        
        \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{psi.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{a}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{cntrl\PYZus{}psi}\PY{p}{)}
        
        
        \PY{c+c1}{\PYZsh{}pert\PYZus{}psi=ff.tx\PYZus{}trans[:,:,:,:].sum(\PYZsq{}st\PYZus{}ocean\PYZsq{}).cumsum(\PYZsq{}yt\PYZus{}ocean\PYZsq{}).load()}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}99}]:} \PY{c+c1}{\PYZsh{}calc tx transport, acc transport}
         \PY{n}{pert\PYZus{}psi}\PY{o}{=}\PY{n}{pert}\PY{o}{.}\PY{n}{tx\PYZus{}trans}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{st\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{cumsum}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
         \PY{k}{print} \PY{n}{pert\PYZus{}psi}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{psi.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{a}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{pert\PYZus{}psi}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(34, 1080, 1440)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{c+c1}{\PYZsh{}load acc psi}
         \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{psi.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{pert\PYZus{}psi}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n}{of}\PY{p}{)}
         \PY{k}{print} \PY{n}{pert\PYZus{}psi}\PY{o}{.}\PY{n}{shape}
         
         \PY{c+c1}{\PYZsh{}of=os.path.join(NYFCntrlDir,\PYZsq{}cntrl\PYZus{}gmocs.npy\PYZsq{})}
         \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{psi.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cntrl\PYZus{}psi}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n}{of}\PY{p}{)}
         \PY{k}{print} \PY{n}{cntrl\PYZus{}psi}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(34, 1080, 1440)
(49, 1080, 1440)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}109}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{9.5}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{)}\PY{p}{)}
          \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
          \PY{c+c1}{\PYZsh{}plot ACC transport}
          
          \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{160}\PY{p}{,}\PY{l+m+mi}{160}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{)}
          \PY{k}{print} \PY{n}{clev}
          
          \PY{n}{clev2} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{160}\PY{p}{,}\PY{l+m+mi}{160}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{)}
          \PY{c+c1}{\PYZsh{}print clev2}
          
          \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
          \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{45}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
          \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
          \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
          \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
          \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{)} 
          \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}psi}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{9}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
          \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
          \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{c+c1}{\PYZsh{}clev3 = np.arange(0,200,20)}
          \PY{c+c1}{\PYZsh{}print clev3}
          \PY{n+nb}{map}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}psi}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{5}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev2}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{}clev3 = np.arange(1000,5001,1000)}
          \PY{c+c1}{\PYZsh{}print clev3}
          \PY{c+c1}{\PYZsh{}map.contour(X,Y,ht[:,:],levels=clev3,colors=\PYZsq{}c\PYZsq{},linewidths=1)    }
          
          \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Control Psi}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          
          \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
          \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{45}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
          \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
          \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
          \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
          \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
          \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{)} 
          \PY{n}{clev3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{5600}\PY{p}{,}\PY{l+m+mi}{100}\PY{p}{)}
          \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{ht}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev3}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
          \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
          \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{m}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{c+c1}{\PYZsh{}clev3 = np.arange(0,200,20)}
          \PY{c+c1}{\PYZsh{}print clev3}
          
          \PY{n}{clev3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1000}\PY{p}{,}\PY{l+m+mi}{5001}\PY{p}{,}\PY{l+m+mi}{1000}\PY{p}{)}
          \PY{k}{print} \PY{n}{clev3}
          \PY{n+nb}{map}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{ht}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev3}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}    
          \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Bathy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          
          \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[-160 -155 -150 -145 -140 -135 -130 -125 -120 -115 -110 -105 -100  -95  -90
  -85  -80  -75  -70  -65  -60  -55  -50  -45  -40  -35  -30  -25  -20  -15
  -10   -5    0    5   10   15   20   25   30   35   40   45   50   55   60
   65   70   75   80   85   90   95  100  105  110  115  120  125  130  135
  140  145  150  155]
[1000 2000 3000 4000 5000]

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_43_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{9.5}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{)}\PY{p}{)}
        \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}plt.suptitle(\PYZsq{}Psi Anom\PYZsq{})}
        \PY{c+c1}{\PYZsh{}plot ACC transport}
        \PY{n}{yrs}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1973}\PY{p}{,}\PY{l+m+mi}{2016}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
        
        \PY{n}{ii}\PY{o}{=}\PY{l+m+mi}{0}
        \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{160}\PY{p}{,}\PY{l+m+mi}{160}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{)}
        \PY{k}{print} \PY{n}{clev}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{45}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
        \PY{c+c1}{\PYZsh{}map.drawparallels(np.arange(\PYZhy{}80.,81.,15.))}
        \PY{c+c1}{\PYZsh{}map.drawmeridians(np.arange(\PYZhy{}160.,181.,40.),labels=[True,True,True,True])}
        \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{)} 
        \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}psi}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
        \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
        \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}clev3 = np.arange(0,200,20)}
        \PY{c+c1}{\PYZsh{}print clev3}
        \PY{c+c1}{\PYZsh{}map.contour(X,Y,np.mean(cntrl\PYZus{}psi[0:5],axis=0),levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=1)    }
        \PY{c+c1}{\PYZsh{}tit=yrs[yr].astype(\PYZsq{}S4\PYZsq{})}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NYF 10yr Avg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            
        \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{21}\PY{p}{)}
        
        \PY{k}{for} \PY{n}{yr} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{19}\PY{p}{)}\PY{p}{:}
            
            \PY{c+c1}{\PYZsh{}np.mean(pert\PYZus{}gmoc[t1:t2,:,:],axis=0)\PYZhy{}np.mean(cntrl\PYZus{}gmoc[t1:t2,:,:],axis=0)}
            \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{,}\PY{n}{yr}\PY{o}{+}\PY{l+m+mi}{2}\PY{p}{)}
            \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{45}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
            \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
            \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
            \PY{c+c1}{\PYZsh{}map.drawparallels(np.arange(\PYZhy{}80.,81.,15.))}
            \PY{c+c1}{\PYZsh{}map.drawmeridians(np.arange(\PYZhy{}160.,181.,40.),labels=[True,True,True,True])}
            \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{)} 
            \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{pert\PYZus{}psi}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{n}{cntrl\PYZus{}psi}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
            \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.7)}
            \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}Sv\PYZsq{})}
            \PY{c+c1}{\PYZsh{}clev3 = np.arange(0,200,20)}
            \PY{c+c1}{\PYZsh{}print clev3}
            \PY{c+c1}{\PYZsh{}map.contour(X,Y,np.mean(cntrl\PYZus{}psi[0:5],axis=0),levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=1)}
            
            \PY{n}{tit}\PY{o}{=}\PY{n}{yrs}\PY{p}{[}\PY{n}{yr}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{tit}\PY{p}{)}
            
            
        \PY{n}{ax3} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{axes}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.99}\PY{p}{,}\PY{l+m+mf}{0.38}\PY{p}{,}\PY{l+m+mf}{0.015}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{]}\PY{p}{)}
        \PY{n}{cb} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{p1}\PY{p}{,}\PY{n}{cax}\PY{o}{=}\PY{n}{ax3}\PY{p}{,}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
        \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}wpm2\PYZus{}cn.pdf\PYZsq{})}
        \PY{c+c1}{\PYZsh{}print of}
        \PY{c+c1}{\PYZsh{}plt.savefig(of)}
        \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}wpm2\PYZus{}cn.png\PYZsq{})}
        \PY{c+c1}{\PYZsh{}plt.savefig(of,dpi=220)}
        \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}gmoc\PYZus{}anom.pdf\PYZsq{})}
        \PY{c+c1}{\PYZsh{}print of}
        \PY{c+c1}{\PYZsh{}plt.savefig(of)}
        \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{psi\PYZus{}anom.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[-160 -155 -150 -145 -140 -135 -130 -125 -120 -115 -110 -105 -100  -95  -90
  -85  -80  -75  -70  -65  -60  -55  -50  -45  -40  -35  -30  -25  -20  -15
  -10   -5    0    5   10   15   20   25   30   35   40   45   50   55   60
   65   70   75   80   85   90   95  100  105  110  115  120  125  130  135
  140  145  150  155]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/mpl\_toolkits/basemap/\_\_init\_\_.py:1711: MatplotlibDeprecationWarning: The axesPatch function was deprecated in version 2.1. Use Axes.patch instead.
  if limb is not ax.axesPatch:
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/matplotlib/figure.py:1999: UserWarning: This figure includes Axes that are not compatible with tight\_layout, so results might be incorrect.
  warnings.warn("This figure includes Axes that are not compatible "

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_44_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{9.5}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         
         \PY{k}{print} \PY{n}{yrs}\PY{p}{[}\PY{l+m+mi}{8}\PY{p}{:}\PY{l+m+mi}{18}\PY{p}{]}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{21}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{45}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
         \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{)} 
         \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{pert\PYZus{}psi}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{8}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}psi}\PY{p}{[}\PY{l+m+mi}{0}\PY{o}{+}\PY{l+m+mi}{3}\PY{p}{:}\PY{l+m+mi}{8}\PY{o}{+}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
         \PY{c+c1}{\PYZsh{}p1=map.contourf(X,Y,np.mean(pert\PYZus{}psi[0:5],axis=0)\PYZhy{}np.mean(cntrl\PYZus{}psi[0:5],axis=0), cmap=plt.cm.PiYG, levels=clev, extend=\PYZsq{}both\PYZsq{}) \PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}clev3 = np.arange(0,200,20)}
         \PY{c+c1}{\PYZsh{}print clev3}
         \PY{c+c1}{\PYZsh{}map.contour(X,Y,np.mean(pert\PYZus{}psi[0:5],axis=0)\PYZhy{}np.mean(cntrl\PYZus{}psi[0:5],axis=0),levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=1)}
         \PY{n}{clev3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1000}\PY{p}{,}\PY{l+m+mi}{5001}\PY{p}{,}\PY{l+m+mi}{1000}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{ht}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev3}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}    
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1973\PYZhy{}1980 Anom.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}ax3 = plt.axes([0.92,0.38,0.015,0.25])}
         \PY{c+c1}{\PYZsh{}cb = plt.colorbar(p1,cax=ax3,orientation=\PYZsq{}vertical\PYZsq{})}
         \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}ylabel(\PYZsq{}Sv\PYZsq{})}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{45}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
         \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{)} 
         \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{pert\PYZus{}psi}\PY{p}{[}\PY{l+m+mi}{8}\PY{p}{:}\PY{l+m+mi}{18}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}psi}\PY{p}{[}\PY{l+m+mi}{8}\PY{o}{+}\PY{l+m+mi}{3}\PY{p}{:}\PY{l+m+mi}{18}\PY{o}{+}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}clev3 = np.arange(0,200,20)}
         \PY{c+c1}{\PYZsh{}print clev3}
         \PY{c+c1}{\PYZsh{}map.contour(X,Y,np.mean(pert\PYZus{}psi[4:7],axis=0)\PYZhy{}np.mean(cntrl\PYZus{}psi[4:7],axis=0),levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=1)}
         \PY{n}{clev3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1000}\PY{p}{,}\PY{l+m+mi}{5001}\PY{p}{,}\PY{l+m+mi}{1000}\PY{p}{)}
         \PY{k}{print} \PY{n}{clev3}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{ht}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev3}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}    
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1981\PYZhy{}1990 Anom.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}ax3 = plt.axes([0.92,0.38,0.015,0.25])}
         \PY{c+c1}{\PYZsh{}cb = plt.colorbar(p1,cax=ax3,orientation=\PYZsq{}vertical\PYZsq{})}
         \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}ylabel(\PYZsq{}Sv\PYZsq{})}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}psi.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{psi\PYZus{}anom\PYZus{}73\PYZhy{}90.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[1981 1982 1983 1984 1985 1986 1987 1988 1989 1990]
[1000 2000 3000 4000 5000]

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_45_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{45}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
         \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{)} 
         \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{pert\PYZus{}psi}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{10}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}psi}\PY{p}{[}\PY{l+m+mi}{0}\PY{o}{+}\PY{l+m+mi}{3}\PY{p}{:}\PY{l+m+mi}{10}\PY{o}{+}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}clev3 = np.arange(0,200,20)}
         \PY{c+c1}{\PYZsh{}print clev3}
         \PY{c+c1}{\PYZsh{}map.contour(X,Y,np.mean(pert\PYZus{}psi[4:7],axis=0)\PYZhy{}np.mean(cntrl\PYZus{}psi[4:7],axis=0),levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=1)}
         \PY{n}{clev3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1000}\PY{p}{,}\PY{l+m+mi}{5001}\PY{p}{,}\PY{l+m+mi}{1000}\PY{p}{)}
         \PY{k}{print} \PY{n}{clev3}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{ht}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev3}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}    
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{PSI Anom. 1973\PYZhy{}1983}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dp\PYZus{}ts.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[1000 2000 3000 4000 5000]

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}10}]:} Text(0.5,1,u'PSI Pert Yr 1-10 Anom.')
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_46_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{} do psi max between lon 67\PYZhy{}69S}
        \PY{n}{i1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{69}\PY{p}{)}
        \PY{n}{i2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{67}\PY{p}{)}
        \PY{n}{i1}\PY{o}{=}\PY{n}{i1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{i2}\PY{o}{=}\PY{n}{i2}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        
        \PY{n}{j1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{54}\PY{p}{)}
        \PY{n}{j1}\PY{o}{=}\PY{n}{j1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        
        \PY{k}{print} \PY{n}{j1}\PY{p}{,} \PY{n}{i1}\PY{p}{,} \PY{n}{i2}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{c+c1}{\PYZsh{}plot Drake Passage time series}
         
         \PY{n}{yrs}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1973}\PY{p}{,}\PY{l+m+mi}{2016}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{T}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{50}\PY{p}{)}
         \PY{k}{print} \PY{n}{T}\PY{o}{.}\PY{n}{shape}
         
         
         \PY{n}{ts} \PY{o}{=}\PY{n}{pert}\PY{o}{.}\PY{n}{tx\PYZus{}trans}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         \PY{k}{print} \PY{n}{ts}
         \PY{k}{print} \PY{n}{pert\PYZus{}psi}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         \PY{n}{ts}\PY{o}{=}\PY{l+m+mi}{34}
         \PY{c+c1}{\PYZsh{}print yrs[yr].astype(\PYZsq{}S4\PYZsq{})}
         \PY{c+c1}{\PYZsh{}tit=yrs[yr].astype(\PYZsq{}S4\PYZsq{})}
         \PY{c+c1}{\PYZsh{}plt.title(yrs[yr])plt.title(yrs[yr])}
         
         \PY{c+c1}{\PYZsh{} do ACC psi max between lon 67\PYZhy{}69S}
         \PY{n}{i1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{69}\PY{p}{)}
         \PY{n}{i2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{67}\PY{p}{)}
         \PY{n}{i1}\PY{o}{=}\PY{n}{i1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{i2}\PY{o}{=}\PY{n}{i2}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         
         \PY{n}{j1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{54}\PY{p}{)}
         \PY{n}{j1}\PY{o}{=}\PY{n}{j1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         
         \PY{k}{print} \PY{n}{j1}\PY{p}{,} \PY{n}{i1}\PY{p}{,} \PY{n}{i2}
         
         \PY{n}{cntrl\PYZus{}dp} \PY{o}{=} \PY{n}{cntrl\PYZus{}psi}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{j1}\PY{p}{,}\PY{n}{i1}\PY{p}{:}\PY{n}{i2}\PY{p}{]}
         \PY{n}{cntrl\PYZus{}dp\PYZus{}bar} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}dp}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{cntrl\PYZus{}dp\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{cntrl\PYZus{}dp\PYZus{}bar}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{pert\PYZus{}dp} \PY{o}{=} \PY{n}{pert\PYZus{}psi}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{j1}\PY{p}{,}\PY{n}{i1}\PY{p}{:}\PY{n}{i2}\PY{p}{]}
         \PY{n}{pert\PYZus{}dp\PYZus{}bar} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{pert\PYZus{}dp}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{pert\PYZus{}dp\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{pert\PYZus{}dp\PYZus{}bar}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{211}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{ts}\PY{p}{]}\PY{p}{,}\PY{n}{cntrl\PYZus{}dp\PYZus{}ts}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{:}\PY{n}{ts}\PY{o}{+}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Control}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{1.5}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{ts}\PY{p}{]}\PY{p}{,}\PY{n}{pert\PYZus{}dp\PYZus{}ts}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{ts}\PY{p}{]}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Perturbed}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1035))}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Transport (Sv)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Years}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.xlim([\PYZhy{}75,85])}
         \PY{n}{tit}\PY{o}{=}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Drake Passage Transport}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{tit}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} do Weddell Gyre psi min between lon 67\PYZhy{}69S}
         \PY{n}{i1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{60}\PY{p}{)}
         \PY{n}{i2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{l+m+mi}{15}\PY{p}{)}
         \PY{n}{i1}\PY{o}{=}\PY{n}{i1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{i2}\PY{o}{=}\PY{n}{i2}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         
         \PY{n}{j1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{62}\PY{p}{)}
         \PY{n}{j1}\PY{o}{=}\PY{n}{j1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         
         \PY{k}{print} \PY{n}{j1}\PY{p}{,} \PY{n}{i1}\PY{p}{,} \PY{n}{i2}
         
         \PY{n}{cntrl\PYZus{}wg} \PY{o}{=} \PY{n}{cntrl\PYZus{}psi}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{j1}\PY{p}{,}\PY{n}{i1}\PY{p}{:}\PY{n}{i2}\PY{p}{]}
         \PY{c+c1}{\PYZsh{}cntrl\PYZus{}wg\PYZus{}bar = np.mean(cntrl\PYZus{}wg,2)}
         \PY{n}{cntrl\PYZus{}wg\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{cntrl\PYZus{}wg}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{pert\PYZus{}wg} \PY{o}{=} \PY{n}{pert\PYZus{}psi}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{j1}\PY{p}{,}\PY{n}{i1}\PY{p}{:}\PY{n}{i2}\PY{p}{]}
         \PY{c+c1}{\PYZsh{}pert\PYZus{}wg\PYZus{}bar = np.mean(pert\PYZus{}wg,2)}
         \PY{n}{pert\PYZus{}wg\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{pert\PYZus{}wg}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{212}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{ts}\PY{p}{]}\PY{p}{,}\PY{n}{cntrl\PYZus{}wg\PYZus{}ts}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{:}\PY{n}{ts}\PY{o}{+}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Control}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{1.5}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{ts}\PY{p}{]}\PY{p}{,}\PY{n}{pert\PYZus{}wg\PYZus{}ts}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{ts}\PY{p}{]}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Perturbed}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1035))}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Transport (Sv)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Years}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.xlim([\PYZhy{}75,85])}
         \PY{n}{tit}\PY{o}{=}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Weddell Gyre Transport}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{tit}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}dp\PYZus{}ts.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dp\PYZus{}ts.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(50,)
40
34
[239] [843] [851]
[179] [879] [1179]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/ipykernel/\_\_main\_\_.py:27: VisibleDeprecationWarning: converting an array with ndim > 0 to an index will result in an error in the future
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/ipykernel/\_\_main\_\_.py:31: VisibleDeprecationWarning: converting an array with ndim > 0 to an index will result in an error in the future
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/ipykernel/\_\_main\_\_.py:57: VisibleDeprecationWarning: converting an array with ndim > 0 to an index will result in an error in the future
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/ipykernel/\_\_main\_\_.py:61: VisibleDeprecationWarning: converting an array with ndim > 0 to an index will result in an error in the future

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_48_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{c+c1}{\PYZsh{}plot temp}
        \PY{k}{print} \PY{n}{cntrl}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}
        \PY{k}{print} \PY{n}{cntrl2}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}
        \PY{k}{print} \PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(9, 50, 1080, 1440)
(40, 50, 1080, 1440)
(40, 50, 1080, 1440)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}24}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{12.5}\PY{p}{,}\PY{l+m+mf}{9.5}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Temp Anomaly 55m}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{yrs}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1973}\PY{p}{,}\PY{l+m+mi}{2016}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{41}\PY{p}{)}
         \PY{k}{print} \PY{n}{clev}
         \PY{n}{st}\PY{o}{=}\PY{l+m+mi}{5}
         \PY{k}{print} \PY{n}{st\PYZus{}ocean}\PY{p}{[}\PY{n}{st}\PY{p}{]}
         \PY{n}{ii}\PY{o}{=}\PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{yr} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{)}\PY{p}{:}
             \PY{c+c1}{\PYZsh{}print yr}
         
             \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{,}\PY{n}{yr}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{55}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
             \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
             \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
             \PY{c+c1}{\PYZsh{}map.drawparallels(np.arange(\PYZhy{}80.,81.,15.))}
             \PY{c+c1}{\PYZsh{}map.drawmeridians(np.arange(\PYZhy{}160.,181.,40.),labels=[True,True,True,True])}
             \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)} 
             
             \PY{k}{if} \PY{n}{yr}\PY{o}{\PYZlt{}}\PY{l+m+mi}{6}\PY{p}{:}
                 \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{n}{yr}\PY{o}{+}\PY{l+m+mi}{3}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
             \PY{k}{else}\PY{p}{:}
                 \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{n}{yr}\PY{o}{\PYZhy{}}\PY{l+m+mi}{6}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
             \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.5)}
             \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}N/m2\PYZsq{})}
             \PY{n}{clev3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{5000}\PY{p}{,}\PY{l+m+mi}{1000}\PY{p}{)}
             \PY{n+nb}{map}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{ht}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev3}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{n}{yr}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{ax3} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{axes}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.98}\PY{p}{,}\PY{l+m+mf}{0.38}\PY{p}{,}\PY{l+m+mf}{0.015}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{]}\PY{p}{)}
         \PY{n}{cb} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{p1}\PY{p}{,}\PY{n}{cax}\PY{o}{=}\PY{n}{ax3}\PY{p}{,}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}temp\PYZus{}55m.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{temp\PYZus{}55m.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[-2.  -1.9 -1.8 -1.7 -1.6 -1.5 -1.4 -1.3 -1.2 -1.1 -1.  -0.9 -0.8 -0.7 -0.6
 -0.5 -0.4 -0.3 -0.2 -0.1  0.   0.1  0.2  0.3  0.4  0.5  0.6  0.7  0.8  0.9
  1.   1.1  1.2  1.3  1.4  1.5  1.6  1.7  1.8  1.9  2. ]
55.8532485962

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_50_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}25}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{12.5}\PY{p}{,}\PY{l+m+mf}{9.5}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Temp Anomaly 1500m}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{yrs}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1973}\PY{p}{,}\PY{l+m+mi}{2016}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{o}{.}\PY{l+m+mi}{5}\PY{p}{,}\PY{o}{.}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{41}\PY{p}{)}
         \PY{k}{print} \PY{n}{clev}
         \PY{n}{st}\PY{o}{=}\PY{l+m+mi}{30}
         \PY{k}{print} \PY{n}{st\PYZus{}ocean}\PY{p}{[}\PY{n}{st}\PY{p}{]}
         \PY{n}{ii}\PY{o}{=}\PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{yr} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{)}\PY{p}{:}
             \PY{c+c1}{\PYZsh{}print yr}
         
             \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{,}\PY{n}{yr}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{55}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
             \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
             \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
             \PY{c+c1}{\PYZsh{}map.drawparallels(np.arange(\PYZhy{}80.,81.,15.))}
             \PY{c+c1}{\PYZsh{}map.drawmeridians(np.arange(\PYZhy{}160.,181.,40.),labels=[True,True,True,True])}
             \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)} 
             
             \PY{k}{if} \PY{n}{yr}\PY{o}{\PYZlt{}}\PY{l+m+mi}{6}\PY{p}{:}
                 \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{n}{yr}\PY{o}{+}\PY{l+m+mi}{3}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
             \PY{k}{else}\PY{p}{:}
                 \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{n}{yr}\PY{o}{\PYZhy{}}\PY{l+m+mi}{6}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
             
             \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.5)}
             \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}N/m2\PYZsq{})}
             \PY{n}{clev3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{5000}\PY{p}{,}\PY{l+m+mi}{1000}\PY{p}{)}
             \PY{n+nb}{map}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{ht}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev3}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{n}{yr}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{ax3} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{axes}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.92}\PY{p}{,}\PY{l+m+mf}{0.38}\PY{p}{,}\PY{l+m+mf}{0.015}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{]}\PY{p}{)}
         \PY{n}{cb} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{p1}\PY{p}{,}\PY{n}{cax}\PY{o}{=}\PY{n}{ax3}\PY{p}{,}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}temp\PYZus{}1500m.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{temp\PYZus{}1500m.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[-0.5   -0.475 -0.45  -0.425 -0.4   -0.375 -0.35  -0.325 -0.3   -0.275
 -0.25  -0.225 -0.2   -0.175 -0.15  -0.125 -0.1   -0.075 -0.05  -0.025  0.
  0.025  0.05   0.075  0.1    0.125  0.15   0.175  0.2    0.225  0.25
  0.275  0.3    0.325  0.35   0.375  0.4    0.425  0.45   0.475  0.5  ]
1497.56188965

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_51_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}27}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{12.5}\PY{p}{,}\PY{l+m+mf}{9.5}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Temp Anomaly 4000m}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{yrs}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1973}\PY{p}{,}\PY{l+m+mi}{2016}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{o}{.}\PY{l+m+mi}{3}\PY{p}{,}\PY{o}{.}\PY{l+m+mi}{31}\PY{p}{,}\PY{o}{.}\PY{l+m+mo}{01}\PY{p}{)}
         \PY{k}{print} \PY{n}{clev}
         \PY{n}{st}\PY{o}{=}\PY{l+m+mi}{42}
         \PY{k}{print} \PY{n}{st\PYZus{}ocean}\PY{p}{[}\PY{n}{st}\PY{p}{]}
         \PY{n}{ii}\PY{o}{=}\PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{yr} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{)}\PY{p}{:}
             \PY{c+c1}{\PYZsh{}print yr}
         
             \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{,}\PY{n}{yr}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{55}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
             \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
             \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
             \PY{c+c1}{\PYZsh{}map.drawparallels(np.arange(\PYZhy{}80.,81.,15.))}
             \PY{c+c1}{\PYZsh{}map.drawmeridians(np.arange(\PYZhy{}160.,181.,40.),labels=[True,True,True,True])}
             \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)} 
             \PY{k}{if} \PY{n}{yr}\PY{o}{\PYZlt{}}\PY{l+m+mi}{6}\PY{p}{:}
                 \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{n}{yr}\PY{o}{+}\PY{l+m+mi}{3}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
             \PY{k}{else}\PY{p}{:}
                 \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{n}{yr}\PY{o}{\PYZhy{}}\PY{l+m+mi}{6}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
             \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.5)}
             \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}N/m2\PYZsq{})}
             \PY{c+c1}{\PYZsh{}clev3 = np.arange(0,5000,1000)}
             \PY{c+c1}{\PYZsh{}map.contour(X,Y,ht[0:500,:],levels=clev3,colors=\PYZsq{}k\PYZsq{},linewidths=1)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{n}{yr}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{ax3} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{axes}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.99}\PY{p}{,}\PY{l+m+mf}{0.38}\PY{p}{,}\PY{l+m+mf}{0.015}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{]}\PY{p}{)}
         \PY{n}{cb} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{p1}\PY{p}{,}\PY{n}{cax}\PY{o}{=}\PY{n}{ax3}\PY{p}{,}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}temp\PYZus{}4000m.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{temp\PYZus{}4000m.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[ -3.00000000e-01  -2.90000000e-01  -2.80000000e-01  -2.70000000e-01
  -2.60000000e-01  -2.50000000e-01  -2.40000000e-01  -2.30000000e-01
  -2.20000000e-01  -2.10000000e-01  -2.00000000e-01  -1.90000000e-01
  -1.80000000e-01  -1.70000000e-01  -1.60000000e-01  -1.50000000e-01
  -1.40000000e-01  -1.30000000e-01  -1.20000000e-01  -1.10000000e-01
  -1.00000000e-01  -9.00000000e-02  -8.00000000e-02  -7.00000000e-02
  -6.00000000e-02  -5.00000000e-02  -4.00000000e-02  -3.00000000e-02
  -2.00000000e-02  -1.00000000e-02   2.77555756e-16   1.00000000e-02
   2.00000000e-02   3.00000000e-02   4.00000000e-02   5.00000000e-02
   6.00000000e-02   7.00000000e-02   8.00000000e-02   9.00000000e-02
   1.00000000e-01   1.10000000e-01   1.20000000e-01   1.30000000e-01
   1.40000000e-01   1.50000000e-01   1.60000000e-01   1.70000000e-01
   1.80000000e-01   1.90000000e-01   2.00000000e-01   2.10000000e-01
   2.20000000e-01   2.30000000e-01   2.40000000e-01   2.50000000e-01
   2.60000000e-01   2.70000000e-01   2.80000000e-01   2.90000000e-01
   3.00000000e-01]
3926.81274414

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_52_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}23}]:} \PY{k}{print} \PY{n}{st\PYZus{}ocean}\PY{p}{[}\PY{l+m+mi}{45}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
4555.56591797

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{12.5}\PY{p}{,}\PY{l+m+mf}{9.5}\PY{p}{)}\PY{p}{)}
        \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
        
        \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{o}{.}\PY{l+m+mi}{2}\PY{p}{,}\PY{o}{.}\PY{l+m+mi}{21}\PY{p}{,}\PY{o}{.}\PY{l+m+mo}{01}\PY{p}{)}
        \PY{k}{print} \PY{n}{clev}
        \PY{n}{st}\PY{o}{=}\PY{l+m+mi}{30}
        \PY{k}{print} \PY{n}{st\PYZus{}ocean}\PY{p}{[}\PY{n}{st}\PY{p}{]}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{25}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
        \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)} 
        \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{l+m+mi}{8}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
        \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.5)}
        \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}C\PYZsq{})}
        \PY{c+c1}{\PYZsh{}clev3 = np.arange(1000,5001,1000)}
        \PY{c+c1}{\PYZsh{}map.contour(X,Y,ht[0:500,:],levels=clev3,colors=\PYZsq{}k\PYZsq{},linewidths=1)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1974\PYZhy{}1980 Temp Anom at 1500m }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{25}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
        \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}cntrl starts 1971, pert in 1973.}
        \PY{c+c1}{\PYZsh{}cntrl Tdim ends in 1980, normal starts 1981}
        \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{l+m+mi}{8}\PY{p}{:}\PY{l+m+mi}{18}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{10}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
        \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.5)}
        \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}C\PYZsq{})}
        \PY{c+c1}{\PYZsh{}clev3 = np.arange(1000,5001,1000)}
        \PY{c+c1}{\PYZsh{}map.contour(X,Y,ht[0:500,:],levels=clev3,colors=\PYZsq{}k\PYZsq{},linewidths=1)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1981\PYZhy{}1990 Temp Anom at 1500m }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}
        \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{25}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
        \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)} 
        \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{l+m+mi}{18}\PY{p}{:}\PY{l+m+mi}{28}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{l+m+mi}{10}\PY{p}{:}\PY{l+m+mi}{20}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
        \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.5)}
        \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}C\PYZsq{})}
        \PY{c+c1}{\PYZsh{}clev3 = np.arange(1000,5001,1000)}
        \PY{c+c1}{\PYZsh{}map.contour(X,Y,ht[0:500,:],levels=clev3,colors=\PYZsq{}k\PYZsq{},linewidths=1)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1991\PYZhy{}2000 Temp Anom at 1500m }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{n}{ax3} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{axes}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.99}\PY{p}{,}\PY{l+m+mf}{0.38}\PY{p}{,}\PY{l+m+mf}{0.015}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{]}\PY{p}{)}
        \PY{n}{cb} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{p1}\PY{p}{,}\PY{n}{cax}\PY{o}{=}\PY{n}{ax3}\PY{p}{,}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
        \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{}ax3 = plt.axes([0.92,0.38,0.015,0.25])}
        \PY{c+c1}{\PYZsh{}cb = plt.colorbar(p1,cax=ax3,orientation=\PYZsq{}vertical\PYZsq{})}
        \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
        \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}C\PYZsq{})}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[ -2.00000000e-01  -1.90000000e-01  -1.80000000e-01  -1.70000000e-01
  -1.60000000e-01  -1.50000000e-01  -1.40000000e-01  -1.30000000e-01
  -1.20000000e-01  -1.10000000e-01  -1.00000000e-01  -9.00000000e-02
  -8.00000000e-02  -7.00000000e-02  -6.00000000e-02  -5.00000000e-02
  -4.00000000e-02  -3.00000000e-02  -2.00000000e-02  -1.00000000e-02
   1.66533454e-16   1.00000000e-02   2.00000000e-02   3.00000000e-02
   4.00000000e-02   5.00000000e-02   6.00000000e-02   7.00000000e-02
   8.00000000e-02   9.00000000e-02   1.00000000e-01   1.10000000e-01
   1.20000000e-01   1.30000000e-01   1.40000000e-01   1.50000000e-01
   1.60000000e-01   1.70000000e-01   1.80000000e-01   1.90000000e-01
   2.00000000e-01]
1497.56188965

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/mpl\_toolkits/basemap/\_\_init\_\_.py:1711: MatplotlibDeprecationWarning: The axesPatch function was deprecated in version 2.1. Use Axes.patch instead.
  if limb is not ax.axesPatch:
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/dask/array/numpy\_compat.py:45: RuntimeWarning: invalid value encountered in divide
  x = np.divide(x1, x2, out)
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/matplotlib/figure.py:1999: UserWarning: This figure includes Axes that are not compatible with tight\_layout, so results might be incorrect.
  warnings.warn("This figure includes Axes that are not compatible "

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_54_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}35}]:} \PY{k}{print} \PY{n}{yrs}
         \PY{k}{print} \PY{n}{yrs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{l+m+mi}{8}\PY{p}{]}
         \PY{k}{print} \PY{n}{yrs}\PY{p}{[}\PY{l+m+mi}{8}\PY{p}{:}\PY{l+m+mi}{18}\PY{p}{]}
         \PY{k}{print} \PY{n}{yrs}\PY{p}{[}\PY{l+m+mi}{18}\PY{p}{:}\PY{l+m+mi}{29}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[1973 1974 1975 1976 1977 1978 1979 1980 1981 1982 1983 1984 1985 1986 1987
 1988 1989 1990 1991 1992 1993 1994 1995 1996 1997 1998 1999 2000 2001 2002
 2003 2004 2005 2006 2007 2008 2009 2010 2011 2012 2013 2014 2015]
[1974 1975 1976 1977 1978 1979 1980]
[1981 1982 1983 1984 1985 1986 1987 1988 1989 1990]
[1991 1992 1993 1994 1995 1996 1997 1998 1999 2000 2001]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{12.5}\PY{p}{,}\PY{l+m+mf}{9.5}\PY{p}{)}\PY{p}{)}
        \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
        
        \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{o}{.}\PY{l+m+mi}{2}\PY{p}{,}\PY{o}{.}\PY{l+m+mi}{21}\PY{p}{,}\PY{o}{.}\PY{l+m+mo}{01}\PY{p}{)}
        \PY{k}{print} \PY{n}{clev}
        
        \PY{n}{st}\PY{o}{=}\PY{l+m+mi}{45}
        \PY{k}{print} \PY{n}{st\PYZus{}ocean}\PY{p}{[}\PY{l+m+mi}{45}\PY{p}{]}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{25}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
        \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)} 
        \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{l+m+mi}{8}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
        \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.5)}
        \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}C\PYZsq{})}
        \PY{c+c1}{\PYZsh{}clev3 = np.arange(1000,5001,1000)}
        \PY{c+c1}{\PYZsh{}map.contour(X,Y,ht[0:500,:],levels=clev3,colors=\PYZsq{}k\PYZsq{},linewidths=1)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1974\PYZhy{}1980 Temp Anom at 4500m }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{25}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
        \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)} 
        \PY{c+c1}{\PYZsh{}cntrl starts 1971, pert in 1973.}
        \PY{c+c1}{\PYZsh{}cntrl Tdim ends in 1980, normal starts 1981}
        \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{l+m+mi}{8}\PY{p}{:}\PY{l+m+mi}{18}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{10}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
        \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.5)}
        \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}C\PYZsq{})}
        \PY{c+c1}{\PYZsh{}clev3 = np.arange(1000,5001,1000)}
        \PY{c+c1}{\PYZsh{}map.contour(X,Y,ht[0:500,:],levels=clev3,colors=\PYZsq{}k\PYZsq{},linewidths=1)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1981\PYZhy{}1990 Temp Anom at 4500m }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}
        \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{25}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
        \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)} 
        \PY{c+c1}{\PYZsh{}cntrl starts 1971, pert in 1973.}
        \PY{c+c1}{\PYZsh{}cntrl Tdim ends in 1980, normal starts 1981}
        \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{l+m+mi}{18}\PY{p}{:}\PY{l+m+mi}{28}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{l+m+mi}{10}\PY{p}{:}\PY{l+m+mi}{20}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
        \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.5)}
        \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}C\PYZsq{})}
        \PY{c+c1}{\PYZsh{}clev3 = np.arange(1000,5001,1000)}
        \PY{c+c1}{\PYZsh{}map.contour(X,Y,ht[0:500,:],levels=clev3,colors=\PYZsq{}k\PYZsq{},linewidths=1)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1991\PYZhy{}2000 Temp Anom at 4500m }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{n}{ax3} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{axes}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.99}\PY{p}{,}\PY{l+m+mf}{0.38}\PY{p}{,}\PY{l+m+mf}{0.015}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{]}\PY{p}{)}
        \PY{n}{cb} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{p1}\PY{p}{,}\PY{n}{cax}\PY{o}{=}\PY{n}{ax3}\PY{p}{,}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
        \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{}ax3 = plt.axes([0.92,0.38,0.015,0.25])}
        \PY{c+c1}{\PYZsh{}cb = plt.colorbar(p1,cax=ax3,orientation=\PYZsq{}vertical\PYZsq{})}
        \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
        \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}C\PYZsq{})}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[ -2.00000000e-01  -1.90000000e-01  -1.80000000e-01  -1.70000000e-01
  -1.60000000e-01  -1.50000000e-01  -1.40000000e-01  -1.30000000e-01
  -1.20000000e-01  -1.10000000e-01  -1.00000000e-01  -9.00000000e-02
  -8.00000000e-02  -7.00000000e-02  -6.00000000e-02  -5.00000000e-02
  -4.00000000e-02  -3.00000000e-02  -2.00000000e-02  -1.00000000e-02
   1.66533454e-16   1.00000000e-02   2.00000000e-02   3.00000000e-02
   4.00000000e-02   5.00000000e-02   6.00000000e-02   7.00000000e-02
   8.00000000e-02   9.00000000e-02   1.00000000e-01   1.10000000e-01
   1.20000000e-01   1.30000000e-01   1.40000000e-01   1.50000000e-01
   1.60000000e-01   1.70000000e-01   1.80000000e-01   1.90000000e-01
   2.00000000e-01]
4555.56591797

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_56_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}9}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{12.5}\PY{p}{,}\PY{l+m+mf}{9.5}\PY{p}{)}\PY{p}{)}
        \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{(1991\PYZhy{}2000)\PYZhy{}(1981\PYZhy{}1990) Decadal Temp Anom}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{o}{.}\PY{l+m+mi}{2}\PY{p}{,}\PY{o}{.}\PY{l+m+mi}{21}\PY{p}{,}\PY{o}{.}\PY{l+m+mo}{01}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}print clev}
        
        \PY{n}{st}\PY{o}{=}\PY{l+m+mi}{30}
        \PY{k}{print} \PY{n}{st\PYZus{}ocean}\PY{p}{[}\PY{l+m+mi}{30}\PY{p}{]}
        
        \PY{n}{var1}\PY{o}{=}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{l+m+mi}{8}\PY{p}{:}\PY{l+m+mi}{18}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{10}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
        \PY{n}{var2}\PY{o}{=}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{l+m+mi}{18}\PY{p}{:}\PY{l+m+mi}{28}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{l+m+mi}{10}\PY{p}{:}\PY{l+m+mi}{20}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{25}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
        \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)} 
        \PY{c+c1}{\PYZsh{}cntrl starts 1971, pert in 1973.}
        \PY{c+c1}{\PYZsh{}cntrl Tdim ends in 1980, normal starts 1981}
        \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{var2}\PY{o}{\PYZhy{}}\PY{n}{var1}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
        \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.5)}
        \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}C\PYZsq{})}
        \PY{c+c1}{\PYZsh{}clev3 = np.arange(1000,5001,1000)}
        \PY{c+c1}{\PYZsh{}map.contour(X,Y,ht[0:500,:],levels=clev3,colors=\PYZsq{}k\PYZsq{},linewidths=1)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1500m }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        
        \PY{n}{st}\PY{o}{=}\PY{l+m+mi}{35}
        \PY{k}{print} \PY{n}{st\PYZus{}ocean}\PY{p}{[}\PY{n}{st}\PY{p}{]}
        \PY{n}{var1}\PY{o}{=}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{l+m+mi}{8}\PY{p}{:}\PY{l+m+mi}{18}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{10}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
        \PY{n}{var2}\PY{o}{=}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{l+m+mi}{18}\PY{p}{:}\PY{l+m+mi}{28}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{l+m+mi}{10}\PY{p}{:}\PY{l+m+mi}{20}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{25}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
        \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)} 
        \PY{c+c1}{\PYZsh{}cntrl starts 1971, pert in 1973.}
        \PY{c+c1}{\PYZsh{}cntrl Tdim ends in 1980, normal starts 1981}
        \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{var2}\PY{o}{\PYZhy{}}\PY{n}{var1}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
        \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.5)}
        \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}C\PYZsq{})}
        \PY{c+c1}{\PYZsh{}clev3 = np.arange(1000,5001,1000)}
        \PY{c+c1}{\PYZsh{}map.contour(X,Y,ht[0:500,:],levels=clev3,colors=\PYZsq{}k\PYZsq{},linewidths=1)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2500m }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{n}{st}\PY{o}{=}\PY{l+m+mi}{40}
        \PY{k}{print} \PY{n}{st\PYZus{}ocean}\PY{p}{[}\PY{n}{st}\PY{p}{]}
        \PY{n}{var1}\PY{o}{=}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{l+m+mi}{8}\PY{p}{:}\PY{l+m+mi}{18}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{10}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
        \PY{n}{var2}\PY{o}{=}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{l+m+mi}{18}\PY{p}{:}\PY{l+m+mi}{28}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{l+m+mi}{10}\PY{p}{:}\PY{l+m+mi}{20}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}
        \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{25}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
        \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)} 
        \PY{c+c1}{\PYZsh{}cntrl starts 1971, pert in 1973.}
        \PY{c+c1}{\PYZsh{}cntrl Tdim ends in 1980, normal starts 1981}
        \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{var2}\PY{o}{\PYZhy{}}\PY{n}{var1}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
        \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.5)}
        \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}C\PYZsq{})}
        \PY{c+c1}{\PYZsh{}clev3 = np.arange(1000,5001,1000)}
        \PY{c+c1}{\PYZsh{}map.contour(X,Y,ht[0:500,:],levels=clev3,colors=\PYZsq{}k\PYZsq{},linewidths=1)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{3500m }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{n}{st}\PY{o}{=}\PY{l+m+mi}{45}
        \PY{k}{print} \PY{n}{st\PYZus{}ocean}\PY{p}{[}\PY{n}{st}\PY{p}{]}
        \PY{n}{var1}\PY{o}{=}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{l+m+mi}{8}\PY{p}{:}\PY{l+m+mi}{18}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{10}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
        \PY{n}{var2}\PY{o}{=}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{l+m+mi}{18}\PY{p}{:}\PY{l+m+mi}{28}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{l+m+mi}{10}\PY{p}{:}\PY{l+m+mi}{20}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{)}
        \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{25}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
        \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)} 
        \PY{c+c1}{\PYZsh{}cntrl starts 1971, pert in 1973.}
        \PY{c+c1}{\PYZsh{}cntrl Tdim ends in 1980, normal starts 1981}
        \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{var2}\PY{o}{\PYZhy{}}\PY{n}{var1}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
        \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.5)}
        \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}C\PYZsq{})}
        \PY{c+c1}{\PYZsh{}clev3 = np.arange(1000,5001,1000)}
        \PY{c+c1}{\PYZsh{}map.contour(X,Y,ht[0:500,:],levels=clev3,colors=\PYZsq{}k\PYZsq{},linewidths=1)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{4500m }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{n}{ax3} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{axes}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.99}\PY{p}{,}\PY{l+m+mf}{0.38}\PY{p}{,}\PY{l+m+mf}{0.015}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{]}\PY{p}{)}
        \PY{n}{cb} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{p1}\PY{p}{,}\PY{n}{cax}\PY{o}{=}\PY{n}{ax3}\PY{p}{,}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
        \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
        
        \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Decadal\PYZus{}Tanom\PYZus{}Zs.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{}ax3 = plt.axes([0.92,0.38,0.015,0.25])}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
1497.56188965
2474.04296875
3508.63305664
4555.56591797

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_57_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} 
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[ 1497.56188965  1683.05725098  1874.78820801  2071.25195312  2271.32324219
  2474.04296875  2678.75708008  2884.89794922  3092.1171875   3300.0859375 ]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}24}]:} \PY{c+c1}{\PYZsh{}calc zonal average temp anomalies}
         \PY{c+c1}{\PYZsh{}Plot zonal average temp anomaly across weddell}
         \PY{n}{x1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{40}\PY{p}{)}
         \PY{n}{x2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{l+m+mi}{15}\PY{p}{)}
         \PY{n}{x1}\PY{o}{=}\PY{n}{x1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{x2}\PY{o}{=}\PY{n}{x2}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         
         \PY{n}{y1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{65}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}y2=np.argwhere(xt\PYZus{}ocean\PYZlt{}15)}
         \PY{n}{y1}\PY{o}{=}\PY{n}{y1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{c+c1}{\PYZsh{}y2=y2[\PYZhy{}1]}
         \PY{k}{print} \PY{n}{x1}\PY{p}{,} \PY{n}{x2}
         
         \PY{c+c1}{\PYZsh{}print xt\PYZus{}ocean[x1:x2]}
         \PY{c+c1}{\PYZsh{}print yt\PYZus{}ocean[:y1]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[959] [1179]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{12.5}\PY{p}{,}\PY{l+m+mf}{9.5}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Zonal Average Temp Anom 40W\PYZhy{}15E}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}print cntrl.temp.shape}
         \PY{c+c1}{\PYZsh{}print pert.temp.shape}
         
         \PY{c+c1}{\PYZsh{}plt.subplot(211)}
         \PY{c+c1}{\PYZsh{}clev = np.arange(\PYZhy{}2,20,1)}
         \PY{c+c1}{\PYZsh{}plt.contourf(yt\PYZus{}ocean[0:500],st\PYZus{}ocean,np.mean(cntrl\PYZus{}temp[:,:,x1:x2],axis=2),cmap=plt.cm.PiYG,levels=clev,extend=\PYZsq{}both\PYZsq{})}
         \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.7)}
         \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}Temp\PYZsq{})}
         \PY{c+c1}{\PYZsh{}plt.contour(yt\PYZus{}ocean[0:500],st\PYZus{}ocean,np.mean(cntrl\PYZus{}temp[:,:,x1:x2],axis=2),levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=0.25)}
         \PY{c+c1}{\PYZsh{}plt.contour(yt\PYZus{}ocean[0:500],st\PYZus{}ocean,np.mean(cntrl\PYZus{}temp[:,:,x1:x2],axis=2),levels=[0.0,],colors=\PYZsq{}k\PYZsq{},linewidths=0.5)}
         \PY{c+c1}{\PYZsh{}plt.gca().invert\PYZus{}yaxis()}
         \PY{c+c1}{\PYZsh{}\PYZsh{}plt.gca().yaxis.set\PYZus{}major\PYZus{}formatter(x\PYZus{}formatter)}
         \PY{c+c1}{\PYZsh{}\PYZsh{}plt.ylim((1037.5,1034))}
         \PY{c+c1}{\PYZsh{}plt.ylabel(\PYZsq{}Depth (m)\PYZsq{})}
         \PY{c+c1}{\PYZsh{}plt.xlabel(\PYZsq{}Latitude (\PYZdl{}\PYZca{}\PYZbs{}circ\PYZdl{}S)\PYZsq{})}
         \PY{c+c1}{\PYZsh{}plt.xlim([\PYZhy{}75,\PYZhy{}50])}
         \PY{c+c1}{\PYZsh{}plt.title(\PYZsq{}Control Temp\PYZsq{})}
         
         \PY{n}{yrs}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1973}\PY{p}{,}\PY{l+m+mi}{2016}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{ii}\PY{o}{=}\PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{yr} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{30}\PY{p}{)}\PY{p}{:}
             \PY{c+c1}{\PYZsh{}print yr}
         
             \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{6}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{,}\PY{n}{yr}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}color}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.25}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{o}{.}\PY{l+m+mi}{7}\PY{p}{,}\PY{o}{.}\PY{l+m+mi}{71}\PY{p}{,}\PY{l+m+mf}{0.1}\PY{p}{)}
             
             \PY{k}{if} \PY{n}{yr}\PY{o}{\PYZlt{}}\PY{l+m+mi}{6}\PY{p}{:}
                 \PY{n}{p1}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{]}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{n}{yr}\PY{o}{+}\PY{l+m+mi}{3}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{k}{else}\PY{p}{:}
                 \PY{n}{p1}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{]}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{n}{yr}\PY{o}{\PYZhy{}}\PY{l+m+mi}{6}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                 
             \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.7)}
             \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}kg/m3\PYZsq{})}
             \PY{c+c1}{\PYZsh{}plt.contour(yt\PYZus{}ocean[0:500],st\PYZus{}ocean,pert\PYZus{}ztemp\PYZhy{}cntrl\PYZus{}ztemp,levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=0.25)}
             \PY{c+c1}{\PYZsh{}plt.contour(yt\PYZus{}ocean[0:500],st\PYZus{}ocean,pert\PYZus{}ztemp\PYZhy{}cntrl\PYZus{}ztemp,levels=[0.0,],colors=\PYZsq{}k\PYZsq{},linewidths=0.5)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}plt.gca().yaxis.set\PYZus{}major\PYZus{}formatter(x\PYZus{}formatter)}
             \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1034))}
             \PY{c+c1}{\PYZsh{}plt.ylabel(\PYZsq{}Depth (m)\PYZsq{})}
             \PY{c+c1}{\PYZsh{}plt.xlabel(\PYZsq{}Latitude (\PYZdl{}\PYZca{}\PYZbs{}circ\PYZdl{}S)\PYZsq{})}
             \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{50}\PY{p}{]}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{n}{yr}\PY{p}{]}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}plt.title(\PYZsq{}40W to 15E Temp Anomaly 1976\PYZsq{})}
         
         \PY{n}{ax3} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{axes}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.99}\PY{p}{,}\PY{l+m+mf}{0.38}\PY{p}{,}\PY{l+m+mf}{0.015}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{]}\PY{p}{)}
         \PY{n}{cb} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{p1}\PY{p}{,}\PY{n}{cax}\PY{o}{=}\PY{n}{ax3}\PY{p}{,}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}plt.subplot(224)}
         \PY{c+c1}{\PYZsh{}plt.gca().patch.set\PYZus{}color(\PYZsq{}.25\PYZsq{})}
         \PY{c+c1}{\PYZsh{}clev = np.arange(\PYZhy{}.5,.51,0.1)}
         \PY{c+c1}{\PYZsh{}plt.contourf(yt\PYZus{}ocean[0:500],st\PYZus{}ocean,np.mean(pert\PYZus{}temp[9,:,:,:],axis=2)\PYZhy{}np.mean(cntrl\PYZus{}temp[:,:,:],axis=2),cmap=plt.cm.PiYG,levels=clev,extend=\PYZsq{}both\PYZsq{})}
         \PY{c+c1}{\PYZsh{}plt.title(\PYZsq{}180W to 180E Temp Anomaly 1982\PYZsq{})}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}zavTanom.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{zavgTanom.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_60_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}46}]:} \PY{c+c1}{\PYZsh{}store time\PYZhy{}series between 60\PYZhy{}65S and 40W\PYZhy{}15E for hovmoeller}
         \PY{n}{x1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{40}\PY{p}{)}
         \PY{n}{x2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{l+m+mi}{15}\PY{p}{)}
         \PY{n}{x1}\PY{o}{=}\PY{n}{x1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{x2}\PY{o}{=}\PY{n}{x2}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         
         \PY{n}{y1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{70}\PY{p}{)}
         \PY{n}{y2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{63}\PY{p}{)}
         \PY{n}{y1}\PY{o}{=}\PY{n}{y1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{y2}\PY{o}{=}\PY{n}{y2}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{k}{print} \PY{n}{x1}\PY{p}{,} \PY{n}{x2}
         \PY{k}{print} \PY{n}{y1}\PY{p}{,} \PY{n}{y2}
         
         \PY{c+c1}{\PYZsh{}this is inaccurate ... area weight for yt\PYZus{}ocean}
         \PY{n}{cTz}\PY{o}{=}\PY{n}{cntrl}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{n}{y1}\PY{p}{:}\PY{n}{y2}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
         \PY{n}{cTz2}\PY{o}{=}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{n}{y1}\PY{p}{:}\PY{n}{y2}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
         \PY{k}{print} \PY{n}{cTz}\PY{o}{.}\PY{n}{shape}
         \PY{k}{print} \PY{n}{cTz2}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{cTz}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{concatenate}\PY{p}{(}\PY{p}{(}\PY{n}{cTz}\PY{p}{,}\PY{n}{cTz2}\PY{p}{)}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{k}{print} \PY{n}{cTz}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{pTz}\PY{o}{=}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{n}{y1}\PY{p}{:}\PY{n}{y2}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
         \PY{k}{print} \PY{n}{pTz}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[959] [1179]
[104] [170]
(9, 50)
(40, 50)
(49, 50)
(40, 50)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}47}]:} \PY{c+c1}{\PYZsh{}plot temp hovmoeller of depth vs time}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{9.5}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         
         \PY{n}{time} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{k}{print} \PY{n}{time}
         \PY{k}{print} \PY{n}{time}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{yrs}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1972}\PY{p}{,}\PY{l+m+mi}{2016}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{k}{print} \PY{n}{cTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{shape}
         \PY{n}{var1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{expand\PYZus{}dims}\PY{p}{(}\PY{n}{cTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{k}{print} \PY{n}{var1}\PY{o}{.}\PY{n}{shape}
         \PY{n}{var2} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{concatenate}\PY{p}{(}\PY{p}{(}\PY{n}{var1}\PY{p}{,}\PY{n}{pTz}\PY{p}{)}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{k}{print} \PY{n}{var2}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{o}{.}\PY{l+m+mo}{05}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}print clev}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{211}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{41}\PY{p}{]}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{var2}\PY{o}{.}\PY{n}{T}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.contour(yu\PYZus{}ocean,potrho,np.mean(cntrl\PYZus{}gmoc[0:4,:,:],axis=0),levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=0.25)}
         \PY{c+c1}{\PYZsh{}plt.contour(yu\PYZus{}ocean,potrho,np.mean(cntrl\PYZus{}gmoc[0:4,:,:],axis=0),levels=[0.0,],colors=\PYZsq{}k\PYZsq{},linewidths=0.5)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1035))}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth (m}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Years}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.xlim([\PYZhy{}75,85])}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{70\PYZhy{}63S and 40W\PYZhy{}15E Temp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{o}{.}\PY{l+m+mi}{3}\PY{p}{,}\PY{o}{.}\PY{l+m+mi}{31}\PY{p}{,}\PY{o}{.}\PY{l+m+mo}{01}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}print clev}
         
         \PY{n}{time} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{k}{print} \PY{n}{time}
         \PY{k}{print} \PY{n}{time}\PY{o}{.}\PY{n}{shape}
         \PY{k}{print} \PY{n}{pTz}\PY{o}{.}\PY{n}{shape}
         \PY{n}{a}\PY{o}{=}\PY{n}{pTz}\PY{o}{\PYZhy{}}\PY{n}{cTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{pTz}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         \PY{k}{print} \PY{n}{a}\PY{o}{.}\PY{n}{shape}
         
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{212}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{40}\PY{p}{]}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{a}\PY{o}{.}\PY{n}{T}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.contour(yu\PYZus{}ocean,potrho,np.mean(cntrl\PYZus{}gmoc[0:4,:,:],axis=0),levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=0.25)}
         \PY{c+c1}{\PYZsh{}plt.contour(yu\PYZus{}ocean,potrho,np.mean(cntrl\PYZus{}gmoc[0:4,:,:],axis=0),levels=[0.0,],colors=\PYZsq{}k\PYZsq{},linewidths=0.5)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1035))}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth (m}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Years}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.xlim([\PYZhy{}75,85])}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{70\PYZhy{}63S and 40W\PYZhy{}15E Temp Anom}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Weddell\PYZus{}HovT.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[-1  0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19]
(21,)
(50,)
(1, 50)
(41, 50)
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19]
(20,)
(40, 50)
(40, 50)

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_62_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{c+c1}{\PYZsh{}redo Purkey et al., 2018 figs 2: Temp trend mC/yr from 1981\PYZhy{}2000 and 2000\PYZhy{}2016. Assume linear trend.}
        \PY{c+c1}{\PYZsh{}Southern Ocean and Global Ocean}
        
        \PY{c+c1}{\PYZsh{}years is 1980\PYZhy{}2020}
        \PY{c+c1}{\PYZsh{}print cTemp.shape}
        \PY{k}{print} \PY{n}{cntrl}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}
        \PY{k}{print} \PY{n}{cntrl2}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}
        \PY{c+c1}{\PYZsh{}print pert.temp.shape}
        
        \PY{c+c1}{\PYZsh{}area integrate over Southern Ocean and plot vertical profile of temp trend}
        \PY{n}{y1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{60}\PY{p}{)}
        \PY{n}{y2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{55}\PY{p}{)}
        \PY{n}{y1}\PY{o}{=}\PY{n}{y1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{y2}\PY{o}{=}\PY{n}{y2}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{k}{print} \PY{n}{yt\PYZus{}ocean}\PY{p}{[}\PY{n}{y1}\PY{p}{]}\PY{p}{,} \PY{n}{yt\PYZus{}ocean}\PY{p}{[}\PY{n}{y2}\PY{p}{]}
        
        \PY{c+c1}{\PYZsh{}mask area\PYZus{}t for land cells.}
        \PY{n}{msk}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{n}{kmt}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{kmt}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{)}
        \PY{k}{print} \PY{n}{msk}\PY{o}{.}\PY{n}{shape}
        \PY{n}{msk}\PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{n}{kmt}\PY{o}{\PYZgt{}}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}\PY{o}{=}\PY{l+m+mi}{1}
        \PY{n}{area\PYZus{}t\PYZus{}mask}\PY{o}{=}\PY{n}{area\PYZus{}t}\PY{o}{*}\PY{n}{msk}
        \PY{k}{print} \PY{n}{area\PYZus{}t\PYZus{}mask}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{500}\PY{p}{]}
        
        \PY{n}{cTz}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{n}{cntrl}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{cntrl}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{)}
        \PY{k}{print} \PY{n}{cTz}\PY{o}{.}\PY{n}{shape}
        
        \PY{k}{for} \PY{n}{t} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{cntrl}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{:}
            \PY{k}{print} \PY{n}{t}
            
            \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{cntrl}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                \PY{n}{cTz}\PY{p}{[}\PY{n}{t}\PY{p}{,}\PY{n}{k}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{ma}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{cntrl}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{n}{t}\PY{p}{,}\PY{n}{k}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{y1}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{*}\PY{n}{area\PYZus{}t\PYZus{}mask}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{y1}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)}
                \PY{n}{cTz}\PY{p}{[}\PY{n}{t}\PY{p}{,}\PY{n}{k}\PY{p}{]}\PY{o}{=}\PY{n}{cTz}\PY{p}{[}\PY{n}{t}\PY{p}{,}\PY{n}{k}\PY{p}{]}\PY{o}{/}\PY{n}{np}\PY{o}{.}\PY{n}{ma}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{area\PYZus{}t\PYZus{}mask}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{y1}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)}
            
        \PY{k}{print} \PY{n}{cTz}\PY{o}{.}\PY{n}{shape}
        \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cTz\PYZus{}Sof60S\PYZus{}1971\PYZhy{}1979.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{a}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{cTz}\PY{p}{)}
        
        \PY{n}{cTz}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{)}
        \PY{k}{print} \PY{n}{cTz}\PY{o}{.}\PY{n}{shape}
        
        \PY{k}{for} \PY{n}{t} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{:}
            \PY{k}{print} \PY{n}{t}
            
            \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                \PY{n}{cTz}\PY{p}{[}\PY{n}{t}\PY{p}{,}\PY{n}{k}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{ma}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{n}{t}\PY{p}{,}\PY{n}{k}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{y1}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{*}\PY{n}{area\PYZus{}t\PYZus{}mask}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{y1}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)}
                \PY{n}{cTz}\PY{p}{[}\PY{n}{t}\PY{p}{,}\PY{n}{k}\PY{p}{]}\PY{o}{=}\PY{n}{cTz}\PY{p}{[}\PY{n}{t}\PY{p}{,}\PY{n}{k}\PY{p}{]}\PY{o}{/}\PY{n}{np}\PY{o}{.}\PY{n}{ma}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{area\PYZus{}t\PYZus{}mask}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{y1}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)}
            
        \PY{k}{print} \PY{n}{cTz}\PY{o}{.}\PY{n}{shape}
        \PY{k}{print} \PY{n}{cTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}
        \PY{k}{print} \PY{n}{cTz}\PY{p}{[}\PY{l+m+mi}{19}\PY{p}{,}\PY{p}{:}\PY{p}{]}
        \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cTz\PYZus{}Sof60S\PYZus{}1980\PYZhy{}2020.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{a}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{cTz}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(9, 50, 1080, 1440)
(40, 50, 1080, 1440)
[-60.08436456] [-55.13874852]
(1080, 1440)
[        0.         0.         0. {\ldots},  71020792.  71017104.  70960376.]
(9, 50)
0

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/ipykernel/\_\_main\_\_.py:31: VisibleDeprecationWarning: converting an array with ndim > 0 to an index will result in an error in the future
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/ipykernel/\_\_main\_\_.py:32: VisibleDeprecationWarning: converting an array with ndim > 0 to an index will result in an error in the future

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
1
2
3
4
5
6
7
8
(9, 50)
(40, 50)
0

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/ipykernel/\_\_main\_\_.py:45: VisibleDeprecationWarning: converting an array with ndim > 0 to an index will result in an error in the future
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/ipykernel/\_\_main\_\_.py:46: VisibleDeprecationWarning: converting an array with ndim > 0 to an index will result in an error in the future

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
(40, 50)
[ -4.65850670e-01  -5.18511907e-01  -6.20715935e-01  -7.99364250e-01
  -8.92118094e-01  -8.80835039e-01  -7.81251445e-01  -6.38855024e-01
  -4.90281408e-01  -3.61878553e-01  -2.63730984e-01  -1.86245122e-01
  -1.26805208e-01  -8.21045187e-02  -4.33354598e-02  -7.12498370e-03
   3.09422910e-02   7.24965331e-02   1.10339306e-01   1.46836878e-01
   1.79334949e-01   2.09880654e-01   2.40409458e-01   2.63946732e-01
   2.82768437e-01   2.90010438e-01   2.78065443e-01   2.55026441e-01
   2.25802361e-01   1.94742894e-01   1.63801991e-01   1.33977755e-01
   1.06175706e-01   8.15292651e-02   6.14565484e-02   4.55493705e-02
   3.04038308e-02   1.43479642e-02  -1.59927972e-04  -1.29838719e-02
  -2.34777723e-02  -3.39942513e-02  -4.57785243e-02  -5.66060512e-02
  -6.23641110e-02  -6.05268057e-02  -5.32254343e-02  -4.39307459e-02
  -2.66911616e-02  -4.62475238e-03]
[-0.45961318 -0.51251448 -0.61526066 -0.79564666 -0.88993444 -0.88077125
 -0.78311433 -0.64116645 -0.49123048 -0.36512413 -0.27068531 -0.19689984
 -0.13920773 -0.09476019 -0.05538405 -0.01753499  0.02218588  0.06125735
  0.09707103  0.13152756  0.16151629  0.18856518  0.21642969  0.24005023
  0.25874352  0.26586809  0.2543295   0.23141154  0.20164042  0.16964685
  0.13813209  0.10796232  0.07954245  0.05475879  0.03488715  0.01950253
  0.00452742 -0.01130734 -0.02513721 -0.03701789 -0.04644962 -0.05570866
 -0.06586013 -0.07452496 -0.07735075 -0.07237356 -0.06259741 -0.05042125
 -0.02972222 -0.00495286]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}33}]:} \PY{c+c1}{\PYZsh{}redo Purkey et al., 2018 figs 2: Temp trend mC/yr from 1981\PYZhy{}2000 and 2000\PYZhy{}2016. Assume linear trend.}
         \PY{c+c1}{\PYZsh{}Southern Ocean and Global Ocean}
         
         \PY{c+c1}{\PYZsh{}20 years is 1973\PYZhy{}1993}
         \PY{c+c1}{\PYZsh{}print cntrl.temp.shape}
         \PY{k}{print} \PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}
         
         \PY{c+c1}{\PYZsh{}area integrate over Southern Ocean and plot vertical profile of temp trend}
         \PY{n}{y1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{60}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}y1=np.argwhere(yt\PYZus{}ocean\PYZlt{}\PYZhy{}55)}
         \PY{n}{y1}\PY{o}{=}\PY{n}{y1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         
         \PY{c+c1}{\PYZsh{}mask area\PYZus{}t for land cells.}
         \PY{n}{msk}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{n}{kmt}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{kmt}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         \PY{k}{print} \PY{n}{msk}\PY{o}{.}\PY{n}{shape}
         \PY{n}{msk}\PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{n}{kmt}\PY{o}{\PYZgt{}}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}\PY{o}{=}\PY{l+m+mi}{1}
         \PY{n}{area\PYZus{}t\PYZus{}mask}\PY{o}{=}\PY{n}{area\PYZus{}t}\PY{o}{*}\PY{n}{msk}
         \PY{k}{print} \PY{n}{area\PYZus{}t\PYZus{}mask}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{500}\PY{p}{]}
         
         \PY{n}{pTz}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         \PY{k}{print} \PY{n}{pTz}\PY{o}{.}\PY{n}{shape}
         
         \PY{k}{for} \PY{n}{t} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{:}
             \PY{k}{print} \PY{n}{t}
             
             \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                 \PY{n}{pTz}\PY{p}{[}\PY{n}{t}\PY{p}{,}\PY{n}{k}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{ma}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{n}{t}\PY{p}{,}\PY{n}{k}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{y1}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{*}\PY{n}{area\PYZus{}t\PYZus{}mask}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{y1}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)}
                 \PY{n}{pTz}\PY{p}{[}\PY{n}{t}\PY{p}{,}\PY{n}{k}\PY{p}{]}\PY{o}{=}\PY{n}{pTz}\PY{p}{[}\PY{n}{t}\PY{p}{,}\PY{n}{k}\PY{p}{]}\PY{o}{/}\PY{n}{np}\PY{o}{.}\PY{n}{ma}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{area\PYZus{}t\PYZus{}mask}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{y1}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)}
             
         \PY{k}{print} \PY{n}{pTz}\PY{o}{.}\PY{n}{shape}
         \PY{k}{print} \PY{n}{pTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         \PY{k}{print} \PY{n}{pTz}\PY{p}{[}\PY{l+m+mi}{19}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pTz\PYZus{}Sof60S.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{a}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{pTz}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(38, 50, 1080, 1440)
[-60.08436456] [-55.13874852]
(1080, 1440)
[        0.         0.         0. {\ldots},  71020792.  71017104.  70960376.]
(38, 50)
0

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/ipykernel/\_\_main\_\_.py:29: VisibleDeprecationWarning: converting an array with ndim > 0 to an index will result in an error in the future
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/ipykernel/\_\_main\_\_.py:30: VisibleDeprecationWarning: converting an array with ndim > 0 to an index will result in an error in the future

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
(38, 50)
[-0.45381286 -0.50739125 -0.61069858 -0.78196391 -0.86982438 -0.86103947
 -0.7709659  -0.63681982 -0.49093034 -0.36687749 -0.2696115  -0.19077377
 -0.13057492 -0.08572909 -0.04508068 -0.00669556  0.03094989  0.0702683
  0.10878603  0.14647924  0.17970085  0.21021441  0.24178622  0.26502388
  0.28471484  0.29355963  0.28331563  0.26155715  0.23284733  0.20229659
  0.17172498  0.14235528  0.11530772  0.091074    0.07119279  0.05541337
  0.04028598  0.02427938  0.00951981 -0.00344237 -0.01426009 -0.02544841
 -0.03810091 -0.0497329  -0.05647691 -0.05575028 -0.04958037 -0.04147296
 -0.02553707 -0.00450641]
[-0.48745254 -0.53914431 -0.63849561 -0.81219452 -0.90583091 -0.90020423
 -0.80850955 -0.67065432 -0.51804031 -0.38250831 -0.28035722 -0.20147536
 -0.14147508 -0.09546339 -0.0534612  -0.0153709   0.02257856  0.06200026
  0.09969343  0.13579041  0.16619848  0.19240029  0.2206184   0.24308679
  0.26182469  0.26829423  0.25488564  0.22858727  0.19721912  0.1653644
  0.13470393  0.10535521  0.07718234  0.05130621  0.0308971   0.01707231
  0.00424075 -0.01092303 -0.02586331 -0.03894492 -0.04912585 -0.05860509
 -0.06974321 -0.08071107 -0.08533032 -0.08103458 -0.07064779 -0.05692606
 -0.03370775 -0.00584356]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}49}]:} \PY{c+c1}{\PYZsh{}just do Atlantic Sector}
         \PY{c+c1}{\PYZsh{}mask area\PYZus{}t for land cells.}
         \PY{n}{x1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{40}\PY{p}{)}
         \PY{n}{x2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{l+m+mi}{30}\PY{p}{)}
         \PY{n}{x1}\PY{o}{=}\PY{n}{x1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{x2}\PY{o}{=}\PY{n}{x2}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         
         \PY{n}{y1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{60}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}y1=np.argwhere(yt\PYZus{}ocean\PYZlt{}\PYZhy{}55)}
         \PY{n}{y1}\PY{o}{=}\PY{n}{y1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         
         
         \PY{n}{msk}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{n}{kmt}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{kmt}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         \PY{k}{print} \PY{n}{msk}\PY{o}{.}\PY{n}{shape}
         \PY{n}{msk}\PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{n}{kmt}\PY{o}{\PYZgt{}}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}\PY{o}{=}\PY{l+m+mi}{1}
         \PY{n}{area\PYZus{}t\PYZus{}mask}\PY{o}{=}\PY{n}{area\PYZus{}t}\PY{o}{*}\PY{n}{msk}
         \PY{k}{print} \PY{n}{area\PYZus{}t\PYZus{}mask}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{500}\PY{p}{]}
         
         \PY{n}{cAtlTz}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{n}{cntrl}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{cntrl}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         \PY{k}{print} \PY{n}{cAtlTz}\PY{o}{.}\PY{n}{shape}
         
         \PY{k}{for} \PY{n}{t} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{cntrl}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{:}
             \PY{k}{print} \PY{n}{t}
             
             \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{cntrl}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                 \PY{n}{cAtlTz}\PY{p}{[}\PY{n}{t}\PY{p}{,}\PY{n}{k}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{ma}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{cntrl}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{n}{t}\PY{p}{,}\PY{n}{k}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{y1}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{*}\PY{n}{area\PYZus{}t\PYZus{}mask}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{y1}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{p}{)}
                 \PY{n}{cAtlTz}\PY{p}{[}\PY{n}{t}\PY{p}{,}\PY{n}{k}\PY{p}{]}\PY{o}{=}\PY{n}{cAtlTz}\PY{p}{[}\PY{n}{t}\PY{p}{,}\PY{n}{k}\PY{p}{]}\PY{o}{/}\PY{n}{np}\PY{o}{.}\PY{n}{ma}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{area\PYZus{}t\PYZus{}mask}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{y1}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{p}{)}
             
         \PY{k}{print} \PY{n}{cAtlTz}\PY{o}{.}\PY{n}{shape}
         \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cAtlTz\PYZus{}Sof60S\PYZus{}1971\PYZhy{}1979.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{a}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{cAtlTz}\PY{p}{)}
         
         \PY{n}{cAtlTz}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         \PY{k}{print} \PY{n}{cAtlTz}\PY{o}{.}\PY{n}{shape}
         
         \PY{k}{for} \PY{n}{t} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{:}
             \PY{k}{print} \PY{n}{t}
             
             \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                 \PY{n}{cAtlTz}\PY{p}{[}\PY{n}{t}\PY{p}{,}\PY{n}{k}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{ma}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{n}{t}\PY{p}{,}\PY{n}{k}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{y1}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{*}\PY{n}{area\PYZus{}t\PYZus{}mask}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{y1}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{p}{)}
                 \PY{n}{cAtlTz}\PY{p}{[}\PY{n}{t}\PY{p}{,}\PY{n}{k}\PY{p}{]}\PY{o}{=}\PY{n}{cAtlTz}\PY{p}{[}\PY{n}{t}\PY{p}{,}\PY{n}{k}\PY{p}{]}\PY{o}{/}\PY{n}{np}\PY{o}{.}\PY{n}{ma}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{area\PYZus{}t\PYZus{}mask}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{y1}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{p}{)}
             
         \PY{k}{print} \PY{n}{cAtlTz}\PY{o}{.}\PY{n}{shape}
         \PY{k}{print} \PY{n}{cAtlTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         \PY{k}{print} \PY{n}{cAtlTz}\PY{p}{[}\PY{l+m+mi}{19}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cAtlTz\PYZus{}Sof60S\PYZus{}1980\PYZhy{}2020.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{a}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{cAtlTz}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(1080, 1440)
[        0.         0.         0. {\ldots},  71020792.  71017104.  70960376.]
(9, 50)
0

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/ipykernel/\_\_main\_\_.py:26: VisibleDeprecationWarning: converting an array with ndim > 0 to an index will result in an error in the future
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/ipykernel/\_\_main\_\_.py:27: VisibleDeprecationWarning: converting an array with ndim > 0 to an index will result in an error in the future

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
1
2
3
4
5
6
7
8
(9, 50)
(40, 50)
0

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/ipykernel/\_\_main\_\_.py:40: VisibleDeprecationWarning: converting an array with ndim > 0 to an index will result in an error in the future
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/ipykernel/\_\_main\_\_.py:41: VisibleDeprecationWarning: converting an array with ndim > 0 to an index will result in an error in the future

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
(40, 50)
[-1.13919084 -1.1863821  -1.28274358 -1.45647989 -1.51711558 -1.46861621
 -1.33028492 -1.16282655 -1.00319113 -0.86462982 -0.75203373 -0.66464728
 -0.60370047 -0.56223146 -0.52724079 -0.49282566 -0.45878441 -0.42353976
 -0.39029494 -0.35753762 -0.32514288 -0.29417134 -0.26011231 -0.23755231
 -0.21700157 -0.19841456 -0.1886158  -0.18283283 -0.17984085 -0.18478202
 -0.19642659 -0.2156787  -0.24401705 -0.27373613 -0.29508177 -0.31318833
 -0.33015879 -0.34582656 -0.35989132 -0.3695898  -0.37565162 -0.37604327
 -0.37364106 -0.36882813 -0.35550389 -0.33102104 -0.28285086 -0.21067763
 -0.10800058 -0.02178822]
[-1.12314852 -1.17013575 -1.26824885 -1.44732983 -1.51086526 -1.46435278
 -1.3277507  -1.16450257 -1.01263886 -0.87949588 -0.77110277 -0.68685714
 -0.62500777 -0.58172813 -0.54663649 -0.51591124 -0.48579297 -0.45370404
 -0.42150644 -0.39055248 -0.36011668 -0.32993336 -0.29606339 -0.27359739
 -0.25278944 -0.23397386 -0.22376696 -0.21773016 -0.21465592 -0.22000179
 -0.23218649 -0.25230679 -0.28256563 -0.31222668 -0.33323883 -0.35138697
 -0.36958423 -0.38628379 -0.4002168  -0.40912689 -0.41374509 -0.4125043
 -0.40798359 -0.40068731 -0.38442371 -0.35663498 -0.30427219 -0.22639246
 -0.11602657 -0.02331269]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}47}]:} \PY{c+c1}{\PYZsh{}just do Atlantic Sector}
         \PY{c+c1}{\PYZsh{}mask area\PYZus{}t for land cells.}
         \PY{n}{x1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{40}\PY{p}{)}
         \PY{n}{x2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{l+m+mi}{30}\PY{p}{)}
         \PY{n}{x1}\PY{o}{=}\PY{n}{x1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{x2}\PY{o}{=}\PY{n}{x2}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         
         \PY{n}{y1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{60}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}y1=np.argwhere(yt\PYZus{}ocean\PYZlt{}\PYZhy{}55)}
         \PY{n}{y1}\PY{o}{=}\PY{n}{y1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         
         
         \PY{n}{msk}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{n}{kmt}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{kmt}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         \PY{k}{print} \PY{n}{msk}\PY{o}{.}\PY{n}{shape}
         \PY{n}{msk}\PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{n}{kmt}\PY{o}{\PYZgt{}}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}\PY{o}{=}\PY{l+m+mi}{1}
         \PY{n}{area\PYZus{}t\PYZus{}mask}\PY{o}{=}\PY{n}{area\PYZus{}t}\PY{o}{*}\PY{n}{msk}
         \PY{k}{print} \PY{n}{area\PYZus{}t\PYZus{}mask}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{500}\PY{p}{]}
         
         \PY{n}{pAtlTz}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         \PY{k}{print} \PY{n}{pAtlTz}\PY{o}{.}\PY{n}{shape}
         
         \PY{k}{for} \PY{n}{t} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{:}
             \PY{k}{print} \PY{n}{t}
             
             \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{:}
                 \PY{n}{pAtlTz}\PY{p}{[}\PY{n}{t}\PY{p}{,}\PY{n}{k}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{ma}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{n}{t}\PY{p}{,}\PY{n}{k}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{y1}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{*}\PY{n}{area\PYZus{}t\PYZus{}mask}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{y1}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{p}{)}
                 \PY{n}{pAtlTz}\PY{p}{[}\PY{n}{t}\PY{p}{,}\PY{n}{k}\PY{p}{]}\PY{o}{=}\PY{n}{pAtlTz}\PY{p}{[}\PY{n}{t}\PY{p}{,}\PY{n}{k}\PY{p}{]}\PY{o}{/}\PY{n}{np}\PY{o}{.}\PY{n}{ma}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{area\PYZus{}t\PYZus{}mask}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{y1}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{p}{)}
             
         \PY{k}{print} \PY{n}{pAtlTz}\PY{o}{.}\PY{n}{shape}
         \PY{k}{print} \PY{n}{pAtlTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         \PY{k}{print} \PY{n}{pAtlTz}\PY{p}{[}\PY{l+m+mi}{19}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pAtlTz\PYZus{}Sof60S.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{a}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{pAtlTz}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(1080, 1440)
[        0.         0.         0. {\ldots},  71020792.  71017104.  70960376.]
(38, 50)
0

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/ipykernel/\_\_main\_\_.py:26: VisibleDeprecationWarning: converting an array with ndim > 0 to an index will result in an error in the future
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/ipykernel/\_\_main\_\_.py:27: VisibleDeprecationWarning: converting an array with ndim > 0 to an index will result in an error in the future

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
(38, 50)
[-1.08961943 -1.14088967 -1.2432818  -1.38440591 -1.4232658  -1.38818482
 -1.28874518 -1.16149673 -1.03124326 -0.90901174 -0.79349137 -0.69230447
 -0.62313663 -0.57708636 -0.5363805  -0.49737777 -0.46183838 -0.42823142
 -0.3931108  -0.35743482 -0.32448831 -0.29328377 -0.25978347 -0.23806834
 -0.21802473 -0.19963124 -0.18955129 -0.18331016 -0.17990537 -0.18405288
 -0.19418062 -0.21100742 -0.23582131 -0.26351879 -0.28317971 -0.29980754
 -0.31603362 -0.33113936 -0.34491925 -0.35448048 -0.36085334 -0.36208672
 -0.36078245 -0.3567724  -0.34399698 -0.32027285 -0.27450173 -0.20483413
 -0.10503218 -0.0212406 ]
[-1.23780498 -1.28506519 -1.36907724 -1.51736396 -1.57895853 -1.55071484
 -1.45035713 -1.30115754 -1.12321553 -0.95206631 -0.81767019 -0.72166599
 -0.66053528 -0.61361002 -0.57168796 -0.53549988 -0.50452796 -0.47366023
 -0.44109943 -0.40828829 -0.37468844 -0.34104961 -0.30601573 -0.28263547
 -0.26030429 -0.24110285 -0.23116492 -0.22540731 -0.22160347 -0.22499862
 -0.23647275 -0.25724078 -0.2901302  -0.32694683 -0.35071249 -0.36439363
 -0.37766934 -0.39240392 -0.40865396 -0.42215646 -0.4304234  -0.43237363
 -0.43515386 -0.43906562 -0.43016354 -0.40379546 -0.34694589 -0.25920088
 -0.13406649 -0.02755055]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}30}]:} \PY{c+c1}{\PYZsh{}Do southern ocean trend plot}
         \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cTz\PYZus{}Sof60S\PYZus{}1971\PYZhy{}1979.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cTz}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n}{of}\PY{p}{)}
         \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cTz\PYZus{}Sof60S\PYZus{}1980\PYZhy{}2020.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cTz2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n}{of}\PY{p}{)}
         \PY{n}{cTz}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{concatenate}\PY{p}{(}\PY{p}{(}\PY{n}{cTz}\PY{p}{,}\PY{n}{cTz2}\PY{p}{)}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{k}{print} \PY{n}{cTz}\PY{o}{.}\PY{n}{shape}
         
         
         \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pTz\PYZus{}Sof60S.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{pTz}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n}{of}\PY{p}{)}
         \PY{k}{print} \PY{n}{pTz}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{cyrs}\PY{o}{=}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1971}\PY{p}{,}\PY{l+m+mi}{2020}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{pyrs}\PY{o}{=}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1973}\PY{p}{,}\PY{l+m+mi}{2011}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{k}{print} \PY{n}{cyrs}\PY{o}{.}\PY{n}{shape}
         \PY{k}{print} \PY{n}{cyrs}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{:}\PY{l+m+mi}{10}\PY{p}{]}
         \PY{k}{print} \PY{n}{pyrs}\PY{o}{.}\PY{n}{shape}
         \PY{k}{print} \PY{n}{pyrs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{8}\PY{p}{]}
         
         \PY{c+c1}{\PYZsh{}calc linear trend in mC/yr over whole period}
         \PY{k}{print} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{8}\PY{p}{)}
         \PY{n}{tr\PYZus{}pTz}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{polyfit}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{,} \PY{n}{pTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{8}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{k}{print} \PY{n}{tr\PYZus{}pTz}\PY{o}{.}\PY{n}{shape}
         \PY{k}{print} \PY{n}{tr\PYZus{}pTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         
         \PY{n}{tr\PYZus{}cTz}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{polyfit}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{,} \PY{n}{cTz}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{:}\PY{l+m+mi}{10}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{k}{print} \PY{n}{tr\PYZus{}cTz}\PY{o}{.}\PY{n}{shape}
         \PY{k}{print} \PY{n}{tr\PYZus{}cTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{12.5}\PY{p}{,}\PY{l+m+mf}{9.5}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{411}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{tr\PYZus{}cTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{1000}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Control}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{tr\PYZus{}pTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{1000}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Perturbation}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{tr\PYZus{}pTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{1000}\PY{o}{\PYZhy{}}\PY{n}{tr\PYZus{}cTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{1000}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Perturbation\PYZhy{}Control}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{1000}\PY{p}{,}\PY{l+m+mi}{5500}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mC/yr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth (m)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{tit}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1973\PYZhy{}1980 Linear Temp Trend South of 60\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}S}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{tit}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}calc linear trend in mC/yr since 1981\PYZhy{}2000 (8 years from 1973) }
         \PY{k}{print} \PY{n}{cyrs}\PY{p}{[}\PY{l+m+mi}{10}\PY{p}{:}\PY{l+m+mi}{30}\PY{p}{]}
         \PY{k}{print} \PY{n}{pyrs}\PY{o}{.}\PY{n}{shape}
         \PY{k}{print} \PY{n}{pyrs}\PY{p}{[}\PY{l+m+mi}{8}\PY{p}{:}\PY{l+m+mi}{28}\PY{p}{]}
         
         \PY{k}{print} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{)}
         \PY{n}{tr\PYZus{}pTz}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{polyfit}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{)}\PY{p}{,} \PY{n}{pTz}\PY{p}{[}\PY{l+m+mi}{8}\PY{p}{:}\PY{l+m+mi}{28}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{k}{print} \PY{n}{tr\PYZus{}pTz}\PY{o}{.}\PY{n}{shape}
         \PY{k}{print} \PY{n}{tr\PYZus{}pTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         
         \PY{n}{tr\PYZus{}cTz}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{polyfit}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{)}\PY{p}{,} \PY{n}{cTz}\PY{p}{[}\PY{l+m+mi}{10}\PY{p}{:}\PY{l+m+mi}{30}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{k}{print} \PY{n}{tr\PYZus{}cTz}\PY{o}{.}\PY{n}{shape}
         \PY{k}{print} \PY{n}{tr\PYZus{}cTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{412}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{tr\PYZus{}cTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{1000}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Control}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{tr\PYZus{}pTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{1000}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Perturbation}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{tr\PYZus{}pTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{1000}\PY{o}{\PYZhy{}}\PY{n}{tr\PYZus{}cTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{1000}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Perturbation\PYZhy{}Control}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{1000}\PY{p}{,}\PY{l+m+mi}{5500}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mC/yr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth (m)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{tit}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1981\PYZhy{}2000 Linear Temp Trend South of 60\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}S}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{tit}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}calc linear trend in mC/yr since 2001\PYZhy{}2011 (8 years from 1973) }
         \PY{k}{print} \PY{n}{cyrs}\PY{p}{[}\PY{l+m+mi}{30}\PY{p}{:}\PY{l+m+mi}{41}\PY{p}{]}
         \PY{k}{print} \PY{n}{pyrs}\PY{p}{[}\PY{l+m+mi}{28}\PY{p}{:}\PY{l+m+mi}{38}\PY{p}{]}
         
         \PY{k}{print} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
         \PY{n}{tr\PYZus{}pTz}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{polyfit}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,} \PY{n}{pTz}\PY{p}{[}\PY{l+m+mi}{28}\PY{p}{:}\PY{l+m+mi}{38}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{k}{print} \PY{n}{tr\PYZus{}pTz}\PY{o}{.}\PY{n}{shape}
         \PY{k}{print} \PY{n}{tr\PYZus{}pTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         
         \PY{n}{tr\PYZus{}cTz}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{polyfit}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,} \PY{n}{cTz}\PY{p}{[}\PY{l+m+mi}{30}\PY{p}{:}\PY{l+m+mi}{40}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{k}{print} \PY{n}{tr\PYZus{}cTz}\PY{o}{.}\PY{n}{shape}
         \PY{k}{print} \PY{n}{tr\PYZus{}cTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{413}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{tr\PYZus{}cTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{1000}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Control}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{tr\PYZus{}pTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{1000}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Perturbation}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{tr\PYZus{}pTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{1000}\PY{o}{\PYZhy{}}\PY{n}{tr\PYZus{}cTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{1000}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Perturbation\PYZhy{}Control}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{1000}\PY{p}{,}\PY{l+m+mi}{5500}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mC/yr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth (m)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{tit}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2001\PYZhy{}2017 Linear Temp Trend South of 60\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}S}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{tit}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}calc linear trend in mC/yr since 1981\PYZhy{}2017 }
         \PY{k}{print} \PY{n}{cyrs}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{:}\PY{l+m+mi}{41}\PY{p}{]}
         \PY{k}{print} \PY{n}{pyrs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{38}\PY{p}{]}
         
         \PY{n}{tr\PYZus{}pTz}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{polyfit}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{38}\PY{p}{)}\PY{p}{,} \PY{n}{pTz}\PY{p}{[}\PY{l+m+mi}{8}\PY{p}{:}\PY{l+m+mi}{38}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{k}{print} \PY{n}{tr\PYZus{}pTz}\PY{o}{.}\PY{n}{shape}
         \PY{k}{print} \PY{n}{tr\PYZus{}pTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         
         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}check this ... fix dates}
         \PY{n}{tr\PYZus{}cTz}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{polyfit}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{38}\PY{p}{)}\PY{p}{,} \PY{n}{cTz}\PY{p}{[}\PY{l+m+mi}{8}\PY{o}{+}\PY{l+m+mi}{33}\PY{p}{:}\PY{l+m+mi}{38}\PY{o}{+}\PY{l+m+mi}{3}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{k}{print} \PY{n}{tr\PYZus{}cTz}\PY{o}{.}\PY{n}{shape}
         \PY{k}{print} \PY{n}{tr\PYZus{}cTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{414}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{tr\PYZus{}cTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{1000}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Control}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{tr\PYZus{}pTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{1000}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Perturbation}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{tr\PYZus{}pTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{1000}\PY{o}{\PYZhy{}}\PY{n}{tr\PYZus{}cTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{1000}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Perturbation\PYZhy{}Control}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{1000}\PY{p}{,}\PY{l+m+mi}{5500}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mC/yr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth (m)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{tit}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1981\PYZhy{}2017 Linear Temp Trend South of 60\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}S}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{tit}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}gmoc\PYZus{}ts.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tr\PYZus{}Tz.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(49, 50)
(38, 50)
(49,)
[1973 1974 1975 1976 1977 1978 1979 1980]
(38,)
[1973 1974 1975 1976 1977 1978 1979 1980]
[0, 1, 2, 3, 4, 5, 6, 7]
(2, 50)
[-0.01002554 -0.00969005 -0.00886528 -0.00937839 -0.01076901 -0.01184222
 -0.0115548  -0.01020373 -0.00880248 -0.0072882  -0.0064858  -0.00626266
 -0.00617018 -0.00600566 -0.00619441 -0.00641417 -0.00625455 -0.00605134
 -0.00622032 -0.00647712 -0.00669777 -0.00654523 -0.00645026 -0.00648208
 -0.00694922 -0.00723295 -0.00757426 -0.00778609 -0.00777551 -0.00767496
 -0.00752982 -0.00741465 -0.00728992 -0.00707085 -0.00684633 -0.00656984
 -0.00636381 -0.00619251 -0.00594456 -0.00571815 -0.00540139 -0.00503733
 -0.00468241 -0.00433604 -0.00390118 -0.00338551 -0.0027119  -0.0017667
 -0.00072839 -0.00015601]
(2, 50)
[  2.74947680e-05   2.32953275e-06  -2.29792662e-05  -8.32074908e-05
  -1.41639748e-04  -2.35140975e-04  -1.10674412e-04  -2.37100528e-04
  -7.63513716e-04  -8.13543480e-04  -6.70602300e-04  -6.65953047e-04
  -6.55394096e-04  -5.77769822e-04  -6.10356531e-04  -7.63191690e-04
  -7.09095028e-04  -3.32630874e-04  -2.67487796e-04  -4.35055993e-04
  -6.84043965e-04  -8.14657072e-04  -7.31166040e-04  -6.01770069e-04
  -7.75153745e-04  -9.50689878e-04  -1.15496535e-03  -1.29699573e-03
  -1.38278708e-03  -1.46801016e-03  -1.51104752e-03  -1.54650523e-03
  -1.60922934e-03  -1.62779137e-03  -1.62052878e-03  -1.61194444e-03
  -1.58679723e-03  -1.57041852e-03  -1.51373201e-03  -1.48330650e-03
  -1.42831659e-03  -1.31821004e-03  -1.17937392e-03  -1.05248197e-03
  -9.10924941e-04  -7.51095475e-04  -5.76864329e-04  -3.88221112e-04
  -1.81354435e-04  -1.85293553e-05]
[1981 1982 1983 1984 1985 1986 1987 1988 1989 1990 1991 1992 1993 1994 1995
 1996 1997 1998 1999 2000]
(38,)
[1981 1982 1983 1984 1985 1986 1987 1988 1989 1990 1991 1992 1993 1994 1995
 1996 1997 1998 1999 2000]
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
(2, 50)
[  8.60292646e-04   8.01133405e-04   6.77418978e-04   3.92100190e-04
   3.24252741e-04   5.98359033e-04   9.08329008e-04   1.16409582e-03
   1.65767218e-03   2.01283852e-03   1.99284872e-03   1.86207713e-03
   1.72851669e-03   1.66862023e-03   1.63428658e-03   1.55771563e-03
   1.50151968e-03   1.51262185e-03   1.58622861e-03   1.64596998e-03
   1.61913097e-03   1.42106836e-03   1.26609131e-03   1.18383906e-03
   1.01744045e-03   9.86675837e-04   9.93567943e-04   1.00904088e-03
   9.77722754e-04   9.06761661e-04   7.75721942e-04   6.66606088e-04
   5.59723705e-04   3.57842425e-04   1.16930817e-04  -4.60518466e-05
  -1.18484147e-04  -1.22409005e-04  -1.19201227e-04  -1.87248308e-04
  -2.99945383e-04  -3.86503977e-04  -4.23606186e-04  -4.43639407e-04
  -4.14014726e-04  -3.17651457e-04  -2.86957002e-04  -2.75299342e-04
  -2.05676881e-04  -1.23348691e-05]
(2, 50)
[  2.29102529e-04   2.16294107e-04   1.89222181e-04   8.68468430e-05
  -2.38548264e-05  -1.22686397e-04  -2.04008168e-04  -2.35145093e-04
  -2.80138963e-04  -4.06642519e-04  -5.36259945e-04  -6.94984533e-04
  -7.69668824e-04  -7.62569979e-04  -7.39774099e-04  -6.54537410e-04
  -5.45430667e-04  -5.86503305e-04  -7.10850714e-04  -8.99773352e-04
  -1.15429745e-03  -1.29517577e-03  -1.33501556e-03  -1.31486138e-03
  -1.38537036e-03  -1.38790468e-03  -1.33678573e-03  -1.30180856e-03
  -1.29072238e-03  -1.32017092e-03  -1.34586976e-03  -1.36374570e-03
  -1.39802985e-03  -1.40259167e-03  -1.39244802e-03  -1.36590144e-03
  -1.35900220e-03  -1.34356705e-03  -1.30497380e-03  -1.25280390e-03
  -1.19904961e-03  -1.13241469e-03  -1.04850108e-03  -9.35001421e-04
  -7.80004181e-04  -6.15610239e-04  -4.87062484e-04  -3.37731410e-04
  -1.58488843e-04  -1.73312457e-05]
[2001 2002 2003 2004 2005 2006 2007 2008 2009 2010 2011]
[2001 2002 2003 2004 2005 2006 2007 2008 2009 2010]
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
(2, 50)
[  6.05436880e-04   5.69973646e-04   5.42305004e-04   4.77838758e-04
   6.29877394e-04   9.23161805e-04   1.09801755e-03   1.09659834e-03
   9.27514590e-04   4.88378684e-04   3.62283023e-04   2.15441224e-04
   1.72620699e-04   2.66416112e-04   4.42292696e-04   6.83837619e-04
   6.05984494e-04   6.65906854e-05  -8.50344132e-04  -1.51888955e-03
  -1.59591854e-03  -1.24796883e-03  -1.05232743e-03  -1.17127843e-03
  -1.00807823e-03  -9.10901870e-04  -5.93581519e-04  -5.85090355e-04
  -6.20178679e-04  -7.41127455e-04  -8.08511685e-04  -8.59055107e-04
  -7.80336746e-04  -6.51843530e-04  -5.63858471e-04  -4.96346916e-04
  -4.75614743e-04  -6.13758259e-04  -7.34109977e-04  -7.90726604e-04
  -7.90359484e-04  -8.24258247e-04  -8.15161376e-04  -6.59961368e-04
  -4.13525341e-04  -2.00508147e-04  -7.73275721e-05  -5.63015821e-06
   3.24335211e-05   2.59979876e-05]
(2, 50)
[ -1.13568349e-03  -1.11478370e-03  -1.10369266e-03  -1.09523499e-03
  -1.10848993e-03  -1.16946003e-03  -1.31727817e-03  -1.48693977e-03
  -1.62541603e-03  -1.65340316e-03  -1.66049727e-03  -1.63461700e-03
  -1.54248386e-03  -1.56569154e-03  -1.57803392e-03  -1.56214536e-03
  -1.43996747e-03  -1.22810954e-03  -1.01342585e-03  -8.92211579e-04
  -9.72948363e-04  -1.01905875e-03  -6.12939241e-04  -6.67123810e-04
  -5.42391663e-04  -6.01994802e-04  -7.58843960e-04  -9.24718082e-04
  -1.04392219e-03  -1.08803004e-03  -1.08919437e-03  -1.03861910e-03
  -1.00884188e-03  -1.01100036e-03  -1.00117789e-03  -9.99026961e-04
  -1.00541015e-03  -9.87360053e-04  -9.80655279e-04  -9.68071283e-04
  -9.70559879e-04  -9.48241432e-04  -9.12455537e-04  -8.38553701e-04
  -7.17823292e-04  -5.81365966e-04  -4.71177519e-04  -3.33617734e-04
  -1.61174984e-04  -1.91075155e-05]
[2001 2002 2003 2004 2005 2006 2007 2008 2009 2010 2011]
[2001 2002 2003 2004 2005 2006 2007 2008 2009 2010]
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
(2, 50)
[ -1.26265252e-03  -1.29243738e-03  -1.27383686e-03  -1.25387497e-03
  -1.18936235e-03  -9.66432335e-04  -4.96170430e-04  -4.70304147e-05
   3.99550579e-04   6.48811060e-04   6.71763812e-04   6.15404843e-04
   5.72470126e-04   5.80536620e-04   6.03752455e-04   6.40638111e-04
   6.56939851e-04   6.40592246e-04   6.22147321e-04   5.67058902e-04
   5.17141572e-04   4.39299273e-04   3.73431207e-04   2.89253578e-04
   2.81056546e-04   2.00061401e-04   1.94950459e-04   1.57165519e-04
   1.00434074e-04   3.80779483e-05  -4.90444601e-05  -1.63881510e-04
  -2.73098401e-04  -3.67757553e-04  -4.48189890e-04  -5.23659318e-04
  -5.86434916e-04  -6.39708887e-04  -6.77914630e-04  -7.19112177e-04
  -7.70782574e-04  -8.07313238e-04  -8.15940598e-04  -7.97862986e-04
  -7.19462576e-04  -5.87867418e-04  -4.91626004e-04  -3.85135965e-04
  -2.19306556e-04  -1.60633402e-05]
(2, 50)
[ -5.42203826e-05  -5.89989779e-05  -6.79229169e-05  -1.08568106e-04
  -1.56906878e-04  -2.20032001e-04  -2.54890794e-04  -3.10614267e-04
  -3.80472725e-04  -4.46524590e-04  -5.21531836e-04  -5.87600939e-04
  -6.24602607e-04  -6.53588397e-04  -6.93684348e-04  -7.21183830e-04
  -7.03628813e-04  -7.15038691e-04  -7.58137322e-04  -8.49371343e-04
  -9.57958297e-04  -1.03523890e-03  -1.07860070e-03  -1.10391968e-03
  -1.16668809e-03  -1.21104508e-03  -1.23139788e-03  -1.24103924e-03
  -1.26596249e-03  -1.29420519e-03  -1.31018553e-03  -1.32200782e-03
  -1.35208786e-03  -1.36408577e-03  -1.35590050e-03  -1.33556043e-03
  -1.32760270e-03  -1.31264312e-03  -1.27910719e-03  -1.24218214e-03
  -1.20086564e-03  -1.14024239e-03  -1.06174046e-03  -9.54609085e-04
  -8.03436177e-04  -6.40184040e-04  -5.07347209e-04  -3.51403466e-04
  -1.64224894e-04  -1.78970805e-05]

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_67_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{c+c1}{\PYZsh{}Do Atlantic sector of southern ocean trend plot}
        
        \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cAtlTz\PYZus{}Sof60S\PYZus{}1971\PYZhy{}1979.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{cAtlTz}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n}{of}\PY{p}{)}
        \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cAtlTz\PYZus{}Sof60S\PYZus{}1980\PYZhy{}2020.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{cAtlTz2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n}{of}\PY{p}{)}
        \PY{n}{cAtlTz}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{concatenate}\PY{p}{(}\PY{p}{(}\PY{n}{cAtlTz}\PY{p}{,}\PY{n}{cAtlTz2}\PY{p}{)}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{)}
        \PY{k}{print} \PY{n}{cAtlTz}\PY{o}{.}\PY{n}{shape}
        
        \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pAtlTz\PYZus{}Sof60S.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{pAtlTz}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n}{of}\PY{p}{)}
        \PY{k}{print} \PY{n}{pAtlTz}\PY{o}{.}\PY{n}{shape}
        
        
        \PY{n}{cyrs}\PY{o}{=}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1971}\PY{p}{,}\PY{l+m+mi}{2020}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{n}{pyrs}\PY{o}{=}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1973}\PY{p}{,}\PY{l+m+mi}{2011}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{k}{print} \PY{n}{cyrs}\PY{o}{.}\PY{n}{shape}
        \PY{k}{print} \PY{n}{cyrs}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{:}\PY{l+m+mi}{10}\PY{p}{]}
        \PY{k}{print} \PY{n}{pyrs}\PY{o}{.}\PY{n}{shape}
        \PY{k}{print} \PY{n}{pyrs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{8}\PY{p}{]}
        
        \PY{c+c1}{\PYZsh{}calc linear trend in mC/yr over whole period}
        \PY{k}{print} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{8}\PY{p}{)}
        \PY{n}{tr\PYZus{}pTz}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{polyfit}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{,} \PY{n}{pAtlTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{8}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{k}{print} \PY{n}{tr\PYZus{}pTz}\PY{o}{.}\PY{n}{shape}
        \PY{k}{print} \PY{n}{tr\PYZus{}pTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}
        
        \PY{n}{tr\PYZus{}cTz}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{polyfit}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{8}\PY{p}{)}\PY{p}{,} \PY{n}{cAtlTz}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{:}\PY{l+m+mi}{10}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{k}{print} \PY{n}{tr\PYZus{}cTz}\PY{o}{.}\PY{n}{shape}
        \PY{k}{print} \PY{n}{tr\PYZus{}cTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}
        
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{12.5}\PY{p}{,}\PY{l+m+mf}{9.5}\PY{p}{)}\PY{p}{)}
        \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{411}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{tr\PYZus{}cTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{1000}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Control}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{tr\PYZus{}pTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{1000}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Perturbation}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{tr\PYZus{}pTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{1000}\PY{o}{\PYZhy{}}\PY{n}{tr\PYZus{}cTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{1000}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Perturbation\PYZhy{}Control}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{30}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{]}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{1000}\PY{p}{,}\PY{l+m+mi}{5500}\PY{p}{]}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mC/yr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth (m)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{tit}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1973\PYZhy{}1980 Linear Temp Trend Atlantic South of 60\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}S}\PY{l+s+s1}{\PYZsq{}}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{tit}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{}calc linear trend in mC/yr since 1981\PYZhy{}2000 (8 years from 1973) }
        \PY{k}{print} \PY{n}{cyrs}\PY{p}{[}\PY{l+m+mi}{10}\PY{p}{:}\PY{l+m+mi}{30}\PY{p}{]}
        \PY{k}{print} \PY{n}{pyrs}\PY{o}{.}\PY{n}{shape}
        \PY{k}{print} \PY{n}{pyrs}\PY{p}{[}\PY{l+m+mi}{8}\PY{p}{:}\PY{l+m+mi}{28}\PY{p}{]}
        
        \PY{k}{print} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{)}
        \PY{n}{tr\PYZus{}pTz}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{polyfit}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{)}\PY{p}{,} \PY{n}{pAtlTz}\PY{p}{[}\PY{l+m+mi}{8}\PY{p}{:}\PY{l+m+mi}{28}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{k}{print} \PY{n}{tr\PYZus{}pTz}\PY{o}{.}\PY{n}{shape}
        \PY{k}{print} \PY{n}{tr\PYZus{}pTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}
        
        \PY{n}{tr\PYZus{}cTz}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{polyfit}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{)}\PY{p}{,} \PY{n}{cAtlTz}\PY{p}{[}\PY{l+m+mi}{10}\PY{p}{:}\PY{l+m+mi}{30}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{k}{print} \PY{n}{tr\PYZus{}cTz}\PY{o}{.}\PY{n}{shape}
        \PY{k}{print} \PY{n}{tr\PYZus{}cTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{412}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{tr\PYZus{}cTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{1000}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Control}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{tr\PYZus{}pTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{1000}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Perturbation}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{tr\PYZus{}pTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{1000}\PY{o}{\PYZhy{}}\PY{n}{tr\PYZus{}cTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{1000}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Perturbation\PYZhy{}Control}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{9}\PY{p}{]}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{1000}\PY{p}{,}\PY{l+m+mi}{5500}\PY{p}{]}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mC/yr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth (m)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{tit}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1981\PYZhy{}2000 Linear Temp Trend Atlantic South of 60\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}S}\PY{l+s+s1}{\PYZsq{}}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{tit}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{}calc linear trend in mC/yr since 2001\PYZhy{}2011 (8 years from 1973) }
        \PY{k}{print} \PY{n}{cyrs}\PY{p}{[}\PY{l+m+mi}{30}\PY{p}{:}\PY{l+m+mi}{41}\PY{p}{]}
        \PY{k}{print} \PY{n}{pyrs}\PY{p}{[}\PY{l+m+mi}{28}\PY{p}{:}\PY{l+m+mi}{38}\PY{p}{]}
        
        \PY{k}{print} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
        \PY{n}{tr\PYZus{}pTz}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{polyfit}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,} \PY{n}{pAtlTz}\PY{p}{[}\PY{l+m+mi}{28}\PY{p}{:}\PY{l+m+mi}{38}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{k}{print} \PY{n}{tr\PYZus{}pTz}\PY{o}{.}\PY{n}{shape}
        \PY{k}{print} \PY{n}{tr\PYZus{}pTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}
        
        \PY{n}{tr\PYZus{}cTz}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{polyfit}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,} \PY{n}{cAtlTz}\PY{p}{[}\PY{l+m+mi}{30}\PY{p}{:}\PY{l+m+mi}{40}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{k}{print} \PY{n}{tr\PYZus{}cTz}\PY{o}{.}\PY{n}{shape}
        \PY{k}{print} \PY{n}{tr\PYZus{}cTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{413}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{tr\PYZus{}cTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{1000}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Control}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{tr\PYZus{}pTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{1000}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Perturbation}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{tr\PYZus{}pTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{1000}\PY{o}{\PYZhy{}}\PY{n}{tr\PYZus{}cTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{1000}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Perturbation\PYZhy{}Control}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{9}\PY{p}{]}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{1000}\PY{p}{,}\PY{l+m+mi}{5500}\PY{p}{]}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mC/yr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth (m)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{tit}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2001\PYZhy{}2017 Linear Temp Trend Atlantic South of 60\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}S}\PY{l+s+s1}{\PYZsq{}}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{tit}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{}calc linear trend in mC/yr since 1981\PYZhy{}2017 }
        \PY{k}{print} \PY{n}{cyrs}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{:}\PY{l+m+mi}{41}\PY{p}{]}
        \PY{k}{print} \PY{n}{pyrs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{38}\PY{p}{]}
        
        \PY{n}{tr\PYZus{}pTz}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{polyfit}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{38}\PY{p}{)}\PY{p}{,} \PY{n}{pAtlTz}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{k}{print} \PY{n}{tr\PYZus{}pTz}\PY{o}{.}\PY{n}{shape}
        \PY{k}{print} \PY{n}{tr\PYZus{}pTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}
        
        \PY{n}{tr\PYZus{}cTz}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{polyfit}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{38}\PY{p}{)}\PY{p}{,} \PY{n}{cAtlTz}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{:}\PY{l+m+mi}{38}\PY{o}{+}\PY{l+m+mi}{3}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{k}{print} \PY{n}{tr\PYZus{}cTz}\PY{o}{.}\PY{n}{shape}
        \PY{k}{print} \PY{n}{tr\PYZus{}cTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{414}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{tr\PYZus{}cTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{1000}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Control}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{tr\PYZus{}pTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{1000}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Perturbation}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{tr\PYZus{}pTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{1000}\PY{o}{\PYZhy{}}\PY{n}{tr\PYZus{}cTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{1000}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Perturbation\PYZhy{}Control}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{9}\PY{p}{]}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{1000}\PY{p}{,}\PY{l+m+mi}{5500}\PY{p}{]}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mC/yr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth (m)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{tit}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1981\PYZhy{}2017 Linear Temp Trend Atlantic South of 60\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}S}\PY{l+s+s1}{\PYZsq{}}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{tit}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}gmoc\PYZus{}ts.pdf\PYZsq{})}
        \PY{c+c1}{\PYZsh{}print of}
        \PY{c+c1}{\PYZsh{}plt.savefig(of)}
        \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tr\PYZus{}AtlTz.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(49, 50)
(38, 50)
(49,)
[1973 1974 1975 1976 1977 1978 1979 1980]
(38,)
[1973 1974 1975 1976 1977 1978 1979 1980]
[0, 1, 2, 3, 4, 5, 6, 7]
(2, 50)
[-0.04636074 -0.04598287 -0.0424254  -0.04389643 -0.04813749 -0.0487219
 -0.04293983 -0.03269457 -0.02395647 -0.0185062  -0.01645504 -0.01703056
 -0.01699792 -0.01653084 -0.01690365 -0.01782746 -0.01850409 -0.0192653
 -0.02037923 -0.02162613 -0.02273042 -0.02347527 -0.02388838 -0.02396094
 -0.02410858 -0.02428718 -0.02452406 -0.02469449 -0.02463468 -0.02436379
 -0.0242128  -0.02426809 -0.02398887 -0.02300284 -0.02213017 -0.02121927
 -0.02053419 -0.01984266 -0.01894854 -0.01826627 -0.01761754 -0.01707877
 -0.01663058 -0.01610914 -0.01518912 -0.01390218 -0.01154243 -0.0076473
 -0.0031558  -0.00074359]
(2, 50)
[  1.12997738e-03   1.09235828e-03   9.75333401e-04   5.85606790e-04
   4.15821754e-04   5.45297988e-04   1.14359539e-03   1.24267469e-03
   7.91143968e-04   4.40861040e-04  -7.21990696e-05  -5.16507571e-04
  -7.43542499e-04  -7.75057586e-04  -8.30165574e-04  -9.99155485e-04
  -1.20093276e-03  -1.10356612e-03  -1.17303363e-03  -1.42792340e-03
  -1.52832000e-03  -1.54018707e-03  -1.61625877e-03  -1.59109689e-03
  -1.54291028e-03  -1.51308372e-03  -1.51488597e-03  -1.51971848e-03
  -1.51485626e-03  -1.53689946e-03  -1.61425785e-03  -1.76762055e-03
  -2.01928678e-03  -2.09812858e-03  -2.18636367e-03  -2.30517365e-03
  -2.32784033e-03  -2.32557076e-03  -2.28388187e-03  -2.26282548e-03
  -2.20140982e-03  -2.06789946e-03  -1.89629167e-03  -1.78320882e-03
  -1.75670853e-03  -1.70160360e-03  -1.34177017e-03  -9.38067418e-04
  -4.68457197e-04  -8.57369155e-05]
[1981 1982 1983 1984 1985 1986 1987 1988 1989 1990 1991 1992 1993 1994 1995
 1996 1997 1998 1999 2000]
(38,)
[1981 1982 1983 1984 1985 1986 1987 1988 1989 1990 1991 1992 1993 1994 1995
 1996 1997 1998 1999 2000]
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
(2, 50)
[  3.10552102e-03   3.12638404e-03   2.62588590e-03   1.49576058e-03
   1.42638203e-03   2.71759315e-03   4.74745141e-03   7.05081051e-03
   8.77154839e-03   8.64244925e-03   7.66596022e-03   6.54265522e-03
   5.40743469e-03   4.80438099e-03   4.57338829e-03   4.54117999e-03
   4.61787645e-03   4.77510921e-03   4.96966724e-03   5.31841661e-03
   5.62013589e-03   5.99637267e-03   6.24995091e-03   6.34512701e-03
   6.44690962e-03   6.56539409e-03   6.66920144e-03   6.74643825e-03
   6.79579686e-03   6.77216489e-03   6.49400794e-03   6.18764007e-03
   5.72697339e-03   4.96369741e-03   4.25079081e-03   3.71557664e-03
   3.49434870e-03   3.47087907e-03   3.33594392e-03   2.90451369e-03
   2.42240538e-03   2.02500086e-03   1.75472805e-03   1.34884805e-03
   8.62872192e-04   6.46554207e-04   4.21273714e-04   1.29898860e-05
  -2.87883434e-04  -5.32537707e-05]
(2, 50)
[  1.01955434e-03   1.03404654e-03   9.18808642e-04   5.35086184e-04
   2.76937490e-04   6.79844249e-05  -1.40803899e-04  -3.14446834e-04
  -5.16375512e-04  -6.67189725e-04  -8.80146106e-04  -1.05930458e-03
  -1.14778941e-03  -1.15741036e-03  -1.21449103e-03  -1.35534811e-03
  -1.49065816e-03  -1.61659757e-03  -1.71699418e-03  -1.86020184e-03
  -1.93528325e-03  -1.99267511e-03  -1.98481353e-03  -1.98342429e-03
  -1.96815090e-03  -1.95406148e-03  -1.93289619e-03  -1.91989836e-03
  -1.91928112e-03  -1.94939063e-03  -1.97935571e-03  -2.00780216e-03
  -2.09874317e-03  -2.05824255e-03  -2.01380539e-03  -2.00030138e-03
  -2.06146363e-03  -2.12759644e-03  -2.12639506e-03  -2.07803622e-03
  -1.99612864e-03  -1.90265599e-03  -1.78967392e-03  -1.65904313e-03
  -1.50098641e-03  -1.32622262e-03  -1.11008681e-03  -8.15903958e-04
  -4.19272200e-04  -8.05376296e-05]
[2001 2002 2003 2004 2005 2006 2007 2008 2009 2010 2011]
[2001 2002 2003 2004 2005 2006 2007 2008 2009 2010]
[0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
(2, 50)
[ 0.00289581  0.00286651  0.00262629  0.00206761  0.0024653   0.00387951
  0.00480856  0.00393348  0.0024195   0.00143957  0.00104927  0.00071927
  0.00053155  0.00010217 -0.00048666 -0.00097333 -0.00134505 -0.00172767
 -0.00211104 -0.00252541 -0.00277081 -0.00298953 -0.00278936 -0.00278778
 -0.00269461 -0.00262322 -0.00255055 -0.00247631 -0.00237996 -0.00229486
 -0.00210725 -0.00195539 -0.00135485 -0.00081958 -0.00084029 -0.00094315
 -0.00102335 -0.00114947 -0.00119955 -0.00118788 -0.00104027 -0.00092687
 -0.00070225 -0.00014632  0.00053751  0.00095101  0.00106224  0.00085424
  0.0004668   0.00012623]
(2, 50)
[ -5.45902268e-04  -5.62885651e-04  -5.58464450e-04  -3.99458405e-04
  -3.82561447e-04  -4.27243784e-04  -7.64877240e-04  -1.19931809e-03
  -1.34549107e-03  -1.23729554e-03  -9.61795192e-04  -7.50507246e-04
  -6.63250669e-04  -6.78178130e-04  -6.14333094e-04  -6.25957422e-04
  -6.32857059e-04  -6.97043635e-04  -8.85057770e-04  -1.02345955e-03
  -1.00363630e-03  -9.60156711e-04  -9.50755170e-04  -9.37858183e-04
  -9.64322956e-04  -9.98778654e-04  -1.02793070e-03  -1.05939789e-03
  -1.10555328e-03  -1.16773353e-03  -1.13973208e-03  -1.02272426e-03
  -1.09150158e-03  -1.31743416e-03  -1.37009631e-03  -1.40221359e-03
  -1.43678510e-03  -1.52599811e-03  -1.58408130e-03  -1.58344289e-03
  -1.54176625e-03  -1.46620801e-03  -1.43298969e-03  -1.37641591e-03
  -1.27005991e-03  -1.15977053e-03  -1.00891677e-03  -7.98073152e-04
  -4.42506081e-04  -8.92054709e-05]
[1974 1975 1976 1977 1978 1979 1980 1981 1982 1983 1984 1985 1986 1987 1988
 1989 1990 1991 1992 1993 1994 1995 1996 1997 1998 1999 2000 2001 2002 2003
 2004 2005 2006 2007 2008 2009 2010 2011]
[1973 1974 1975 1976 1977 1978 1979 1980 1981 1982 1983 1984 1985 1986 1987
 1988 1989 1990 1991 1992 1993 1994 1995 1996 1997 1998 1999 2000 2001 2002
 2003 2004 2005 2006 2007 2008 2009 2010]
(2, 50)
[ -5.46452343e-03  -5.56515086e-03  -5.55677282e-03  -5.35702833e-03
  -4.78711269e-03  -3.42975566e-03  -1.01708753e-03   1.36578101e-03
   3.11716172e-03   3.70581152e-03   3.68242852e-03   3.40794748e-03
   3.04041980e-03   2.82706826e-03   2.75668378e-03   2.74781883e-03
   2.74875492e-03   2.79290538e-03   2.85823124e-03   2.95693590e-03
   3.11827367e-03   3.29776291e-03   3.49185780e-03   3.59566367e-03
   3.69980649e-03   3.78051975e-03   3.83482062e-03   3.86761347e-03
   3.88824624e-03   3.86434511e-03   3.63569854e-03   3.18437503e-03
   2.71661524e-03   2.25669916e-03   1.86783093e-03   1.53590186e-03
   1.24488259e-03   9.85872542e-04   7.20715420e-04   4.34545640e-04
   1.69364756e-04  -5.98635586e-05  -2.48610684e-04  -4.61729475e-04
  -6.51723885e-04  -6.77814836e-04  -6.48087689e-04  -6.47936184e-04
  -4.70072781e-04  -7.21812227e-05]
(2, 50)
[  3.20279663e-04   3.14352001e-04   2.80687313e-04   1.76841112e-04
   1.05224584e-04   5.19995608e-05  -1.08102359e-05  -2.13181154e-04
  -4.96913787e-04  -6.56818844e-04  -8.19897701e-04  -9.54207900e-04
  -9.97578682e-04  -1.04121354e-03  -1.12178723e-03  -1.23078024e-03
  -1.33243405e-03  -1.43216380e-03  -1.51755959e-03  -1.62961931e-03
  -1.69922827e-03  -1.73438732e-03  -1.74624802e-03  -1.75826383e-03
  -1.75546749e-03  -1.75327155e-03  -1.74651013e-03  -1.74410449e-03
  -1.74802224e-03  -1.77479200e-03  -1.79768253e-03  -1.82909416e-03
  -1.93765854e-03  -1.96527464e-03  -1.95733549e-03  -1.96790737e-03
  -2.02280442e-03  -2.07755931e-03  -2.08235134e-03  -2.05188215e-03
  -1.98715075e-03  -1.90134178e-03  -1.80095078e-03  -1.68318891e-03
  -1.54167859e-03  -1.38251083e-03  -1.15653066e-03  -8.52684790e-04
  -4.36869458e-04  -8.32115197e-05]

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_68_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{n}{cyrs}\PY{o}{=}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1971}\PY{p}{,}\PY{l+m+mi}{2020}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{n}{pyrs}\PY{o}{=}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1973}\PY{p}{,}\PY{l+m+mi}{2012}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
        
        \PY{k}{print} \PY{n}{cyrs}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{:}\PY{l+m+mi}{10}\PY{p}{]}
        \PY{k}{print} \PY{n}{pyrs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{8}\PY{p}{]}
        
        \PY{k}{print} \PY{n}{cyrs}\PY{p}{[}\PY{l+m+mi}{10}\PY{p}{:}\PY{l+m+mi}{30}\PY{p}{]}
        \PY{k}{print} \PY{n}{pyrs}\PY{p}{[}\PY{l+m+mi}{8}\PY{p}{:}\PY{l+m+mi}{28}\PY{p}{]}
        
        
        \PY{k}{print} \PY{n}{cyrs}\PY{p}{[}\PY{l+m+mi}{30}\PY{p}{:}\PY{l+m+mi}{41}\PY{p}{]}
        \PY{k}{print} \PY{n}{pyrs}\PY{p}{[}\PY{l+m+mi}{28}\PY{p}{:}\PY{l+m+mi}{38}\PY{p}{]}
        \PY{k}{print} \PY{n}{pyrs}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[1973 1974 1975 1976 1977 1978 1979 1980]
[1973 1974 1975 1976 1977 1978 1979 1980]
[1981 1982 1983 1984 1985 1986 1987 1988 1989 1990 1991 1992 1993 1994 1995
 1996 1997 1998 1999 2000]
[1981 1982 1983 1984 1985 1986 1987 1988 1989 1990 1991 1992 1993 1994 1995
 1996 1997 1998 1999 2000]
[2001 2002 2003 2004 2005 2006 2007 2008 2009 2010 2011]
[2001 2002 2003 2004 2005 2006 2007 2008 2009 2010]
(39,)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{c+c1}{\PYZsh{}depth average between 2000\PYZhy{}4000m and below 4000m, Fig 3 of Purkey et al., 2016.}
        \PY{c+c1}{\PYZsh{}calculate linear ocean warming trends spanning 1981 to 2016}
        \PY{n}{dst}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{l+m+mi}{50}\PY{p}{)}
        \PY{n}{dst}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{l+m+mi}{50}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{diff}\PY{p}{(}\PY{n}{st\PYZus{}ocean}\PY{p}{)}
        \PY{n}{dst}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{=}\PY{n}{st\PYZus{}ocean}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
        \PY{k}{print} \PY{n}{dst}\PY{o}{.}\PY{n}{shape}
        
        \PY{c+c1}{\PYZsh{}depth integrate from 2000\PYZhy{}4000 and 4000:}
        \PY{k}{print} \PY{n}{st\PYZus{}ocean}\PY{p}{[}\PY{l+m+mi}{33}\PY{p}{:}\PY{l+m+mi}{43}\PY{p}{]}
        \PY{k}{print} \PY{n}{st\PYZus{}ocean}\PY{p}{[}\PY{l+m+mi}{43}\PY{p}{:}\PY{l+m+mi}{50}\PY{p}{]}
        
        
        
        \PY{k}{print} \PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}
        \PY{n}{pT\PYZus{}2to4}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}\PY{p}{)}
        \PY{n}{pT\PYZus{}4to6}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}\PY{p}{)}
        \PY{k}{print} \PY{n}{pT\PYZus{}2to4}\PY{o}{.}\PY{n}{shape}
        
        \PY{c+c1}{\PYZsh{}also do in j/m2}
        \PY{n}{pT\PYZus{}2to4\PYZus{}jm2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}\PY{p}{)}
        \PY{n}{pT\PYZus{}4to6\PYZus{}jm2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{}W/m2=K/yr*yr/s*J/kg/K*kg/m3*m}
        \PY{c+c1}{\PYZsh{}J/s/m2=W/m2}
        
        \PY{c+c1}{\PYZsh{}K *m *J/kg/K *kg/m3 = J/m2}
        \PY{n}{Cp}\PY{o}{=}\PY{l+m+mi}{3985}
        \PY{n}{rho0}\PY{o}{=}\PY{l+m+mi}{1034}
        
        \PY{k}{for} \PY{n}{t} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{p}{:}
            \PY{k}{print} \PY{n}{t}
            
            \PY{n}{pT\PYZus{}2to4}\PY{p}{[}\PY{n}{t}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{ma}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{n}{t}\PY{p}{,}\PY{l+m+mi}{33}\PY{p}{:}\PY{l+m+mi}{43}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{*}\PY{n}{dzt}\PY{p}{[}\PY{l+m+mi}{33}\PY{p}{:}\PY{l+m+mi}{43}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{/}\PY{n}{np}\PY{o}{.}\PY{n}{ma}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{dzt}\PY{p}{[}\PY{l+m+mi}{33}\PY{p}{:}\PY{l+m+mi}{43}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
            \PY{n}{pT\PYZus{}4to6}\PY{p}{[}\PY{n}{t}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{ma}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{n}{t}\PY{p}{,}\PY{l+m+mi}{43}\PY{p}{:}\PY{l+m+mi}{50}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{*}\PY{n}{dzt}\PY{p}{[}\PY{l+m+mi}{43}\PY{p}{:}\PY{l+m+mi}{50}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{/}\PY{n}{np}\PY{o}{.}\PY{n}{ma}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{dzt}\PY{p}{[}\PY{l+m+mi}{43}\PY{p}{:}\PY{l+m+mi}{50}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
            \PY{n}{pT\PYZus{}2to4\PYZus{}jm2}\PY{p}{[}\PY{n}{t}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{ma}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{n}{t}\PY{p}{,}\PY{l+m+mi}{33}\PY{p}{:}\PY{l+m+mi}{43}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{*}\PY{n}{dzt}\PY{p}{[}\PY{l+m+mi}{33}\PY{p}{:}\PY{l+m+mi}{43}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{*}\PY{n}{Cp}\PY{o}{*}\PY{n}{rho0}
            \PY{n}{pT\PYZus{}4to6\PYZus{}jm2}\PY{p}{[}\PY{n}{t}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{ma}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{n}{t}\PY{p}{,}\PY{l+m+mi}{43}\PY{p}{:}\PY{l+m+mi}{50}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{*}\PY{n}{dzt}\PY{p}{[}\PY{l+m+mi}{43}\PY{p}{:}\PY{l+m+mi}{50}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{*}\PY{n}{Cp}\PY{o}{*}\PY{n}{rho0}
            
        \PY{k}{print} \PY{n}{pT\PYZus{}2to4}\PY{o}{.}\PY{n}{shape}
        \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pT\PYZus{}2to4.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{a}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{pT\PYZus{}2to4}\PY{p}{)}
        
        \PY{k}{print} \PY{n}{pT\PYZus{}4to6}\PY{o}{.}\PY{n}{shape}
        \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pT\PYZus{}4to6.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{a}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{pT\PYZus{}4to6}\PY{p}{)}    
        
        \PY{k}{print} \PY{n}{pT\PYZus{}2to4\PYZus{}jm2}\PY{o}{.}\PY{n}{shape}
        \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pT\PYZus{}2to4\PYZus{}jm2.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{a}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{pT\PYZus{}2to4\PYZus{}jm2}\PY{p}{)}
        
        \PY{k}{print} \PY{n}{pT\PYZus{}4to6\PYZus{}jm2}\PY{o}{.}\PY{n}{shape}
        \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pT\PYZus{}4to6\PYZus{}jm2.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{a}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{pT\PYZus{}4to6\PYZus{}jm2}\PY{p}{)}    
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(50,)
[ 2071.25195312  2271.32324219  2474.04296875  2678.75708008  2884.89794922
  3092.1171875   3300.0859375   3508.63305664  3717.56713867  3926.81274414]
[ 4136.25146484  4345.86376953  4555.56591797  4765.36865234  4975.20947266
  5185.11083984  5395.02294922]
(40, 50, 1080, 1440)
(40, 1080, 1440)
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
(40, 1080, 1440)
(40, 1080, 1440)
(40, 1080, 1440)
(40, 1080, 1440)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{c+c1}{\PYZsh{}depth average between 2000\PYZhy{}4000m and below 4000m, Fig 3 of Purkey et al., 2016.}
         \PY{c+c1}{\PYZsh{}calculate linear ocean warming trends spanning 1981 to 2016}
         
         \PY{c+c1}{\PYZsh{}depth integrate from 2000\PYZhy{}4000 and 4000:}
         \PY{k}{print} \PY{n}{st\PYZus{}ocean}\PY{p}{[}\PY{l+m+mi}{33}\PY{p}{:}\PY{l+m+mi}{43}\PY{p}{]}
         \PY{k}{print} \PY{n}{st\PYZus{}ocean}\PY{p}{[}\PY{l+m+mi}{43}\PY{p}{:}\PY{l+m+mi}{50}\PY{p}{]}
         
         \PY{k}{print} \PY{n}{cntrl}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}
         \PY{k}{print} \PY{n}{cntrl2}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}
         \PY{n}{cT\PYZus{}2to4}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{49}\PY{p}{,}\PY{n}{cntrl}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,}\PY{n}{cntrl}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         \PY{n}{cT\PYZus{}4to6}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{49}\PY{p}{,}\PY{n}{cntrl}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,}\PY{n}{cntrl}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         \PY{k}{print} \PY{n}{cT\PYZus{}2to4}\PY{o}{.}\PY{n}{shape}
         
         \PY{c+c1}{\PYZsh{}also do in j/m2}
         \PY{c+c1}{\PYZsh{}K *m *J/kg/K *kg/m3 = J/m2}
         \PY{n}{Cp}\PY{o}{=}\PY{l+m+mi}{3985}
         \PY{n}{rho0}\PY{o}{=}\PY{l+m+mi}{1034}
         \PY{n}{cT\PYZus{}2to4\PYZus{}jm2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{49}\PY{p}{,}\PY{n}{cntrl}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,}\PY{n}{cntrl}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         \PY{n}{cT\PYZus{}4to6\PYZus{}jm2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{49}\PY{p}{,}\PY{n}{cntrl}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{p}{,}\PY{n}{cntrl}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}\PY{p}{)}
         
         
         \PY{k}{for} \PY{n}{t} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{49}\PY{p}{)}\PY{p}{:}
             \PY{k}{print} \PY{n}{t}
             
             \PY{k}{if} \PY{n}{t}\PY{o}{\PYZlt{}}\PY{l+m+mi}{9}\PY{p}{:}
                 \PY{n}{cT\PYZus{}2to4}\PY{p}{[}\PY{n}{t}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{ma}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{cntrl}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{n}{t}\PY{p}{,}\PY{l+m+mi}{33}\PY{p}{:}\PY{l+m+mi}{43}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{*}\PY{n}{dzt}\PY{p}{[}\PY{l+m+mi}{33}\PY{p}{:}\PY{l+m+mi}{43}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{/}\PY{n}{np}\PY{o}{.}\PY{n}{ma}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{dzt}\PY{p}{[}\PY{l+m+mi}{33}\PY{p}{:}\PY{l+m+mi}{43}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
                 \PY{n}{cT\PYZus{}4to6}\PY{p}{[}\PY{n}{t}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{ma}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{cntrl}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{n}{t}\PY{p}{,}\PY{l+m+mi}{43}\PY{p}{:}\PY{l+m+mi}{50}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{*}\PY{n}{dzt}\PY{p}{[}\PY{l+m+mi}{43}\PY{p}{:}\PY{l+m+mi}{50}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{/}\PY{n}{np}\PY{o}{.}\PY{n}{ma}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{dzt}\PY{p}{[}\PY{l+m+mi}{43}\PY{p}{:}\PY{l+m+mi}{50}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
                 \PY{n}{cT\PYZus{}2to4\PYZus{}jm2}\PY{p}{[}\PY{n}{t}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{ma}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{cntrl}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{n}{t}\PY{p}{,}\PY{l+m+mi}{33}\PY{p}{:}\PY{l+m+mi}{43}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{*}\PY{n}{dzt}\PY{p}{[}\PY{l+m+mi}{33}\PY{p}{:}\PY{l+m+mi}{43}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{*}\PY{n}{Cp}\PY{o}{*}\PY{n}{rho0}
                 \PY{n}{cT\PYZus{}4to6\PYZus{}jm2}\PY{p}{[}\PY{n}{t}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{ma}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{cntrl}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{n}{t}\PY{p}{,}\PY{l+m+mi}{43}\PY{p}{:}\PY{l+m+mi}{50}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{*}\PY{n}{dzt}\PY{p}{[}\PY{l+m+mi}{43}\PY{p}{:}\PY{l+m+mi}{50}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{*}\PY{n}{Cp}\PY{o}{*}\PY{n}{rho0}
             \PY{k}{else}\PY{p}{:}
                 \PY{n}{cT\PYZus{}2to4}\PY{p}{[}\PY{n}{t}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{ma}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{n}{t}\PY{o}{\PYZhy{}}\PY{l+m+mi}{9}\PY{p}{,}\PY{l+m+mi}{33}\PY{p}{:}\PY{l+m+mi}{43}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{*}\PY{n}{dzt}\PY{p}{[}\PY{l+m+mi}{33}\PY{p}{:}\PY{l+m+mi}{43}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{/}\PY{n}{np}\PY{o}{.}\PY{n}{ma}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{dzt}\PY{p}{[}\PY{l+m+mi}{33}\PY{p}{:}\PY{l+m+mi}{43}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
                 \PY{n}{cT\PYZus{}4to6}\PY{p}{[}\PY{n}{t}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{ma}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{n}{t}\PY{o}{\PYZhy{}}\PY{l+m+mi}{9}\PY{p}{,}\PY{l+m+mi}{43}\PY{p}{:}\PY{l+m+mi}{50}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{*}\PY{n}{dzt}\PY{p}{[}\PY{l+m+mi}{43}\PY{p}{:}\PY{l+m+mi}{50}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{/}\PY{n}{np}\PY{o}{.}\PY{n}{ma}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{dzt}\PY{p}{[}\PY{l+m+mi}{43}\PY{p}{:}\PY{l+m+mi}{50}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
                 \PY{n}{cT\PYZus{}2to4\PYZus{}jm2}\PY{p}{[}\PY{n}{t}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{ma}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{n}{t}\PY{o}{\PYZhy{}}\PY{l+m+mi}{9}\PY{p}{,}\PY{l+m+mi}{33}\PY{p}{:}\PY{l+m+mi}{43}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{*}\PY{n}{dzt}\PY{p}{[}\PY{l+m+mi}{33}\PY{p}{:}\PY{l+m+mi}{43}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{*}\PY{n}{Cp}\PY{o}{*}\PY{n}{rho0}
                 \PY{n}{cT\PYZus{}4to6\PYZus{}jm2}\PY{p}{[}\PY{n}{t}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{ma}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{n}{t}\PY{o}{\PYZhy{}}\PY{l+m+mi}{9}\PY{p}{,}\PY{l+m+mi}{43}\PY{p}{:}\PY{l+m+mi}{50}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{*}\PY{n}{dzt}\PY{p}{[}\PY{l+m+mi}{43}\PY{p}{:}\PY{l+m+mi}{50}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{*}\PY{n}{Cp}\PY{o}{*}\PY{n}{rho0}
             
         \PY{k}{print} \PY{n}{cT\PYZus{}2to4}\PY{o}{.}\PY{n}{shape}
         \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cT\PYZus{}2to4.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{a}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{cT\PYZus{}2to4}\PY{p}{)}
         
         \PY{k}{print} \PY{n}{cT\PYZus{}4to6}\PY{o}{.}\PY{n}{shape}
         \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cT\PYZus{}4to6.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{a}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{cT\PYZus{}4to6}\PY{p}{)} 
         
         \PY{k}{print} \PY{n}{cT\PYZus{}2to4\PYZus{}jm2}\PY{o}{.}\PY{n}{shape}
         \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cT\PYZus{}2to4\PYZus{}jm2.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{a}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{cT\PYZus{}2to4\PYZus{}jm2}\PY{p}{)}
         
         \PY{k}{print} \PY{n}{cT\PYZus{}4to6\PYZus{}jm2}\PY{o}{.}\PY{n}{shape}
         \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cT\PYZus{}4to6\PYZus{}jm2.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{a}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{cT\PYZus{}4to6\PYZus{}jm2}\PY{p}{)}    
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[ 2071.25195312  2271.32324219  2474.04296875  2678.75708008  2884.89794922
  3092.1171875   3300.0859375   3508.63305664  3717.56713867  3926.81274414]
[ 4136.25146484  4345.86376953  4555.56591797  4765.36865234  4975.20947266
  5185.11083984  5395.02294922]
(9, 50, 1080, 1440)
(40, 50, 1080, 1440)
(49, 1080, 1440)
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
(49, 1080, 1440)
(49, 1080, 1440)
(49, 1080, 1440)
(49, 1080, 1440)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cT\PYZus{}2to4.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{cT\PYZus{}2to4}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n}{of}\PY{p}{)}
        
        \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cT\PYZus{}4to6.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{cT\PYZus{}4to6}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n}{of}\PY{p}{)}  
        
        \PY{k}{print} \PY{n}{cT\PYZus{}2to4}\PY{o}{.}\PY{n}{shape}
        \PY{k}{print} \PY{n}{cT\PYZus{}4to6}\PY{o}{.}\PY{n}{shape}
        
        \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pT\PYZus{}2to4.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{pT\PYZus{}2to4}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n}{of}\PY{p}{)}
        
        \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pT\PYZus{}4to6.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{pT\PYZus{}4to6}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n}{of}\PY{p}{)}  
        
        \PY{k}{print} \PY{n}{pT\PYZus{}2to4}\PY{o}{.}\PY{n}{shape}
        \PY{k}{print} \PY{n}{pT\PYZus{}4to6}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(49, 1080, 1440)
(49, 1080, 1440)
(40, 1080, 1440)
(40, 1080, 1440)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cT\PYZus{}2to4\PYZus{}jm2.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{cT\PYZus{}2to4\PYZus{}jm2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n}{of}\PY{p}{)}
        
        \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cT\PYZus{}4to6\PYZus{}jm2.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{cT\PYZus{}4to6\PYZus{}jm2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n}{of}\PY{p}{)}  
        
        \PY{k}{print} \PY{n}{cT\PYZus{}2to4\PYZus{}jm2}\PY{o}{.}\PY{n}{shape}
        \PY{k}{print} \PY{n}{cT\PYZus{}4to6\PYZus{}jm2}\PY{o}{.}\PY{n}{shape}
        
        \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pT\PYZus{}2to4\PYZus{}jm2.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{pT\PYZus{}2to4\PYZus{}jm2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n}{of}\PY{p}{)}
        
        \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pT\PYZus{}4to6\PYZus{}jm2.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{pT\PYZus{}4to6\PYZus{}jm2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n}{of}\PY{p}{)}  
        
        \PY{k}{print} \PY{n}{pT\PYZus{}2to4\PYZus{}jm2}\PY{o}{.}\PY{n}{shape}
        \PY{k}{print} \PY{n}{pT\PYZus{}4to6\PYZus{}jm2}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(49, 1080, 1440)
(49, 1080, 1440)
(40, 1080, 1440)
(40, 1080, 1440)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{12.5}\PY{p}{,}\PY{l+m+mf}{9.5}\PY{p}{)}\PY{p}{)}
        \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{(1991\PYZhy{}2000)\PYZhy{}(1981\PYZhy{}1990) Decadal Temp Anom}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{o}{.}\PY{l+m+mi}{15}\PY{p}{,}\PY{o}{.}\PY{l+m+mi}{16}\PY{p}{,}\PY{o}{.}\PY{l+m+mo}{01}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}print clev}
        
        \PY{n}{cyrs}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1971}\PY{p}{,}\PY{l+m+mi}{2017}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{k}{print} \PY{n}{cyrs}\PY{p}{[}\PY{l+m+mi}{10}\PY{p}{:}\PY{l+m+mi}{20}\PY{p}{]}
        \PY{n}{pyrs}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1973}\PY{p}{,}\PY{l+m+mi}{2017}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{k}{print} \PY{n}{pyrs}\PY{p}{[}\PY{l+m+mi}{8}\PY{p}{:}\PY{l+m+mi}{18}\PY{p}{]}
        
        \PY{n}{var1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cT\PYZus{}2to4}\PY{p}{[}\PY{l+m+mi}{10}\PY{p}{:}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)} \PY{c+c1}{\PYZsh{}\PYZhy{}cntrl2.temp[0:10,st,0:500,:].mean(\PYZsq{}Time\PYZsq{}).load()}
        \PY{n}{var2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cT\PYZus{}2to4}\PY{p}{[}\PY{l+m+mi}{20}\PY{p}{:}\PY{l+m+mi}{30}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)} \PY{c+c1}{\PYZsh{}\PYZhy{}cntrl2.temp[0:10,st,0:500,:].mean(\PYZsq{}Time\PYZsq{}).load()}
        \PY{n}{var3}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{pT\PYZus{}2to4}\PY{p}{[}\PY{l+m+mi}{8}\PY{p}{:}\PY{l+m+mi}{18}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)} \PY{c+c1}{\PYZsh{}\PYZhy{}cntrl2.temp[0:10,st,0:500,:].mean(\PYZsq{}Time\PYZsq{}).load()}
        \PY{n}{var4}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{pT\PYZus{}2to4}\PY{p}{[}\PY{l+m+mi}{18}\PY{p}{:}\PY{l+m+mi}{28}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)} \PY{c+c1}{\PYZsh{}\PYZhy{}cntrl2.temp[0:10,st,0:500,:].mean(\PYZsq{}Time\PYZsq{}).load()}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
        \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)} 
        \PY{c+c1}{\PYZsh{}cntrl starts 1971, pert in 1973.}
        \PY{c+c1}{\PYZsh{}cntrl Tdim ends in 1980, normal starts 1981}
        \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{p}{(}\PY{n}{var4}\PY{o}{\PYZhy{}}\PY{n}{var2}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{p}{(}\PY{n}{var3}\PY{o}{\PYZhy{}}\PY{n}{var1}\PY{p}{)}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
        \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.5)}
        \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}C\PYZsq{})}
        \PY{c+c1}{\PYZsh{}clev3 = np.arange(1000,5001,1000)}
        \PY{c+c1}{\PYZsh{}map.contour(X,Y,ht[0:500,:],levels=clev3,colors=\PYZsq{}k\PYZsq{},linewidths=1)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2000\PYZhy{}4000m }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{n}{ax3} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{axes}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.99}\PY{p}{,}\PY{l+m+mf}{0.68}\PY{p}{,}\PY{l+m+mf}{0.015}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{]}\PY{p}{)}
        \PY{n}{cb} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{p1}\PY{p}{,}\PY{n}{cax}\PY{o}{=}\PY{n}{ax3}\PY{p}{,}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
        \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{o}{.}\PY{l+m+mi}{15}\PY{p}{,}\PY{o}{.}\PY{l+m+mi}{16}\PY{p}{,}\PY{o}{.}\PY{l+m+mo}{01}\PY{p}{)}
        
        \PY{n}{var1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cT\PYZus{}4to6}\PY{p}{[}\PY{l+m+mi}{10}\PY{p}{:}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)} \PY{c+c1}{\PYZsh{}\PYZhy{}cntrl2.temp[0:10,st,0:500,:].mean(\PYZsq{}Time\PYZsq{}).load()}
        \PY{n}{var2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cT\PYZus{}4to6}\PY{p}{[}\PY{l+m+mi}{20}\PY{p}{:}\PY{l+m+mi}{30}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)} \PY{c+c1}{\PYZsh{}\PYZhy{}cntrl2.temp[0:10,st,0:500,:].mean(\PYZsq{}Time\PYZsq{}).load()}
        \PY{n}{var3}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{pT\PYZus{}4to6}\PY{p}{[}\PY{l+m+mi}{8}\PY{p}{:}\PY{l+m+mi}{18}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)} \PY{c+c1}{\PYZsh{}\PYZhy{}cntrl2.temp[0:10,st,0:500,:].mean(\PYZsq{}Time\PYZsq{}).load()}
        \PY{n}{var4}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{pT\PYZus{}4to6}\PY{p}{[}\PY{l+m+mi}{18}\PY{p}{:}\PY{l+m+mi}{28}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)} \PY{c+c1}{\PYZsh{}\PYZhy{}cntrl2.temp[0:10,st,0:500,:].mean(\PYZsq{}Time\PYZsq{}).load()}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
        \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)} 
        \PY{c+c1}{\PYZsh{}cntrl starts 1971, pert in 1973.}
        \PY{c+c1}{\PYZsh{}cntrl Tdim ends in 1980, normal starts 1981}
        \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{p}{(}\PY{n}{var4}\PY{o}{\PYZhy{}}\PY{n}{var2}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{p}{(}\PY{n}{var3}\PY{o}{\PYZhy{}}\PY{n}{var1}\PY{p}{)}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
        \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.5)}
        \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}C\PYZsq{})}
        \PY{c+c1}{\PYZsh{}clev3 = np.arange(1000,5001,1000)}
        \PY{c+c1}{\PYZsh{}map.contour(X,Y,ht[0:500,:],levels=clev3,colors=\PYZsq{}k\PYZsq{},linewidths=1)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{4000\PYZhy{}5500m}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
        
        \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Tanom\PYZus{}decadal\PYZus{}Eq.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{}ax3 = plt.axes([0.92,0.38,0.015,0.25])}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[1981 1982 1983 1984 1985 1986 1987 1988 1989 1990]
[1981 1982 1983 1984 1985 1986 1987 1988 1989 1990]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/mpl\_toolkits/basemap/\_\_init\_\_.py:1711: MatplotlibDeprecationWarning: The axesPatch function was deprecated in version 2.1. Use Axes.patch instead.
  if limb is not ax.axesPatch:
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/matplotlib/figure.py:1999: UserWarning: This figure includes Axes that are not compatible with tight\_layout, so results might be incorrect.
  warnings.warn("This figure includes Axes that are not compatible "

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_74_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}9}]:} \PY{c+c1}{\PYZsh{}calc dT/dt}
        \PY{n}{cyrs}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1971}\PY{p}{,}\PY{l+m+mi}{2017}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{n}{pyrs}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1973}\PY{p}{,}\PY{l+m+mi}{2017}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{}calc linear trend in C/s since 1981\PYZhy{}2000 (8 years from 1973) }
        \PY{k}{print} \PY{n}{cyrs}\PY{p}{[}\PY{l+m+mi}{10}\PY{p}{:}\PY{l+m+mi}{30}\PY{p}{]}
        \PY{k}{print} \PY{n}{pyrs}\PY{p}{[}\PY{l+m+mi}{8}\PY{p}{:}\PY{l+m+mi}{28}\PY{p}{]}
        
        \PY{k}{print} \PY{n}{cyrs}\PY{p}{[}\PY{l+m+mi}{30}\PY{p}{:}\PY{l+m+mi}{40}\PY{p}{]}
        \PY{k}{print} \PY{n}{pyrs}\PY{p}{[}\PY{l+m+mi}{28}\PY{p}{:}\PY{l+m+mi}{38}\PY{p}{]}
        
        \PY{n}{tr81to00\PYZus{}pT\PYZus{}2to4}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{500}\PY{p}{,}\PY{l+m+mi}{1440}\PY{p}{)}\PY{p}{)}
        \PY{n}{tr81to00\PYZus{}cT\PYZus{}2to4}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{500}\PY{p}{,}\PY{l+m+mi}{1440}\PY{p}{)}\PY{p}{)}
        \PY{n}{tr81to00\PYZus{}pT\PYZus{}4to6}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{500}\PY{p}{,}\PY{l+m+mi}{1440}\PY{p}{)}\PY{p}{)}
        \PY{n}{tr81to00\PYZus{}cT\PYZus{}4to6}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{500}\PY{p}{,}\PY{l+m+mi}{1440}\PY{p}{)}\PY{p}{)}
        
        \PY{n}{tr00to17\PYZus{}pT\PYZus{}2to4}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{500}\PY{p}{,}\PY{l+m+mi}{1440}\PY{p}{)}\PY{p}{)}
        \PY{n}{tr00to17\PYZus{}cT\PYZus{}2to4}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{500}\PY{p}{,}\PY{l+m+mi}{1440}\PY{p}{)}\PY{p}{)}
        \PY{n}{tr00to17\PYZus{}pT\PYZus{}4to6}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{500}\PY{p}{,}\PY{l+m+mi}{1440}\PY{p}{)}\PY{p}{)}
        \PY{n}{tr00to17\PYZus{}cT\PYZus{}4to6}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{500}\PY{p}{,}\PY{l+m+mi}{1440}\PY{p}{)}\PY{p}{)}
        
        \PY{n}{tr81to17\PYZus{}pT\PYZus{}2to4}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{500}\PY{p}{,}\PY{l+m+mi}{1440}\PY{p}{)}\PY{p}{)}
        \PY{n}{tr81to17\PYZus{}cT\PYZus{}2to4}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{500}\PY{p}{,}\PY{l+m+mi}{1440}\PY{p}{)}\PY{p}{)}
        \PY{n}{tr81to17\PYZus{}pT\PYZus{}4to6}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{500}\PY{p}{,}\PY{l+m+mi}{1440}\PY{p}{)}\PY{p}{)}
        \PY{n}{tr81to17\PYZus{}cT\PYZus{}4to6}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{500}\PY{p}{,}\PY{l+m+mi}{1440}\PY{p}{)}\PY{p}{)}
        
        
        \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{500}\PY{p}{)}\PY{p}{:}
            \PY{c+c1}{\PYZsh{}print j}
            
            \PY{n}{tr81to00\PYZus{}pT\PYZus{}2to4}\PY{p}{[}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{polyfit}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{)}\PY{p}{,} \PY{n}{pT\PYZus{}2to4}\PY{p}{[}\PY{l+m+mi}{8}\PY{p}{:}\PY{l+m+mi}{28}\PY{p}{,}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}
            \PY{n}{tr81to00\PYZus{}cT\PYZus{}2to4}\PY{p}{[}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{polyfit}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{)}\PY{p}{,} \PY{n}{cT\PYZus{}2to4}\PY{p}{[}\PY{l+m+mi}{10}\PY{p}{:}\PY{l+m+mi}{30}\PY{p}{,}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}
            
            \PY{n}{tr00to17\PYZus{}pT\PYZus{}2to4}\PY{p}{[}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{polyfit}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,} \PY{n}{pT\PYZus{}2to4}\PY{p}{[}\PY{l+m+mi}{28}\PY{p}{:}\PY{l+m+mi}{38}\PY{p}{,}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}
            \PY{n}{tr00to17\PYZus{}cT\PYZus{}2to4}\PY{p}{[}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{polyfit}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,} \PY{n}{cT\PYZus{}2to4}\PY{p}{[}\PY{l+m+mi}{30}\PY{p}{:}\PY{l+m+mi}{40}\PY{p}{,}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}
            
            \PY{n}{tr81to17\PYZus{}pT\PYZus{}2to4}\PY{p}{[}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{polyfit}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{30}\PY{p}{)}\PY{p}{,} \PY{n}{pT\PYZus{}2to4}\PY{p}{[}\PY{l+m+mi}{8}\PY{p}{:}\PY{l+m+mi}{38}\PY{p}{,}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}
            \PY{n}{tr81to17\PYZus{}cT\PYZus{}2to4}\PY{p}{[}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{polyfit}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{30}\PY{p}{)}\PY{p}{,} \PY{n}{cT\PYZus{}2to4}\PY{p}{[}\PY{l+m+mi}{10}\PY{p}{:}\PY{l+m+mi}{40}\PY{p}{,}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}
        
            \PY{n}{tr81to00\PYZus{}pT\PYZus{}4to6}\PY{p}{[}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{polyfit}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{)}\PY{p}{,} \PY{n}{pT\PYZus{}4to6}\PY{p}{[}\PY{l+m+mi}{8}\PY{p}{:}\PY{l+m+mi}{28}\PY{p}{,}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}
            \PY{n}{tr81to00\PYZus{}cT\PYZus{}4to6}\PY{p}{[}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{polyfit}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{)}\PY{p}{,} \PY{n}{cT\PYZus{}4to6}\PY{p}{[}\PY{l+m+mi}{10}\PY{p}{:}\PY{l+m+mi}{30}\PY{p}{,}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}    
            
            \PY{n}{tr00to17\PYZus{}pT\PYZus{}4to6}\PY{p}{[}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{polyfit}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,} \PY{n}{pT\PYZus{}4to6}\PY{p}{[}\PY{l+m+mi}{28}\PY{p}{:}\PY{l+m+mi}{38}\PY{p}{,}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}
            \PY{n}{tr00to17\PYZus{}cT\PYZus{}4to6}\PY{p}{[}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{polyfit}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,} \PY{n}{cT\PYZus{}4to6}\PY{p}{[}\PY{l+m+mi}{30}\PY{p}{:}\PY{l+m+mi}{40}\PY{p}{,}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}
        
            \PY{n}{tr81to17\PYZus{}pT\PYZus{}4to6}\PY{p}{[}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{polyfit}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{30}\PY{p}{)}\PY{p}{,} \PY{n}{pT\PYZus{}4to6}\PY{p}{[}\PY{l+m+mi}{8}\PY{p}{:}\PY{l+m+mi}{38}\PY{p}{,}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}
            \PY{n}{tr81to17\PYZus{}cT\PYZus{}4to6}\PY{p}{[}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{polyfit}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{30}\PY{p}{)}\PY{p}{,} \PY{n}{cT\PYZus{}4to6}\PY{p}{[}\PY{l+m+mi}{10}\PY{p}{:}\PY{l+m+mi}{40}\PY{p}{,}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}
        
        \PY{c+c1}{\PYZsh{}Cp=3985 J/kg/K}
        \PY{c+c1}{\PYZsh{}dT/dt*Cp = J/s/kg*rho\PYZus{}0 = J/s/m3 *layer thickness?}
        \PY{n}{s\PYZus{}yr}\PY{o}{=}\PY{l+m+mi}{365}\PY{o}{*}\PY{l+m+mi}{24}\PY{o}{*}\PY{l+m+mi}{60}\PY{o}{*}\PY{l+m+mi}{60}
        \PY{n}{Cp}\PY{o}{=}\PY{l+m+mi}{3985}
        \PY{n}{rho0}\PY{o}{=}\PY{l+m+mi}{1034}
        \PY{c+c1}{\PYZsh{}print s\PYZus{}yr}
        \PY{c+c1}{\PYZsh{}print np.ma.sum(dzt[33:43,500,500],axis=0)}
        \PY{c+c1}{\PYZsh{}print np.ma.sum(dzt[43:50,500,500],axis=0)}
        \PY{c+c1}{\PYZsh{}print pert.temp[0,43:50,500,500].load()}
        \PY{c+c1}{\PYZsh{}print dzt[43:50,500,500]}
        
        \PY{c+c1}{\PYZsh{}W/m2=K/yr*yr/s*J/kg/K*kg/m3*m}
        \PY{c+c1}{\PYZsh{}J/s/m2=W/m2}
        \PY{c+c1}{\PYZsh{}old way ... bad vertical averaging?}
        \PY{c+c1}{\PYZsh{}tr81to00\PYZus{}pT\PYZus{}2to4\PYZus{}wm2=tr81to00\PYZus{}pT\PYZus{}2to4/s\PYZus{}yr*Cp*1034*np.ma.sum(dzt[33:43,0:500,:],axis=0)}
        \PY{c+c1}{\PYZsh{}tr81to00\PYZus{}cT\PYZus{}2to4\PYZus{}wm2=tr81to00\PYZus{}cT\PYZus{}2to4/s\PYZus{}yr*Cp*1034*np.ma.sum(dzt[33:43,0:500,:],axis=0)}
        \PY{c+c1}{\PYZsh{}tr00to17\PYZus{}pT\PYZus{}2to4\PYZus{}wm2=tr81to00\PYZus{}pT\PYZus{}2to4/s\PYZus{}yr*Cp*1034*np.ma.sum(dzt[33:43,0:500,:],axis=0)}
        \PY{c+c1}{\PYZsh{}tr00to17\PYZus{}cT\PYZus{}2to4\PYZus{}wm2=tr81to00\PYZus{}cT\PYZus{}2to4/s\PYZus{}yr*Cp*1034*np.ma.sum(dzt[33:43,0:500,:],axis=0)}
        \PY{c+c1}{\PYZsh{}tr81to17\PYZus{}pT\PYZus{}2to4\PYZus{}wm2=tr81to00\PYZus{}pT\PYZus{}2to4/s\PYZus{}yr*Cp*1034*np.ma.sum(dzt[33:43,0:500,:],axis=0)}
        \PY{c+c1}{\PYZsh{}tr81to17\PYZus{}cT\PYZus{}2to4\PYZus{}wm2=tr81to00\PYZus{}cT\PYZus{}2to4/s\PYZus{}yr*Cp*1034*np.ma.sum(dzt[33:43,0:500,:],axis=0)}
        
        \PY{c+c1}{\PYZsh{}tr81to00\PYZus{}pT\PYZus{}4to6\PYZus{}wm2=tr81to00\PYZus{}pT\PYZus{}4to6/s\PYZus{}yr*Cp*1034*np.ma.sum(dzt[43:50,0:500,:],axis=0)}
        \PY{c+c1}{\PYZsh{}tr81to00\PYZus{}cT\PYZus{}4to6\PYZus{}wm2=tr81to00\PYZus{}cT\PYZus{}4to6/s\PYZus{}yr*Cp*1034*np.ma.sum(dzt[43:50,0:500,:],axis=0)}
        \PY{c+c1}{\PYZsh{}tr00to17\PYZus{}pT\PYZus{}4to6\PYZus{}wm2=tr81to00\PYZus{}pT\PYZus{}4to6/s\PYZus{}yr*Cp*1034*np.ma.sum(dzt[43:50,0:500,:],axis=0)}
        \PY{c+c1}{\PYZsh{}tr00to17\PYZus{}cT\PYZus{}4to6\PYZus{}wm2=tr81to00\PYZus{}cT\PYZus{}4to6/s\PYZus{}yr*Cp*1034*np.ma.sum(dzt[43:50,0:500,:],axis=0)}
        \PY{c+c1}{\PYZsh{}tr81to17\PYZus{}pT\PYZus{}4to6\PYZus{}wm2=tr81to00\PYZus{}pT\PYZus{}4to6/s\PYZus{}yr*Cp*1034*np.ma.sum(dzt[43:50,0:500,:],axis=0)}
        \PY{c+c1}{\PYZsh{}tr81to17\PYZus{}cT\PYZus{}4to6\PYZus{}wm2=tr81to00\PYZus{}cT\PYZus{}4to6/s\PYZus{}yr*Cp*1034*np.ma.sum(dzt[43:50,0:500,:],axis=0)}
        
        \PY{c+c1}{\PYZsh{}print tr81to00\PYZus{}pT\PYZus{}2to4\PYZus{}wm2.shape}
            
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[1981 1982 1983 1984 1985 1986 1987 1988 1989 1990 1991 1992 1993 1994 1995
 1996 1997 1998 1999 2000]
[1981 1982 1983 1984 1985 1986 1987 1988 1989 1990 1991 1992 1993 1994 1995
 1996 1997 1998 1999 2000]
[2001 2002 2003 2004 2005 2006 2007 2008 2009 2010]
[2001 2002 2003 2004 2005 2006 2007 2008 2009 2010]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{c+c1}{\PYZsh{}calc W/m2= J/s/m2 = J/m2/yr (trend) / s\PYZus{}yr}
         \PY{n}{cyrs}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1971}\PY{p}{,}\PY{l+m+mi}{2017}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{pyrs}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1973}\PY{p}{,}\PY{l+m+mi}{2017}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}calc linear trend in C/s since 1981\PYZhy{}2000 (8 years from 1973) }
         \PY{k}{print} \PY{n}{cyrs}\PY{p}{[}\PY{l+m+mi}{10}\PY{p}{:}\PY{l+m+mi}{30}\PY{p}{]}
         \PY{k}{print} \PY{n}{pyrs}\PY{p}{[}\PY{l+m+mi}{8}\PY{p}{:}\PY{l+m+mi}{28}\PY{p}{]}
         
         \PY{k}{print} \PY{n}{cyrs}\PY{p}{[}\PY{l+m+mi}{30}\PY{p}{:}\PY{l+m+mi}{40}\PY{p}{]}
         \PY{k}{print} \PY{n}{pyrs}\PY{p}{[}\PY{l+m+mi}{28}\PY{p}{:}\PY{l+m+mi}{38}\PY{p}{]}
         
         \PY{n}{tr81to00\PYZus{}pT\PYZus{}2to4\PYZus{}wm2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{500}\PY{p}{,}\PY{l+m+mi}{1440}\PY{p}{)}\PY{p}{)}
         \PY{n}{tr81to00\PYZus{}cT\PYZus{}2to4\PYZus{}wm2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{500}\PY{p}{,}\PY{l+m+mi}{1440}\PY{p}{)}\PY{p}{)}
         \PY{n}{tr81to00\PYZus{}pT\PYZus{}4to6\PYZus{}wm2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{500}\PY{p}{,}\PY{l+m+mi}{1440}\PY{p}{)}\PY{p}{)}
         \PY{n}{tr81to00\PYZus{}cT\PYZus{}4to6\PYZus{}wm2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{500}\PY{p}{,}\PY{l+m+mi}{1440}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{tr00to17\PYZus{}pT\PYZus{}2to4\PYZus{}wm2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{500}\PY{p}{,}\PY{l+m+mi}{1440}\PY{p}{)}\PY{p}{)}
         \PY{n}{tr00to17\PYZus{}cT\PYZus{}2to4\PYZus{}wm2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{500}\PY{p}{,}\PY{l+m+mi}{1440}\PY{p}{)}\PY{p}{)}
         \PY{n}{tr00to17\PYZus{}pT\PYZus{}4to6\PYZus{}wm2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{500}\PY{p}{,}\PY{l+m+mi}{1440}\PY{p}{)}\PY{p}{)}
         \PY{n}{tr00to17\PYZus{}cT\PYZus{}4to6\PYZus{}wm2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{500}\PY{p}{,}\PY{l+m+mi}{1440}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{tr81to17\PYZus{}pT\PYZus{}2to4\PYZus{}wm2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{500}\PY{p}{,}\PY{l+m+mi}{1440}\PY{p}{)}\PY{p}{)}
         \PY{n}{tr81to17\PYZus{}cT\PYZus{}2to4\PYZus{}wm2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{500}\PY{p}{,}\PY{l+m+mi}{1440}\PY{p}{)}\PY{p}{)}
         \PY{n}{tr81to17\PYZus{}pT\PYZus{}4to6\PYZus{}wm2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{500}\PY{p}{,}\PY{l+m+mi}{1440}\PY{p}{)}\PY{p}{)}
         \PY{n}{tr81to17\PYZus{}cT\PYZus{}4to6\PYZus{}wm2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{zeros}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{500}\PY{p}{,}\PY{l+m+mi}{1440}\PY{p}{)}\PY{p}{)}
         
         
         \PY{k}{for} \PY{n}{j} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{500}\PY{p}{)}\PY{p}{:}
             \PY{c+c1}{\PYZsh{}print j}
             
             \PY{n}{tr81to00\PYZus{}pT\PYZus{}2to4\PYZus{}wm2}\PY{p}{[}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{polyfit}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{)}\PY{p}{,} \PY{n}{pT\PYZus{}2to4\PYZus{}jm2}\PY{p}{[}\PY{l+m+mi}{8}\PY{p}{:}\PY{l+m+mi}{28}\PY{p}{,}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}
             \PY{n}{tr81to00\PYZus{}cT\PYZus{}2to4\PYZus{}wm2}\PY{p}{[}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{polyfit}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{)}\PY{p}{,} \PY{n}{cT\PYZus{}2to4\PYZus{}jm2}\PY{p}{[}\PY{l+m+mi}{10}\PY{p}{:}\PY{l+m+mi}{30}\PY{p}{,}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}
             
             \PY{n}{tr00to17\PYZus{}pT\PYZus{}2to4\PYZus{}wm2}\PY{p}{[}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{polyfit}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,} \PY{n}{pT\PYZus{}2to4\PYZus{}jm2}\PY{p}{[}\PY{l+m+mi}{28}\PY{p}{:}\PY{l+m+mi}{38}\PY{p}{,}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}
             \PY{n}{tr00to17\PYZus{}cT\PYZus{}2to4\PYZus{}wm2}\PY{p}{[}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{polyfit}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,} \PY{n}{cT\PYZus{}2to4\PYZus{}jm2}\PY{p}{[}\PY{l+m+mi}{30}\PY{p}{:}\PY{l+m+mi}{40}\PY{p}{,}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}
             
             \PY{n}{tr81to17\PYZus{}pT\PYZus{}2to4\PYZus{}wm2}\PY{p}{[}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{polyfit}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{30}\PY{p}{)}\PY{p}{,} \PY{n}{pT\PYZus{}2to4\PYZus{}jm2}\PY{p}{[}\PY{l+m+mi}{8}\PY{p}{:}\PY{l+m+mi}{38}\PY{p}{,}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}
             \PY{n}{tr81to17\PYZus{}cT\PYZus{}2to4\PYZus{}wm2}\PY{p}{[}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{polyfit}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{30}\PY{p}{)}\PY{p}{,} \PY{n}{cT\PYZus{}2to4\PYZus{}jm2}\PY{p}{[}\PY{l+m+mi}{10}\PY{p}{:}\PY{l+m+mi}{40}\PY{p}{,}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         
             \PY{n}{tr81to00\PYZus{}pT\PYZus{}4to6\PYZus{}wm2}\PY{p}{[}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{polyfit}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{)}\PY{p}{,} \PY{n}{pT\PYZus{}4to6\PYZus{}jm2}\PY{p}{[}\PY{l+m+mi}{8}\PY{p}{:}\PY{l+m+mi}{28}\PY{p}{,}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}
             \PY{n}{tr81to00\PYZus{}cT\PYZus{}4to6\PYZus{}wm2}\PY{p}{[}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{polyfit}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{)}\PY{p}{,} \PY{n}{cT\PYZus{}4to6\PYZus{}jm2}\PY{p}{[}\PY{l+m+mi}{10}\PY{p}{:}\PY{l+m+mi}{30}\PY{p}{,}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}    
             
             \PY{n}{tr00to17\PYZus{}pT\PYZus{}4to6\PYZus{}wm2}\PY{p}{[}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{polyfit}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,} \PY{n}{pT\PYZus{}4to6\PYZus{}jm2}\PY{p}{[}\PY{l+m+mi}{28}\PY{p}{:}\PY{l+m+mi}{38}\PY{p}{,}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}
             \PY{n}{tr00to17\PYZus{}cT\PYZus{}4to6\PYZus{}wm2}\PY{p}{[}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{polyfit}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,} \PY{n}{cT\PYZus{}4to6\PYZus{}jm2}\PY{p}{[}\PY{l+m+mi}{30}\PY{p}{:}\PY{l+m+mi}{40}\PY{p}{,}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         
             \PY{n}{tr81to17\PYZus{}pT\PYZus{}4to6\PYZus{}wm2}\PY{p}{[}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{polyfit}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{30}\PY{p}{)}\PY{p}{,} \PY{n}{pT\PYZus{}4to6\PYZus{}jm2}\PY{p}{[}\PY{l+m+mi}{8}\PY{p}{:}\PY{l+m+mi}{38}\PY{p}{,}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}
             \PY{n}{tr81to17\PYZus{}cT\PYZus{}4to6\PYZus{}wm2}\PY{p}{[}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{polyfit}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{30}\PY{p}{)}\PY{p}{,} \PY{n}{cT\PYZus{}4to6\PYZus{}jm2}\PY{p}{[}\PY{l+m+mi}{10}\PY{p}{:}\PY{l+m+mi}{40}\PY{p}{,}\PY{n}{j}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         
         \PY{c+c1}{\PYZsh{}Cp=3985 J/kg/K}
         \PY{c+c1}{\PYZsh{}dT/dt*Cp = J/s/kg*rho\PYZus{}0 = J/s/m3 *layer thickness?}
         \PY{n}{s\PYZus{}yr}\PY{o}{=}\PY{l+m+mi}{365}\PY{o}{*}\PY{l+m+mi}{24}\PY{o}{*}\PY{l+m+mi}{60}\PY{o}{*}\PY{l+m+mi}{60}
         
         \PY{c+c1}{\PYZsh{}W/m2=K/yr*yr/s*J/kg/K*kg/m3*m}
         \PY{c+c1}{\PYZsh{}J/s/m2=W/m2}
         \PY{n}{tr81to00\PYZus{}pT\PYZus{}2to4\PYZus{}wm2}\PY{o}{=}\PY{n}{tr81to00\PYZus{}pT\PYZus{}2to4\PYZus{}wm2}\PY{o}{/}\PY{n}{s\PYZus{}yr}
         \PY{n}{tr81to00\PYZus{}cT\PYZus{}2to4\PYZus{}wm2}\PY{o}{=}\PY{n}{tr81to00\PYZus{}cT\PYZus{}2to4\PYZus{}wm2}\PY{o}{/}\PY{n}{s\PYZus{}yr}
         \PY{n}{tr00to17\PYZus{}pT\PYZus{}2to4\PYZus{}wm2}\PY{o}{=}\PY{n}{tr81to00\PYZus{}pT\PYZus{}2to4\PYZus{}wm2}\PY{o}{/}\PY{n}{s\PYZus{}yr}
         \PY{n}{tr00to17\PYZus{}cT\PYZus{}2to4\PYZus{}wm2}\PY{o}{=}\PY{n}{tr81to00\PYZus{}cT\PYZus{}2to4\PYZus{}wm2}\PY{o}{/}\PY{n}{s\PYZus{}yr}
         \PY{n}{tr81to17\PYZus{}pT\PYZus{}2to4\PYZus{}wm2}\PY{o}{=}\PY{n}{tr81to00\PYZus{}pT\PYZus{}2to4\PYZus{}wm2}\PY{o}{/}\PY{n}{s\PYZus{}yr}
         \PY{n}{tr81to17\PYZus{}cT\PYZus{}2to4\PYZus{}wm2}\PY{o}{=}\PY{n}{tr81to00\PYZus{}cT\PYZus{}2to4\PYZus{}wm2}\PY{o}{/}\PY{n}{s\PYZus{}yr}
         
         \PY{n}{tr81to00\PYZus{}pT\PYZus{}4to6\PYZus{}wm2}\PY{o}{=}\PY{n}{tr81to00\PYZus{}pT\PYZus{}4to6\PYZus{}wm2}\PY{o}{/}\PY{n}{s\PYZus{}yr}
         \PY{n}{tr81to00\PYZus{}cT\PYZus{}4to6\PYZus{}wm2}\PY{o}{=}\PY{n}{tr81to00\PYZus{}cT\PYZus{}4to6\PYZus{}wm2}\PY{o}{/}\PY{n}{s\PYZus{}yr}
         \PY{n}{tr00to17\PYZus{}pT\PYZus{}4to6\PYZus{}wm2}\PY{o}{=}\PY{n}{tr81to00\PYZus{}pT\PYZus{}4to6\PYZus{}wm2}\PY{o}{/}\PY{n}{s\PYZus{}yr}
         \PY{n}{tr00to17\PYZus{}cT\PYZus{}4to6\PYZus{}wm2}\PY{o}{=}\PY{n}{tr81to00\PYZus{}cT\PYZus{}4to6\PYZus{}wm2}\PY{o}{/}\PY{n}{s\PYZus{}yr}
         \PY{n}{tr81to17\PYZus{}pT\PYZus{}4to6\PYZus{}wm2}\PY{o}{=}\PY{n}{tr81to00\PYZus{}pT\PYZus{}4to6\PYZus{}wm2}\PY{o}{/}\PY{n}{s\PYZus{}yr}
         \PY{n}{tr81to17\PYZus{}cT\PYZus{}4to6\PYZus{}wm2}\PY{o}{=}\PY{n}{tr81to00\PYZus{}cT\PYZus{}4to6\PYZus{}wm2}\PY{o}{/}\PY{n}{s\PYZus{}yr}
         
         \PY{k}{print} \PY{n}{tr81to00\PYZus{}pT\PYZus{}2to4\PYZus{}wm2}\PY{o}{.}\PY{n}{shape}
             
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[1981 1982 1983 1984 1985 1986 1987 1988 1989 1990 1991 1992 1993 1994 1995
 1996 1997 1998 1999 2000]
[1981 1982 1983 1984 1985 1986 1987 1988 1989 1990 1991 1992 1993 1994 1995
 1996 1997 1998 1999 2000]
[2001 2002 2003 2004 2005 2006 2007 2008 2009 2010]
[2001 2002 2003 2004 2005 2006 2007 2008 2009 2010]
(500, 1440)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{k}{print} \PY{n}{yt\PYZus{}ocean}\PY{p}{[}\PY{l+m+mi}{500}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
0.6249892909

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{c+c1}{\PYZsh{}plot dT/dt K/yr heating trend}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{12.5}\PY{p}{,}\PY{l+m+mf}{9.5}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.suptitle(\PYZsq{}(1991\PYZhy{}2000)\PYZhy{}(1981\PYZhy{}1990) Decadal Temp Anom\PYZsq{})}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{o}{.}\PY{l+m+mo}{01}\PY{p}{,}\PY{o}{.}\PY{l+m+mo}{01}\PY{p}{,}\PY{o}{.}\PY{l+m+mo}{001}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}print clev}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
         \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)} 
         \PY{c+c1}{\PYZsh{}cntrl starts 1971, pert in 1973.}
         \PY{c+c1}{\PYZsh{}cntrl Tdim ends in 1980, normal starts 1981}
         \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{tr81to00\PYZus{}pT\PYZus{}2to4}\PY{o}{\PYZhy{}}\PY{n}{tr81to00\PYZus{}cT\PYZus{}2to4}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C/yr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}clev3 = np.arange(1000,5001,1000)}
         \PY{c+c1}{\PYZsh{}map.contour(X,Y,ht[0:500,:],levels=clev3,colors=\PYZsq{}k\PYZsq{},linewidths=1)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1981\PYZhy{}2000 2000\PYZhy{}4000m }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}ax3 = plt.axes([0.99,0.68,0.015,0.25])}
         \PY{c+c1}{\PYZsh{}cb = plt.colorbar(p1,cax=ax3,orientation=\PYZsq{}vertical\PYZsq{})}
         \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
         \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}\PYZdl{}W/m\PYZca{}2\PYZdl{}\PYZsq{})}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{o}{.}\PY{l+m+mo}{01}\PY{p}{,}\PY{o}{.}\PY{l+m+mo}{01}\PY{p}{,}\PY{o}{.}\PY{l+m+mo}{001}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
         \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)} 
         \PY{c+c1}{\PYZsh{}cntrl starts 1971, pert in 1973.}
         \PY{c+c1}{\PYZsh{}cntrl Tdim ends in 1980, normal starts 1981}
         \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{tr81to00\PYZus{}pT\PYZus{}4to6}\PY{o}{\PYZhy{}}\PY{n}{tr81to00\PYZus{}cT\PYZus{}4to6}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C/yr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}C\PYZsq{})}
         \PY{c+c1}{\PYZsh{}clev3 = np.arange(1000,5001,1000)}
         \PY{c+c1}{\PYZsh{}map.contour(X,Y,ht[0:500,:],levels=clev3,colors=\PYZsq{}k\PYZsq{},linewidths=1)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1981\PYZhy{}2000 4000\PYZhy{}5500m}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{o}{.}\PY{l+m+mo}{01}\PY{p}{,}\PY{o}{.}\PY{l+m+mo}{01}\PY{p}{,}\PY{o}{.}\PY{l+m+mo}{001}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}print clev}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}
         \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
         \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)} 
         \PY{c+c1}{\PYZsh{}cntrl starts 1971, pert in 1973.}
         \PY{c+c1}{\PYZsh{}cntrl Tdim ends in 1980, normal starts 1981}
         \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{tr00to17\PYZus{}pT\PYZus{}2to4}\PY{o}{\PYZhy{}}\PY{n}{tr00to17\PYZus{}cT\PYZus{}2to4}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C/yr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}clev3 = np.arange(1000,5001,1000)}
         \PY{c+c1}{\PYZsh{}map.contour(X,Y,ht[0:500,:],levels=clev3,colors=\PYZsq{}k\PYZsq{},linewidths=1)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2001\PYZhy{}2010 2000\PYZhy{}4000m }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}ax3 = plt.axes([0.99,0.68,0.015,0.25])}
         \PY{c+c1}{\PYZsh{}cb = plt.colorbar(p1,cax=ax3,orientation=\PYZsq{}vertical\PYZsq{})}
         \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
         \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}\PYZdl{}W/m\PYZca{}2\PYZdl{}\PYZsq{})}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{o}{.}\PY{l+m+mo}{01}\PY{p}{,}\PY{o}{.}\PY{l+m+mo}{01}\PY{p}{,}\PY{o}{.}\PY{l+m+mo}{001}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{)}
         \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
         \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)} 
         \PY{c+c1}{\PYZsh{}cntrl starts 1971, pert in 1973.}
         \PY{c+c1}{\PYZsh{}cntrl Tdim ends in 1980, normal starts 1981}
         \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{tr00to17\PYZus{}pT\PYZus{}4to6}\PY{o}{\PYZhy{}}\PY{n}{tr00to17\PYZus{}cT\PYZus{}4to6}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C/yr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}C\PYZsq{})}
         \PY{c+c1}{\PYZsh{}clev3 = np.arange(1000,5001,1000)}
         \PY{c+c1}{\PYZsh{}map.contour(X,Y,ht[0:500,:],levels=clev3,colors=\PYZsq{}k\PYZsq{},linewidths=1)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2001\PYZhy{}2010 4000\PYZhy{}5500m}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                   
         \PY{c+c1}{\PYZsh{}ax3 = plt.axes([0.99,0.68,0.015,0.25])}
         \PY{c+c1}{\PYZsh{}cb = plt.colorbar(p1,cax=ax3,orientation=\PYZsq{}vertical\PYZsq{})}
         \PY{c+c1}{\PYZsh{}\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
         \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}\PYZdl{}W/m\PYZca{}2\PYZdl{}\PYZsq{})}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
         
         
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Tanom\PYZus{}Trend\PYZus{}XY\PYZus{}Eq.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}ax3 = plt.axes([0.92,0.38,0.015,0.25])}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_78_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{c+c1}{\PYZsh{}plot W/m2 heating trend}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{12.5}\PY{p}{,}\PY{l+m+mf}{9.5}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.suptitle(\PYZsq{}(1991\PYZhy{}2000)\PYZhy{}(1981\PYZhy{}1990) Decadal Temp Anom\PYZsq{})}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{o}{.}\PY{l+m+mo}{01}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}print clev}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
         \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)} 
         \PY{c+c1}{\PYZsh{}cntrl starts 1971, pert in 1973.}
         \PY{c+c1}{\PYZsh{}cntrl Tdim ends in 1980, normal starts 1981}
         \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{tr81to00\PYZus{}pT\PYZus{}2to4\PYZus{}wm2}\PY{o}{\PYZhy{}}\PY{n}{tr81to00\PYZus{}cT\PYZus{}2to4\PYZus{}wm2}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}W/m\PYZca{}2\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}clev3 = np.arange(1000,5001,1000)}
         \PY{c+c1}{\PYZsh{}map.contour(X,Y,ht[0:500,:],levels=clev3,colors=\PYZsq{}k\PYZsq{},linewidths=1)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1981\PYZhy{}2000 2000\PYZhy{}4000m }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}ax3 = plt.axes([0.99,0.68,0.015,0.25])}
         \PY{c+c1}{\PYZsh{}cb = plt.colorbar(p1,cax=ax3,orientation=\PYZsq{}vertical\PYZsq{})}
         \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
         \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}\PYZdl{}W/m\PYZca{}2\PYZdl{}\PYZsq{})}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{o}{.}\PY{l+m+mo}{01}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
         \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)} 
         \PY{c+c1}{\PYZsh{}cntrl starts 1971, pert in 1973.}
         \PY{c+c1}{\PYZsh{}cntrl Tdim ends in 1980, normal starts 1981}
         \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{tr81to00\PYZus{}pT\PYZus{}4to6\PYZus{}wm2}\PY{o}{\PYZhy{}}\PY{n}{tr81to00\PYZus{}cT\PYZus{}4to6\PYZus{}wm2}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}W/m\PYZca{}2\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}C\PYZsq{})}
         \PY{c+c1}{\PYZsh{}clev3 = np.arange(1000,5001,1000)}
         \PY{c+c1}{\PYZsh{}map.contour(X,Y,ht[0:500,:],levels=clev3,colors=\PYZsq{}k\PYZsq{},linewidths=1)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1981\PYZhy{}2000 4000\PYZhy{}5500m}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}
         \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
         \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)} 
         \PY{c+c1}{\PYZsh{}cntrl starts 1971, pert in 1973.}
         \PY{c+c1}{\PYZsh{}cntrl Tdim ends in 1980, normal starts 1981}
         \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{tr00to17\PYZus{}pT\PYZus{}2to4\PYZus{}wm2}\PY{o}{\PYZhy{}}\PY{n}{tr00to17\PYZus{}cT\PYZus{}2to4\PYZus{}wm2}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}W/m\PYZca{}2\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}clev3 = np.arange(1000,5001,1000)}
         \PY{c+c1}{\PYZsh{}map.contour(X,Y,ht[0:500,:],levels=clev3,colors=\PYZsq{}k\PYZsq{},linewidths=1)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2001\PYZhy{}2010 2000\PYZhy{}4000m }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}ax3 = plt.axes([0.99,0.68,0.015,0.25])}
         \PY{c+c1}{\PYZsh{}cb = plt.colorbar(p1,cax=ax3,orientation=\PYZsq{}vertical\PYZsq{})}
         \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
         \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}\PYZdl{}W/m\PYZca{}2\PYZdl{}\PYZsq{})}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{o}{.}\PY{l+m+mo}{01}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{)}
         \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
         \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)} 
         \PY{c+c1}{\PYZsh{}cntrl starts 1971, pert in 1973.}
         \PY{c+c1}{\PYZsh{}cntrl Tdim ends in 1980, normal starts 1981}
         \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{tr00to17\PYZus{}pT\PYZus{}4to6\PYZus{}wm2}\PY{o}{\PYZhy{}}\PY{n}{tr00to17\PYZus{}cT\PYZus{}4to6\PYZus{}wm2}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}W/m\PYZca{}2\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}C\PYZsq{})}
         \PY{c+c1}{\PYZsh{}clev3 = np.arange(1000,5001,1000)}
         \PY{c+c1}{\PYZsh{}map.contour(X,Y,ht[0:500,:],levels=clev3,colors=\PYZsq{}k\PYZsq{},linewidths=1)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2001\PYZhy{}2010 4000\PYZhy{}5500m}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}ax3 = plt.axes([0.99,0.68,0.015,0.25])}
         \PY{c+c1}{\PYZsh{}cb = plt.colorbar(p1,cax=ax3,orientation=\PYZsq{}vertical\PYZsq{})}
         \PY{c+c1}{\PYZsh{}\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
         \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}\PYZdl{}W/m\PYZca{}2\PYZdl{}\PYZsq{})}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Heating\PYZus{}Trend\PYZus{}XY\PYZus{}Eq.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}ax3 = plt.axes([0.92,0.38,0.015,0.25])}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_79_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{c+c1}{\PYZsh{}area integrate the heating trends W/m2 to TW}
         
         \PY{k}{print} \PY{n}{tr81to00\PYZus{}pT\PYZus{}2to4\PYZus{}wm2}\PY{o}{.}\PY{n}{shape}
         \PY{k}{print} \PY{n}{area\PYZus{}t}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{tw\PYZus{}tr81to00\PYZus{}pT\PYZus{}2to4\PYZus{}wm2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{ma}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{tr81to00\PYZus{}pT\PYZus{}2to4\PYZus{}wm2}\PY{o}{*}\PY{n}{area\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)}
         \PY{k}{print} \PY{n}{tw\PYZus{}tr81to00\PYZus{}pT\PYZus{}2to4\PYZus{}wm2}\PY{o}{.}\PY{n}{shape}
         \PY{k}{print} \PY{n}{tw\PYZus{}tr81to00\PYZus{}pT\PYZus{}2to4\PYZus{}wm2}
         
         \PY{n}{tw\PYZus{}tr81to00\PYZus{}cT\PYZus{}2to4\PYZus{}wm2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{ma}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{tr81to00\PYZus{}cT\PYZus{}2to4\PYZus{}wm2}\PY{o}{*}\PY{n}{area\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)}
         \PY{k}{print} \PY{n}{tw\PYZus{}tr81to00\PYZus{}cT\PYZus{}2to4\PYZus{}wm2}\PY{o}{.}\PY{n}{shape}
         \PY{k}{print} \PY{n}{tw\PYZus{}tr81to00\PYZus{}cT\PYZus{}2to4\PYZus{}wm2}
         
         \PY{k}{print} \PY{n}{tw\PYZus{}tr81to00\PYZus{}pT\PYZus{}2to4\PYZus{}wm2}\PY{o}{\PYZhy{}}\PY{n}{tw\PYZus{}tr81to00\PYZus{}cT\PYZus{}2to4\PYZus{}wm2}
         
         \PY{n}{tw\PYZus{}tr81to00\PYZus{}pT\PYZus{}4to6\PYZus{}wm2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{ma}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{tr81to00\PYZus{}pT\PYZus{}4to6\PYZus{}wm2}\PY{o}{*}\PY{n}{area\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)}
         \PY{k}{print} \PY{n}{tw\PYZus{}tr81to00\PYZus{}pT\PYZus{}2to4\PYZus{}wm2}\PY{o}{.}\PY{n}{shape}
         \PY{k}{print} \PY{n}{tw\PYZus{}tr81to00\PYZus{}pT\PYZus{}2to4\PYZus{}wm2}
         
         \PY{n}{tw\PYZus{}tr81to00\PYZus{}cT\PYZus{}4to6\PYZus{}wm2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{ma}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{tr81to00\PYZus{}cT\PYZus{}4to6\PYZus{}wm2}\PY{o}{*}\PY{n}{area\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)}
         \PY{k}{print} \PY{n}{tw\PYZus{}tr81to00\PYZus{}cT\PYZus{}4to6\PYZus{}wm2}\PY{o}{.}\PY{n}{shape}
         \PY{k}{print} \PY{n}{tw\PYZus{}tr81to00\PYZus{}cT\PYZus{}4to6\PYZus{}wm2}
         
         \PY{k}{print} \PY{n}{tw\PYZus{}tr81to00\PYZus{}pT\PYZus{}4to6\PYZus{}wm2}\PY{o}{\PYZhy{}}\PY{n}{tw\PYZus{}tr81to00\PYZus{}cT\PYZus{}4to6\PYZus{}wm2}
         
         \PY{k}{print} \PY{n}{tw\PYZus{}tr81to00\PYZus{}pT\PYZus{}4to6\PYZus{}wm2}\PY{o}{\PYZhy{}}\PY{n}{tw\PYZus{}tr81to00\PYZus{}cT\PYZus{}4to6\PYZus{}wm2} \PY{o}{+} \PY{n}{tw\PYZus{}tr81to00\PYZus{}pT\PYZus{}2to4\PYZus{}wm2}\PY{o}{\PYZhy{}}\PY{n}{tw\PYZus{}tr81to00\PYZus{}cT\PYZus{}2to4\PYZus{}wm2}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(500, 1440)
(1080, 1440)
()
-3.85374520606e+13
()
-4.27141716323e+13
4.17671957168e+12
()
-3.85374520606e+13
()
-1.6562248015e+13
-2.21616691543e+12
1.96055265625e+12

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}27}]:} \PY{c+c1}{\PYZsh{}do salinity now}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}48}]:} \PY{c+c1}{\PYZsh{}store time\PYZhy{}series between 70\PYZhy{}65S and 40W\PYZhy{}15E for hovmoeller}
         \PY{n}{x1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{40}\PY{p}{)}
         \PY{n}{x2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{l+m+mi}{15}\PY{p}{)}
         \PY{n}{x1}\PY{o}{=}\PY{n}{x1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{x2}\PY{o}{=}\PY{n}{x2}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         
         \PY{n}{y1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{70}\PY{p}{)}
         \PY{n}{y2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{63}\PY{p}{)}
         \PY{n}{y1}\PY{o}{=}\PY{n}{y1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{y2}\PY{o}{=}\PY{n}{y2}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{k}{print} \PY{n}{x1}\PY{p}{,} \PY{n}{x2}
         \PY{k}{print} \PY{n}{y1}\PY{p}{,} \PY{n}{y2}
         
         \PY{c+c1}{\PYZsh{}this is inaccurate ... area weight for yt\PYZus{}ocean}
         \PY{n}{cSz}\PY{o}{=}\PY{n}{cntrl}\PY{o}{.}\PY{n}{salt}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{n}{y1}\PY{p}{:}\PY{n}{y2}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
         \PY{n}{cSz2}\PY{o}{=}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{salt}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{n}{y1}\PY{p}{:}\PY{n}{y2}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
         \PY{k}{print} \PY{n}{cSz}\PY{o}{.}\PY{n}{shape}
         \PY{k}{print} \PY{n}{cSz2}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{cSz}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{concatenate}\PY{p}{(}\PY{p}{(}\PY{n}{cSz}\PY{p}{,}\PY{n}{cSz2}\PY{p}{)}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{k}{print} \PY{n}{cSz}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{pSz}\PY{o}{=}\PY{n}{pert}\PY{o}{.}\PY{n}{salt}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{n}{y1}\PY{p}{:}\PY{n}{y2}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
         \PY{k}{print} \PY{n}{pSz}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[959] [1179]
[104] [170]
(9, 50)
(40, 50)
(49, 50)
(40, 50)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}49}]:} \PY{c+c1}{\PYZsh{}plot salt hovmoeller of depth vs time}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{9.5}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         
         \PY{n}{time} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{k}{print} \PY{n}{time}
         \PY{k}{print} \PY{n}{time}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{yrs}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1972}\PY{p}{,}\PY{l+m+mi}{2016}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{k}{print} \PY{n}{cSz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{shape}
         \PY{n}{var1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{expand\PYZus{}dims}\PY{p}{(}\PY{n}{cSz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{k}{print} \PY{n}{var1}\PY{o}{.}\PY{n}{shape}
         \PY{n}{var2} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{concatenate}\PY{p}{(}\PY{p}{(}\PY{n}{var1}\PY{p}{,}\PY{n}{pSz}\PY{p}{)}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{k}{print} \PY{n}{var2}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mf}{34.5}\PY{p}{,}\PY{l+m+mf}{34.6}\PY{p}{,}\PY{o}{.}\PY{l+m+mo}{01}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}print clev}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{211}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{41}\PY{p}{]}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{var2}\PY{o}{.}\PY{n}{T}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sa}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.contour(yu\PYZus{}ocean,potrho,np.mean(cntrl\PYZus{}gmoc[0:4,:,:],axis=0),levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=0.25)}
         \PY{c+c1}{\PYZsh{}plt.contour(yu\PYZus{}ocean,potrho,np.mean(cntrl\PYZus{}gmoc[0:4,:,:],axis=0),levels=[0.0,],colors=\PYZsq{}k\PYZsq{},linewidths=0.5)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1035))}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth (m}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Years}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.xlim([\PYZhy{}75,85])}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{70\PYZhy{}63S and 40W\PYZhy{}15E Salinity}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{o}{.}\PY{l+m+mo}{01}\PY{p}{,}\PY{o}{.}\PY{l+m+mo}{01}\PY{p}{,}\PY{o}{.}\PY{l+m+mo}{001}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}print clev}
         
         \PY{n}{time} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{k}{print} \PY{n}{time}
         \PY{k}{print} \PY{n}{time}\PY{o}{.}\PY{n}{shape}
         \PY{k}{print} \PY{n}{pSz}\PY{o}{.}\PY{n}{shape}
         \PY{n}{a}\PY{o}{=}\PY{n}{pSz}\PY{o}{\PYZhy{}}\PY{n}{cSz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{pSz}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         \PY{k}{print} \PY{n}{a}\PY{o}{.}\PY{n}{shape}
         
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{212}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{40}\PY{p}{]}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{a}\PY{o}{.}\PY{n}{T}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sa}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.contour(yu\PYZus{}ocean,potrho,np.mean(cntrl\PYZus{}gmoc[0:4,:,:],axis=0),levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=0.25)}
         \PY{c+c1}{\PYZsh{}plt.contour(yu\PYZus{}ocean,potrho,np.mean(cntrl\PYZus{}gmoc[0:4,:,:],axis=0),levels=[0.0,],colors=\PYZsq{}k\PYZsq{},linewidths=0.5)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1035))}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth (m}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Years}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.xlim([\PYZhy{}75,85])}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{70\PYZhy{}63S and 40W\PYZhy{}15E Salt Anom}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Weddell\PYZus{}HovS.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[-1  0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19]
(21,)
(50,)
(1, 50)
(41, 50)
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19]
(20,)
(40, 50)
(40, 50)

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_83_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{n}{Ocean\PYZus{}File} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Tdim\PYZus{}output19*/ocean\PYZus{}bgc\PYZus{}carbon*.nc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{k}{print} \PY{n}{Ocean\PYZus{}File}
        \PY{n}{cntrl}\PY{o}{=}\PY{n}{xr}\PY{o}{.}\PY{n}{open\PYZus{}mfdataset}\PY{p}{(}\PY{n}{Ocean\PYZus{}File}\PY{p}{,}\PY{n}{engine}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{netcdf4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{concat\PYZus{}dim}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{decode\PYZus{}times}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
        \PY{k}{print} \PY{n}{cntrl}\PY{o}{.}\PY{n}{o2}\PY{o}{.}\PY{n}{shape}
        
        \PY{n}{Ocean\PYZus{}File} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{output*/ocean\PYZus{}bgc\PYZus{}carbon*.nc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{k}{print} \PY{n}{Ocean\PYZus{}File}
        \PY{n}{cntrl2}\PY{o}{=}\PY{n}{xr}\PY{o}{.}\PY{n}{open\PYZus{}mfdataset}\PY{p}{(}\PY{n}{Ocean\PYZus{}File}\PY{p}{,}\PY{n}{engine}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{netcdf4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{concat\PYZus{}dim}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{decode\PYZus{}times}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
        \PY{k}{print} \PY{n}{cntrl2}\PY{o}{.}\PY{n}{o2}\PY{o}{.}\PY{n}{shape}
        
        
        \PY{n}{Ocean\PYZus{}File} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{output*/ocean\PYZus{}bgc\PYZus{}carbon*.nc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{k}{print} \PY{n}{Ocean\PYZus{}File}
        \PY{n}{pert}\PY{o}{=}\PY{n}{xr}\PY{o}{.}\PY{n}{open\PYZus{}mfdataset}\PY{p}{(}\PY{n}{Ocean\PYZus{}File}\PY{p}{,}\PY{n}{engine}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{netcdf4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{concat\PYZus{}dim}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{decode\PYZus{}times}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
        \PY{k}{print} \PY{n}{pert}\PY{o}{.}\PY{n}{o2}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
/g/data1/v45/pas561/mom/archive/wombat\_jun16z/Tdim\_output19*/ocean\_bgc\_carbon*.nc
(120, 50, 1080, 1440)
/g/data1/v45/pas561/mom/archive/wombat\_jun16z/output*/ocean\_bgc\_carbon*.nc
(480, 50, 1080, 1440)
/g/data1/v45/pas561/mom/archive/wombat\_jun16z\_wp2\_74/output*/ocean\_bgc\_carbon*.nc
(480, 50, 1080, 1440)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{k}{print} \PY{n}{st\PYZus{}ocean}\PY{p}{[}\PY{l+m+mi}{33}\PY{p}{]}
        \PY{k}{print} \PY{n}{st\PYZus{}ocean}\PY{p}{[}\PY{l+m+mi}{42}\PY{p}{]}
        
        \PY{c+c1}{\PYZsh{} do lower cell average between lats 60\PYZhy{}65S}
        \PY{n}{j1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mf}{59.9}\PY{p}{)}
        \PY{n}{j1}\PY{o}{=}\PY{n}{j1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{k}{print} \PY{n}{yt\PYZus{}ocean}\PY{p}{[}\PY{n}{j1}\PY{p}{]}
        
        \PY{n}{i1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{o}{\PYZgt{}}\PY{l+m+mi}{30}\PY{p}{)}
        \PY{n}{i1}\PY{o}{=}\PY{n}{i1}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
        \PY{k}{print} \PY{n}{xt\PYZus{}ocean}\PY{p}{[}\PY{n}{i1}\PY{p}{]}
        
        \PY{n}{tmp1}\PY{o}{=}\PY{n}{cntrl}\PY{o}{.}\PY{n}{o2}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{,}\PY{n}{i1}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
        \PY{n}{tmp2}\PY{o}{=}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{o2}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{,}\PY{n}{i1}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
        
        \PY{n}{cntrlO\PYZus{}60S30E}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{concatenate}\PY{p}{(}\PY{p}{(}\PY{n}{tmp1}\PY{p}{,}\PY{n}{tmp2}\PY{p}{)}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
        \PY{k}{print} \PY{n}{cntrlO\PYZus{}60S30E}\PY{o}{.}\PY{n}{shape}
        
        \PY{n}{pertO\PYZus{}60S30E}\PY{o}{=}\PY{n}{pert}\PY{o}{.}\PY{n}{o2}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{,}\PY{n}{i1}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
        
        \PY{k}{print} \PY{n}{pertO\PYZus{}60S30E}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
2071.25195312
3926.81274414
[-59.95944891]
[ 30.125]
(600, 50, 1, 1)
(480, 50, 1, 1)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cntrlO\PYZus{}60S30E.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{a}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{cntrlO\PYZus{}60S30E}\PY{p}{)}
        
        \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pertO\PYZus{}60S30E.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{a}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{pertO\PYZus{}60S30E}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{}sp.io.savemat(\PYZsq{}/g/data1/v45/pas561/mom/archive/wombat\PYZus{}jun16z\PYZus{}wp2\PYZus{}74/pertO\PYZus{}60S30E.mat\PYZsq{},dict(pertO\PYZus{}60S30E=pertO\PYZus{}60S30E))}
        \PY{n}{np}\PY{o}{.}\PY{n}{savetxt}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/g/data1/v45/pas561/mom/archive/wombat\PYZus{}jun16z\PYZus{}wp2\PYZus{}74/pertO\PYZus{}60S30E.txt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{pertO\PYZus{}60S30E}\PY{p}{,} \PY{n}{fmt}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.3f}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{np}\PY{o}{.}\PY{n}{savetxt}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/g/data1/v45/pas561/mom/archive/wombat\PYZus{}jun16z/cntrlO\PYZus{}60S30E.txt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{cntrlO\PYZus{}60S30E}\PY{p}{,} \PY{n}{fmt}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.3f}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{np}\PY{o}{.}\PY{n}{savetxt}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/g/data1/v45/pas561/mom/archive/wombat\PYZus{}jun16z\PYZus{}wp2\PYZus{}74/st.txt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,} \PY{n}{fmt}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.3f}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]

        ---------------------------------------------------------------------------

        AttributeError                            Traceback (most recent call last)

        <ipython-input-7-f39f6d67eef0> in <module>()
          5 a=np.save(of,pertO\_60S30E)
          6 
    ----> 7 scipy.io.savemat('/g/data1/v45/pas561/mom/archive/wombat\_jun16z\_wp2\_74/pertO\_60S30E.mat',pertO\_60S30E)
    

        AttributeError: 'module' object has no attribute 'io'

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{c+c1}{\PYZsh{} do lower cell average between lats 60\PYZhy{}65S}
         \PY{n}{j1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mf}{59.9}\PY{p}{)}
         \PY{n}{j1}\PY{o}{=}\PY{n}{j1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{k}{print} \PY{n}{yt\PYZus{}ocean}\PY{p}{[}\PY{n}{j1}\PY{p}{]}
         
         \PY{n}{i1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{o}{\PYZgt{}}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{n}{i1}\PY{o}{=}\PY{n}{i1}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         \PY{k}{print} \PY{n}{xt\PYZus{}ocean}\PY{p}{[}\PY{n}{i1}\PY{p}{]}
         
         \PY{n}{tmp1}\PY{o}{=}\PY{n}{cntrl}\PY{o}{.}\PY{n}{o2}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{,}\PY{n}{i1}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
         \PY{n}{tmp2}\PY{o}{=}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{o2}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{,}\PY{n}{i1}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{cntrlO\PYZus{}60S0E}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{concatenate}\PY{p}{(}\PY{p}{(}\PY{n}{tmp1}\PY{p}{,}\PY{n}{tmp2}\PY{p}{)}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{k}{print} \PY{n}{cntrlO\PYZus{}60S0E}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cntrlO\PYZus{}60S0E.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{a}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{cntrlO\PYZus{}60S0E}\PY{p}{)}
         
         \PY{n}{pertO\PYZus{}60S0E}\PY{o}{=}\PY{n}{pert}\PY{o}{.}\PY{n}{o2}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{,}\PY{n}{i1}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
         \PY{k}{print} \PY{n}{pertO\PYZus{}60S0E}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pertO\PYZus{}60S0E.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{a}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{pertO\PYZus{}60S0E}\PY{p}{)}
         
         \PY{n}{np}\PY{o}{.}\PY{n}{savetxt}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/g/data1/v45/pas561/mom/archive/wombat\PYZus{}jun16z\PYZus{}wp2\PYZus{}74/pertO\PYZus{}60S0E.txt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{pertO\PYZus{}60S0E}\PY{p}{,} \PY{n}{fmt}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.3f}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{np}\PY{o}{.}\PY{n}{savetxt}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/g/data1/v45/pas561/mom/archive/wombat\PYZus{}jun16z/cntrlO\PYZus{}60S0E.txt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{cntrlO\PYZus{}60S0E}\PY{p}{,} \PY{n}{fmt}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.3f}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[-59.95944891]
[ 0.125]
(600, 50, 1, 1)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]

        ---------------------------------------------------------------------------

        NameError                                 Traceback (most recent call last)

        <ipython-input-20-d02123ad583d> in <module>()
         15 
         16 of=os.path.join(NYFCntrlDir,'cntrlO\_60S0E.npy')
    ---> 17 a=np.save(of,cntrlO\_60S0E)
         18 
         19 pertO\_60S30E=pert.o2[:,:,j1,i1].load()


        NameError: name 'cntrlO\_60S0E' is not defined

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{c+c1}{\PYZsh{} do lower cell average between lats 60\PYZhy{}65S}
        \PY{n}{j1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mf}{63.9}\PY{p}{)}
        \PY{n}{j1}\PY{o}{=}\PY{n}{j1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{k}{print} \PY{n}{yt\PYZus{}ocean}\PY{p}{[}\PY{n}{j1}\PY{p}{]}
        
        \PY{n}{i1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{o}{\PYZgt{}}\PY{l+m+mi}{0}\PY{p}{)}
        \PY{n}{i1}\PY{o}{=}\PY{n}{i1}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
        \PY{k}{print} \PY{n}{xt\PYZus{}ocean}\PY{p}{[}\PY{n}{i1}\PY{p}{]}
        
        \PY{n}{tmp1}\PY{o}{=}\PY{n}{cntrl}\PY{o}{.}\PY{n}{o2}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{,}\PY{n}{i1}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
        \PY{n}{tmp2}\PY{o}{=}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{o2}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{,}\PY{n}{i1}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
        
        \PY{n}{cntrlO\PYZus{}64S0E}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{concatenate}\PY{p}{(}\PY{p}{(}\PY{n}{tmp1}\PY{p}{,}\PY{n}{tmp2}\PY{p}{)}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
        \PY{k}{print} \PY{n}{cntrlO\PYZus{}64S0E}\PY{o}{.}\PY{n}{shape}
        
        \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cntrlO\PYZus{}64S0E.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{a}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{cntrlO\PYZus{}64S0E}\PY{p}{)}
        \PY{n}{np}\PY{o}{.}\PY{n}{savetxt}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/g/data1/v45/pas561/mom/archive/wombat\PYZus{}jun16z/cntrlO\PYZus{}64S0E.txt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{cntrlO\PYZus{}64S0E}\PY{p}{,} \PY{n}{fmt}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.3f}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{n}{pertO\PYZus{}64S0E}\PY{o}{=}\PY{n}{pert}\PY{o}{.}\PY{n}{o2}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{,}\PY{n}{i1}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
        \PY{k}{print} \PY{n}{pertO\PYZus{}64S0E}\PY{o}{.}\PY{n}{shape}
        
        \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pertO\PYZus{}64S0E.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{a}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{pertO\PYZus{}64S0E}\PY{p}{)}
        \PY{n}{np}\PY{o}{.}\PY{n}{savetxt}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/g/data1/v45/pas561/mom/archive/wombat\PYZus{}jun16z\PYZus{}wp2\PYZus{}74/pertO\PYZus{}64S0E.txt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{pertO\PYZus{}64S0E}\PY{p}{,} \PY{n}{fmt}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}.3f}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[-63.94941072]
[ 0.125]
(600, 50, 1, 1)
(480, 50, 1, 1)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{n}{j1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mf}{63.9}\PY{p}{)}
        \PY{n}{j1}\PY{o}{=}\PY{n}{j1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{k}{print} \PY{n}{yt\PYZus{}ocean}\PY{p}{[}\PY{n}{j1}\PY{p}{]}
        
        \PY{n}{i1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{o}{\PYZgt{}}\PY{l+m+mi}{0}\PY{p}{)}
        \PY{n}{i1}\PY{o}{=}\PY{n}{i1}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
        \PY{k}{print} \PY{n}{xt\PYZus{}ocean}\PY{p}{[}\PY{n}{i1}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[-63.94941072]
[ 0.125]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{12.5}\PY{p}{,}\PY{l+m+mf}{9.5}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{O2 Anomaly 2000m}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{yrs}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1973}\PY{p}{,}\PY{l+m+mi}{2016}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{const}\PY{o}{=}\PY{l+m+mf}{1000.0}\PY{o}{/}\PY{l+m+mi}{1025}
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{,}\PY{o}{.}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{clev3}\PY{o}{=}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{10}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{]}
         \PY{n}{st}\PY{o}{=}\PY{l+m+mi}{33}
         \PY{k}{print} \PY{n}{st\PYZus{}ocean}\PY{p}{[}\PY{n}{st}\PY{p}{]}
         \PY{n}{ii}\PY{o}{=}\PY{l+m+mi}{0}
         
         \PY{n}{t1}\PY{o}{=}\PY{l+m+mi}{0}
         \PY{n}{t2}\PY{o}{=}\PY{l+m+mi}{12}
         \PY{k}{for} \PY{n}{yr} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{40}\PY{p}{)}\PY{p}{:}
             \PY{c+c1}{\PYZsh{}print yr}
         
             \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{8}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{,}\PY{n}{yr}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{35}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
             \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
             \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
             \PY{c+c1}{\PYZsh{}map.drawparallels(np.arange(\PYZhy{}80.,81.,15.))}
             \PY{c+c1}{\PYZsh{}map.drawmeridians(np.arange(\PYZhy{}160.,181.,40.),labels=[True,True,True,True])}
             \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)} 
             
             \PY{k}{if} \PY{n}{yr}\PY{o}{\PYZlt{}}\PY{l+m+mi}{7}\PY{p}{:}
                 \PY{n}{anom}\PY{o}{=}\PY{p}{(}\PY{n}{pert}\PY{o}{.}\PY{n}{o2}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl}\PY{o}{.}\PY{n}{o2}\PY{p}{[}\PY{l+m+mi}{36}\PY{o}{+}\PY{n}{t1}\PY{p}{:}\PY{l+m+mi}{36}\PY{o}{+}\PY{n}{t2}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{o}{*}\PY{n}{const}
                 \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{anom}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
                 \PY{n}{p2}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{anom}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev3}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
             \PY{k}{else}\PY{p}{:}
                 \PY{n}{anom}\PY{o}{=}\PY{p}{(}\PY{n}{pert}\PY{o}{.}\PY{n}{o2}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{o2}\PY{p}{[}\PY{n}{t1}\PY{o}{\PYZhy{}}\PY{l+m+mi}{84}\PY{p}{:}\PY{n}{t2}\PY{o}{\PYZhy{}}\PY{l+m+mi}{84}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{o}{*}\PY{n}{const}
                 \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{anom}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
                 \PY{n}{p2}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{anom}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev3}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
                 
             \PY{n}{t1}\PY{o}{=}\PY{n}{t2}
             \PY{n}{t2}\PY{o}{=}\PY{n}{t2}\PY{o}{+}\PY{l+m+mi}{12}
             \PY{k}{print} \PY{n}{t1}\PY{p}{,}\PY{n}{t2}
             
             \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.5)}
             \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}N/m2\PYZsq{})}
             \PY{c+c1}{\PYZsh{}clev3 = np.arange(0,5000,1000)}
             \PY{c+c1}{\PYZsh{}map.contour(X,Y,ht[0:500,:],levels=clev3,colors=\PYZsq{}k\PYZsq{},linewidths=1)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{n}{yr}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{ax3} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{axes}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.92}\PY{p}{,}\PY{l+m+mf}{0.38}\PY{p}{,}\PY{l+m+mf}{0.015}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{]}\PY{p}{)}
         \PY{n}{cb} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{p1}\PY{p}{,}\PY{n}{cax}\PY{o}{=}\PY{n}{ax3}\PY{p}{,}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}umol/kg\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}temp\PYZus{}1500m.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{O2\PYZus{}2000m.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
2071.25195312

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/matplotlib/contour.py:1180: UserWarning: No contour levels were found within the data range.
  warnings.warn("No contour levels were found"

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
12 24
24 36
36 48
48 60
60 72
72 84
84 96
96 108
108 120
120 132
132 144
144 156
156 168
168 180
180 192
192 204
204 216
216 228
228 240
240 252
252 264
264 276
276 288
288 300
300 312
312 324
324 336
336 348
348 360
360 372
372 384
384 396
396 408
408 420
420 432
432 444
444 456
456 468
468 480
480 492

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_90_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{12.5}\PY{p}{,}\PY{l+m+mf}{9.5}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{O2 Anomaly 4000m}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{yrs}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1973}\PY{p}{,}\PY{l+m+mi}{2016}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{const}\PY{o}{=}\PY{l+m+mf}{1000.0}\PY{o}{/}\PY{l+m+mi}{1025}
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{,}\PY{o}{.}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{clev3}\PY{o}{=}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{10}\PY{p}{,} \PY{o}{\PYZhy{}}\PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{]}
         \PY{n}{st}\PY{o}{=}\PY{l+m+mi}{42}
         \PY{k}{print} \PY{n}{st\PYZus{}ocean}\PY{p}{[}\PY{n}{st}\PY{p}{]}
         \PY{n}{ii}\PY{o}{=}\PY{l+m+mi}{0}
         
         \PY{n}{t1}\PY{o}{=}\PY{l+m+mi}{0}
         \PY{n}{t2}\PY{o}{=}\PY{l+m+mi}{12}
         \PY{k}{for} \PY{n}{yr} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{40}\PY{p}{)}\PY{p}{:}
             \PY{c+c1}{\PYZsh{}print yr}
         
             \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{8}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{,}\PY{n}{yr}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{35}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
             \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
             \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
             \PY{c+c1}{\PYZsh{}map.drawparallels(np.arange(\PYZhy{}80.,81.,15.))}
             \PY{c+c1}{\PYZsh{}map.drawmeridians(np.arange(\PYZhy{}160.,181.,40.),labels=[True,True,True,True])}
             \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)} 
             
             \PY{k}{if} \PY{n}{yr}\PY{o}{\PYZlt{}}\PY{l+m+mi}{7}\PY{p}{:}
                 \PY{n}{anom}\PY{o}{=}\PY{p}{(}\PY{n}{pert}\PY{o}{.}\PY{n}{o2}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl}\PY{o}{.}\PY{n}{o2}\PY{p}{[}\PY{l+m+mi}{36}\PY{o}{+}\PY{n}{t1}\PY{p}{:}\PY{l+m+mi}{36}\PY{o}{+}\PY{n}{t2}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{o}{*}\PY{n}{const}
                 \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{anom}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
                 \PY{n}{p2}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{anom}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev3}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
             \PY{k}{else}\PY{p}{:}
                 \PY{n}{anom}\PY{o}{=}\PY{p}{(}\PY{n}{pert}\PY{o}{.}\PY{n}{o2}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{o2}\PY{p}{[}\PY{n}{t1}\PY{o}{\PYZhy{}}\PY{l+m+mi}{84}\PY{p}{:}\PY{n}{t2}\PY{o}{\PYZhy{}}\PY{l+m+mi}{84}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{o}{*}\PY{n}{const}
                 \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{anom}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
                 \PY{n}{p2}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{anom}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev3}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
                 
             \PY{n}{t1}\PY{o}{=}\PY{n}{t2}
             \PY{n}{t2}\PY{o}{=}\PY{n}{t2}\PY{o}{+}\PY{l+m+mi}{12}
             \PY{k}{print} \PY{n}{t1}\PY{p}{,}\PY{n}{t2}
             
             \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.5)}
             \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}N/m2\PYZsq{})}
             \PY{c+c1}{\PYZsh{}clev3 = np.arange(0,5000,1000)}
             \PY{c+c1}{\PYZsh{}map.contour(X,Y,ht[0:500,:],levels=clev3,colors=\PYZsq{}k\PYZsq{},linewidths=1)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{n}{yr}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{ax3} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{axes}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.92}\PY{p}{,}\PY{l+m+mf}{0.38}\PY{p}{,}\PY{l+m+mf}{0.015}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{]}\PY{p}{)}
         \PY{n}{cb} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{p1}\PY{p}{,}\PY{n}{cax}\PY{o}{=}\PY{n}{ax3}\PY{p}{,}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdl{}umol/kg\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}temp\PYZus{}1500m.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{O2\PYZus{}4000m.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
3926.81274414
12 24
24 36
36 48
48 60
60 72
72 84
84 96
96 108
108 120
120 132
132 144
144 156
156 168
168 180
180 192
192 204
204 216
216 228
228 240
240 252
252 264
264 276
276 288
288 300
300 312
312 324
324 336
336 348
348 360
360 372
372 384
384 396
396 408
408 420
420 432
432 444
444 456
456 468
468 480
480 492

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_91_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{12.5}\PY{p}{,}\PY{l+m+mf}{9.5}\PY{p}{)}\PY{p}{)}
        \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
        
        \PY{n}{const}\PY{o}{=}\PY{l+m+mf}{1000.0}\PY{o}{/}\PY{l+m+mi}{1025}
        \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{,}\PY{o}{.}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{n}{clev3}\PY{o}{=}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{]}
        
        \PY{n}{st}\PY{o}{=}\PY{l+m+mi}{33}
        \PY{k}{print} \PY{n}{st\PYZus{}ocean}\PY{p}{[}\PY{n}{st}\PY{p}{]}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{25}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
        \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)} 
        \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{p}{(}\PY{n}{pert}\PY{o}{.}\PY{n}{o2}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{7}\PY{o}{*}\PY{l+m+mi}{12}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl}\PY{o}{.}\PY{n}{o2}\PY{p}{[}\PY{l+m+mi}{36}\PY{p}{:}\PY{l+m+mi}{36}\PY{o}{+}\PY{l+m+mi}{7}\PY{o}{*}\PY{l+m+mi}{12}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{o}{*}\PY{n}{const}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
        \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.5)}
        \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}C\PYZsq{})}
        \PY{c+c1}{\PYZsh{}clev3 = np.arange(1000,5001,1000)}
        \PY{c+c1}{\PYZsh{}map.contour(X,Y,ht[0:500,:],levels=clev3,colors=\PYZsq{}k\PYZsq{},linewidths=1)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1974\PYZhy{}1980 O2 Anom at 2000m }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{25}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
        \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)} 
        \PY{c+c1}{\PYZsh{}cntrl starts 1971, pert in 1973.}
        \PY{c+c1}{\PYZsh{}cntrl Tdim ends in 1980, normal starts 1981}
        \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{p}{(}\PY{n}{pert}\PY{o}{.}\PY{n}{o2}\PY{p}{[}\PY{l+m+mi}{7}\PY{o}{*}\PY{l+m+mi}{12}\PY{p}{:}\PY{l+m+mi}{7}\PY{o}{*}\PY{l+m+mi}{12}\PY{o}{+}\PY{l+m+mi}{120}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{o2}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{120}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{o}{*}\PY{n}{const}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
        \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.5)}
        \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}C\PYZsq{})}
        \PY{c+c1}{\PYZsh{}clev3 = np.arange(1000,5001,1000)}
        \PY{c+c1}{\PYZsh{}map.contour(X,Y,ht[0:500,:],levels=clev3,colors=\PYZsq{}k\PYZsq{},linewidths=1)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1981\PYZhy{}1990 O2 Anom at 2000m }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}
        \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{25}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
        \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)} 
        \PY{c+c1}{\PYZsh{}cntrl starts 1971, pert in 1973.}
        \PY{c+c1}{\PYZsh{}cntrl Tdim ends in 1980, normal starts 1981}
        \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{p}{(}\PY{n}{pert}\PY{o}{.}\PY{n}{o2}\PY{p}{[}\PY{l+m+mi}{7}\PY{o}{*}\PY{l+m+mi}{12}\PY{o}{+}\PY{l+m+mi}{120}\PY{p}{:}\PY{l+m+mi}{7}\PY{o}{*}\PY{l+m+mi}{12}\PY{o}{+}\PY{l+m+mi}{240}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{o2}\PY{p}{[}\PY{l+m+mi}{120}\PY{p}{:}\PY{l+m+mi}{240}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{o}{*}\PY{n}{const}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
        \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.5)}
        \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}C\PYZsq{})}
        \PY{c+c1}{\PYZsh{}clev3 = np.arange(1000,5001,1000)}
        \PY{c+c1}{\PYZsh{}map.contour(X,Y,ht[0:500,:],levels=clev3,colors=\PYZsq{}k\PYZsq{},linewidths=1)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1991\PYZhy{}2000 O2 Anom at 2000m }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{)}
        \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{25}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
        \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)} 
        \PY{c+c1}{\PYZsh{}cntrl starts 1971, pert in 1973.}
        \PY{c+c1}{\PYZsh{}cntrl Tdim ends in 1980, normal starts 1981}
        \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{p}{(}\PY{n}{pert}\PY{o}{.}\PY{n}{o2}\PY{p}{[}\PY{l+m+mi}{7}\PY{o}{*}\PY{l+m+mi}{12}\PY{o}{+}\PY{l+m+mi}{240}\PY{p}{:}\PY{l+m+mi}{7}\PY{o}{*}\PY{l+m+mi}{12}\PY{o}{+}\PY{l+m+mi}{360}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{o2}\PY{p}{[}\PY{l+m+mi}{120}\PY{p}{:}\PY{l+m+mi}{240}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{o}{*}\PY{n}{const}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
        \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.5)}
        \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}C\PYZsq{})}
        \PY{c+c1}{\PYZsh{}clev3 = np.arange(1000,5001,1000)}
        \PY{c+c1}{\PYZsh{}map.contour(X,Y,ht[0:500,:],levels=clev3,colors=\PYZsq{}k\PYZsq{},linewidths=1)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2001\PYZhy{}2010 O2 Anom at 2000m }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        
        \PY{n}{ax3} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{axes}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.99}\PY{p}{,}\PY{l+m+mf}{0.38}\PY{p}{,}\PY{l+m+mf}{0.015}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{]}\PY{p}{)}
        \PY{n}{cb} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{p1}\PY{p}{,}\PY{n}{cax}\PY{o}{=}\PY{n}{ax3}\PY{p}{,}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
        \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{umol/kg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
        
        \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{O2\PYZus{}2000m\PYZus{}decadal\PYZus{}avg.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
        
        
        \PY{c+c1}{\PYZsh{}ax3 = plt.axes([0.92,0.38,0.015,0.25])}
        \PY{c+c1}{\PYZsh{}cb = plt.colorbar(p1,cax=ax3,orientation=\PYZsq{}vertical\PYZsq{})}
        \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
        \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}C\PYZsq{})}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
2071.25195312

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_92_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{12.5}\PY{p}{,}\PY{l+m+mf}{9.5}\PY{p}{)}\PY{p}{)}
        \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
        
        \PY{n}{const}\PY{o}{=}\PY{l+m+mf}{1000.0}\PY{o}{/}\PY{l+m+mi}{1025}
        \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{,}\PY{o}{.}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{n}{clev3}\PY{o}{=}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{]}
        
        \PY{n}{st}\PY{o}{=}\PY{l+m+mi}{42}
        \PY{k}{print} \PY{n}{st\PYZus{}ocean}\PY{p}{[}\PY{n}{st}\PY{p}{]}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{25}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
        \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)} 
        \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{p}{(}\PY{n}{pert}\PY{o}{.}\PY{n}{o2}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{7}\PY{o}{*}\PY{l+m+mi}{12}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl}\PY{o}{.}\PY{n}{o2}\PY{p}{[}\PY{l+m+mi}{36}\PY{p}{:}\PY{l+m+mi}{36}\PY{o}{+}\PY{l+m+mi}{7}\PY{o}{*}\PY{l+m+mi}{12}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{o}{*}\PY{n}{const}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
        \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.5)}
        \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}C\PYZsq{})}
        \PY{c+c1}{\PYZsh{}clev3 = np.arange(1000,5001,1000)}
        \PY{c+c1}{\PYZsh{}map.contour(X,Y,ht[0:500,:],levels=clev3,colors=\PYZsq{}k\PYZsq{},linewidths=1)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1974\PYZhy{}1980 O2 Anom at 4000m }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{25}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
        \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)} 
        \PY{c+c1}{\PYZsh{}cntrl starts 1971, pert in 1973.}
        \PY{c+c1}{\PYZsh{}cntrl Tdim ends in 1980, normal starts 1981}
        \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{p}{(}\PY{n}{pert}\PY{o}{.}\PY{n}{o2}\PY{p}{[}\PY{l+m+mi}{7}\PY{o}{*}\PY{l+m+mi}{12}\PY{p}{:}\PY{l+m+mi}{7}\PY{o}{*}\PY{l+m+mi}{12}\PY{o}{+}\PY{l+m+mi}{120}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{o2}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{120}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{o}{*}\PY{n}{const}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
        \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.5)}
        \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}C\PYZsq{})}
        \PY{c+c1}{\PYZsh{}clev3 = np.arange(1000,5001,1000)}
        \PY{c+c1}{\PYZsh{}map.contour(X,Y,ht[0:500,:],levels=clev3,colors=\PYZsq{}k\PYZsq{},linewidths=1)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1981\PYZhy{}1990 O2 Anom at 4000m }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}
        \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{25}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
        \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)} 
        \PY{c+c1}{\PYZsh{}cntrl starts 1971, pert in 1973.}
        \PY{c+c1}{\PYZsh{}cntrl Tdim ends in 1980, normal starts 1981}
        \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{p}{(}\PY{n}{pert}\PY{o}{.}\PY{n}{o2}\PY{p}{[}\PY{l+m+mi}{7}\PY{o}{*}\PY{l+m+mi}{12}\PY{o}{+}\PY{l+m+mi}{120}\PY{p}{:}\PY{l+m+mi}{7}\PY{o}{*}\PY{l+m+mi}{12}\PY{o}{+}\PY{l+m+mi}{240}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{o2}\PY{p}{[}\PY{l+m+mi}{120}\PY{p}{:}\PY{l+m+mi}{240}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{o}{*}\PY{n}{const}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
        \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.5)}
        \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}C\PYZsq{})}
        \PY{c+c1}{\PYZsh{}clev3 = np.arange(1000,5001,1000)}
        \PY{c+c1}{\PYZsh{}map.contour(X,Y,ht[0:500,:],levels=clev3,colors=\PYZsq{}k\PYZsq{},linewidths=1)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1991\PYZhy{}2000 O2 Anom at 4000m }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{)}
        \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{25}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
        \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)} 
        \PY{c+c1}{\PYZsh{}cntrl starts 1971, pert in 1973.}
        \PY{c+c1}{\PYZsh{}cntrl Tdim ends in 1980, normal starts 1981}
        \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{p}{(}\PY{n}{pert}\PY{o}{.}\PY{n}{o2}\PY{p}{[}\PY{l+m+mi}{7}\PY{o}{*}\PY{l+m+mi}{12}\PY{o}{+}\PY{l+m+mi}{240}\PY{p}{:}\PY{l+m+mi}{7}\PY{o}{*}\PY{l+m+mi}{12}\PY{o}{+}\PY{l+m+mi}{360}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{o2}\PY{p}{[}\PY{l+m+mi}{120}\PY{p}{:}\PY{l+m+mi}{240}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{o}{*}\PY{n}{const}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
        \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.5)}
        \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}C\PYZsq{})}
        \PY{c+c1}{\PYZsh{}clev3 = np.arange(1000,5001,1000)}
        \PY{c+c1}{\PYZsh{}map.contour(X,Y,ht[0:500,:],levels=clev3,colors=\PYZsq{}k\PYZsq{},linewidths=1)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2001\PYZhy{}2010 O2 Anom at 4000m }\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        
        \PY{n}{ax3} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{axes}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.99}\PY{p}{,}\PY{l+m+mf}{0.38}\PY{p}{,}\PY{l+m+mf}{0.015}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{]}\PY{p}{)}
        \PY{n}{cb} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{p1}\PY{p}{,}\PY{n}{cax}\PY{o}{=}\PY{n}{ax3}\PY{p}{,}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
        \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{umol/kg}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
        
        \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{O2\PYZus{}4000m\PYZus{}decadal\PYZus{}avg.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
        
        
        \PY{c+c1}{\PYZsh{}ax3 = plt.axes([0.92,0.38,0.015,0.25])}
        \PY{c+c1}{\PYZsh{}cb = plt.colorbar(p1,cax=ax3,orientation=\PYZsq{}vertical\PYZsq{})}
        \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
        \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}C\PYZsq{})}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
3926.81274414

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/mpl\_toolkits/basemap/\_\_init\_\_.py:1711: MatplotlibDeprecationWarning: The axesPatch function was deprecated in version 2.1. Use Axes.patch instead.
  if limb is not ax.axesPatch:
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/dask/array/numpy\_compat.py:45: RuntimeWarning: invalid value encountered in divide
  x = np.divide(x1, x2, out)
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/matplotlib/figure.py:1999: UserWarning: This figure includes Axes that are not compatible with tight\_layout, so results might be incorrect.
  warnings.warn("This figure includes Axes that are not compatible "

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_93_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}52}]:} \PY{c+c1}{\PYZsh{}do oxygen Hovmoeller}
         \PY{c+c1}{\PYZsh{}store time\PYZhy{}series between 70\PYZhy{}65S and 40W\PYZhy{}15E for hovmoeller}
         \PY{n}{x1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{40}\PY{p}{)}
         \PY{n}{x2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{l+m+mi}{15}\PY{p}{)}
         \PY{n}{x1}\PY{o}{=}\PY{n}{x1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{x2}\PY{o}{=}\PY{n}{x2}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         
         \PY{n}{y1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{70}\PY{p}{)}
         \PY{n}{y2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{63}\PY{p}{)}
         \PY{n}{y1}\PY{o}{=}\PY{n}{y1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{y2}\PY{o}{=}\PY{n}{y2}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{k}{print} \PY{n}{x1}\PY{p}{,} \PY{n}{x2}
         \PY{k}{print} \PY{n}{y1}\PY{p}{,} \PY{n}{y2}
         
         \PY{c+c1}{\PYZsh{}this is inaccurate ... area weight for yt\PYZus{}ocean}
         \PY{n}{cOz}\PY{o}{=}\PY{n}{cntrl}\PY{o}{.}\PY{n}{o2}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{n}{y1}\PY{p}{:}\PY{n}{y2}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
         \PY{n}{cOz2}\PY{o}{=}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{o2}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{n}{y1}\PY{p}{:}\PY{n}{y2}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
         \PY{k}{print} \PY{n}{cOz}\PY{o}{.}\PY{n}{shape}
         \PY{k}{print} \PY{n}{cOz2}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{cOz}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{concatenate}\PY{p}{(}\PY{p}{(}\PY{n}{cOz}\PY{p}{,}\PY{n}{cOz2}\PY{p}{)}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{k}{print} \PY{n}{cOz}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cOz.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{a}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{cOz}\PY{p}{)}
         
         \PY{n}{pOz}\PY{o}{=}\PY{n}{pert}\PY{o}{.}\PY{n}{o2}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{n}{y1}\PY{p}{:}\PY{n}{y2}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
         \PY{k}{print} \PY{n}{pOz}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pOz.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{a}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{pOz}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[959] [1179]
[104] [170]
(108, 50)
(480, 50)
(588, 50)
(480, 50)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}64}]:} \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cOz.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cOz}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n}{of}\PY{p}{)}
         \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pOz.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{pOz}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n}{of}\PY{p}{)}
         
         \PY{k}{print} \PY{n}{pOz}\PY{o}{.}\PY{n}{shape}
         \PY{k}{print} \PY{n}{cOz}\PY{o}{.}\PY{n}{shape}
         
         
         \PY{c+c1}{\PYZsh{}plot O2 hovmoeller of depth vs time}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{9.5}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         
         \PY{n}{time} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{k}{print} \PY{n}{time}
         \PY{k}{print} \PY{n}{time}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{yrs}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1972}\PY{p}{,}\PY{l+m+mi}{2016}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{k}{print} \PY{n}{cOz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{shape}
         \PY{c+c1}{\PYZsh{}var1=np.expand\PYZus{}dims(cOz[0:12,:], axis=0)}
         \PY{c+c1}{\PYZsh{}print var1.shape}
         \PY{n}{var2} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{concatenate}\PY{p}{(}\PY{p}{(}\PY{n}{cOz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{12}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{pOz}\PY{p}{)}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{k}{print} \PY{n}{var2}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{300}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}print clev}
         
         \PY{n}{mnths}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{492}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{311}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{mnths}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{var2}\PY{o}{.}\PY{n}{T}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mmol/m3}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.contour(yu\PYZus{}ocean,potrho,np.mean(cntrl\PYZus{}gmoc[0:4,:,:],axis=0),levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=0.25)}
         \PY{c+c1}{\PYZsh{}plt.contour(yu\PYZus{}ocean,potrho,np.mean(cntrl\PYZus{}gmoc[0:4,:,:],axis=0),levels=[0.0,],colors=\PYZsq{}k\PYZsq{},linewidths=0.5)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1035))}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth (m}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Years}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.xlim([\PYZhy{}75,85])}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{70\PYZhy{}63S and 40W\PYZhy{}15E O2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{25}\PY{p}{,}\PY{l+m+mi}{25}\PY{p}{,}\PY{o}{.}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}print clev}
         
         \PY{k}{print} \PY{n}{pOz}\PY{o}{.}\PY{n}{shape}
         \PY{n}{a}\PY{o}{=}\PY{n}{pOz}\PY{o}{\PYZhy{}}\PY{n}{cOz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{pOz}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         \PY{k}{print} \PY{n}{a}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{312}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{mnths}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{480}\PY{p}{]}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{a}\PY{o}{.}\PY{n}{T}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mmol/m3}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.contour(yu\PYZus{}ocean,potrho,np.mean(cntrl\PYZus{}gmoc[0:4,:,:],axis=0),levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=0.25)}
         \PY{c+c1}{\PYZsh{}plt.contour(yu\PYZus{}ocean,potrho,np.mean(cntrl\PYZus{}gmoc[0:4,:,:],axis=0),levels=[0.0,],colors=\PYZsq{}k\PYZsq{},linewidths=0.5)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1035))}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth (m}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Months}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.xlim([\PYZhy{}75,85])}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{70\PYZhy{}63S and 40W\PYZhy{}15E O2 Anom}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{,}\PY{o}{.}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}print clev}
         
         \PY{k}{print} \PY{n}{pOz}\PY{o}{.}\PY{n}{shape}
         \PY{n}{a}\PY{o}{=}\PY{p}{(}\PY{n}{pOz}\PY{o}{\PYZhy{}}\PY{n}{cOz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{pOz}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)}\PY{o}{/}\PY{n}{cOz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{pOz}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{100}
         \PY{k}{print} \PY{n}{a}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{313}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{mnths}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{480}\PY{p}{]}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{a}\PY{o}{.}\PY{n}{T}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.contour(yu\PYZus{}ocean,potrho,np.mean(cntrl\PYZus{}gmoc[0:4,:,:],axis=0),levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=0.25)}
         \PY{c+c1}{\PYZsh{}plt.contour(yu\PYZus{}ocean,potrho,np.mean(cntrl\PYZus{}gmoc[0:4,:,:],axis=0),levels=[0.0,],colors=\PYZsq{}k\PYZsq{},linewidths=0.5)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1035))}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth (m}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Months}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.xlim([\PYZhy{}75,85])}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{70\PYZhy{}63S and 40W\PYZhy{}15E O2 }\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{ Change}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Weddell\PYZus{}HovO2.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(480, 50)
(588, 50)
[-1  0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19]
(21,)
(50,)
(492, 50)
(480, 50)
(480, 50)
(480, 50)
(480, 50)

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_95_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}65}]:} \PY{c+c1}{\PYZsh{}do DIC Hovmoeller}
         \PY{c+c1}{\PYZsh{}store time\PYZhy{}series between 70\PYZhy{}65S and 40W\PYZhy{}15E for hovmoeller}
         \PY{n}{x1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{40}\PY{p}{)}
         \PY{n}{x2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{l+m+mi}{15}\PY{p}{)}
         \PY{n}{x1}\PY{o}{=}\PY{n}{x1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{x2}\PY{o}{=}\PY{n}{x2}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         
         \PY{n}{y1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{70}\PY{p}{)}
         \PY{n}{y2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{63}\PY{p}{)}
         \PY{n}{y1}\PY{o}{=}\PY{n}{y1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{y2}\PY{o}{=}\PY{n}{y2}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{k}{print} \PY{n}{x1}\PY{p}{,} \PY{n}{x2}
         \PY{k}{print} \PY{n}{y1}\PY{p}{,} \PY{n}{y2}
         
         \PY{c+c1}{\PYZsh{}this is inaccurate ... area weight for yt\PYZus{}ocean}
         \PY{n}{cDICz}\PY{o}{=}\PY{n}{cntrl}\PY{o}{.}\PY{n}{dic}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{n}{y1}\PY{p}{:}\PY{n}{y2}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
         \PY{n}{cDICz2}\PY{o}{=}\PY{n}{cntrl2}\PY{o}{.}\PY{n}{dic}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{n}{y1}\PY{p}{:}\PY{n}{y2}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
         \PY{k}{print} \PY{n}{cDICz}\PY{o}{.}\PY{n}{shape}
         \PY{k}{print} \PY{n}{cDICz2}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{cDICz}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{concatenate}\PY{p}{(}\PY{p}{(}\PY{n}{cDICz}\PY{p}{,}\PY{n}{cDICz2}\PY{p}{)}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{k}{print} \PY{n}{cDICz}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cDICz.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{a}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{cDICz}\PY{p}{)}
         
         \PY{n}{pDICz}\PY{o}{=}\PY{n}{pert}\PY{o}{.}\PY{n}{dic}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{n}{y1}\PY{p}{:}\PY{n}{y2}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
         \PY{k}{print} \PY{n}{pDICz}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pDICz.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{a}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{pDICz}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[959] [1179]
[104] [170]
(108, 50)
(480, 50)
(588, 50)
(480, 50)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}69}]:} \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cDICz.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cDICz}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n}{of}\PY{p}{)}
         \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pDICz.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{pDICz}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n}{of}\PY{p}{)}
         
         \PY{k}{print} \PY{n}{pDICz}\PY{o}{.}\PY{n}{shape}
         \PY{k}{print} \PY{n}{cDICz}\PY{o}{.}\PY{n}{shape}
         
         
         \PY{c+c1}{\PYZsh{}plot DIC hovmoeller of depth vs time}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{9.5}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         
         \PY{n}{time} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{k}{print} \PY{n}{time}
         \PY{k}{print} \PY{n}{time}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{yrs}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1972}\PY{p}{,}\PY{l+m+mi}{2016}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{k}{print} \PY{n}{cDICz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{shape}
         \PY{c+c1}{\PYZsh{}var1=np.expand\PYZus{}dims(cOz[0:12,:], axis=0)}
         \PY{c+c1}{\PYZsh{}print var1.shape}
         \PY{n}{var2} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{concatenate}\PY{p}{(}\PY{p}{(}\PY{n}{cDICz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{12}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{pDICz}\PY{p}{)}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{k}{print} \PY{n}{var2}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{2100}\PY{p}{,}\PY{l+m+mi}{2300}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}print clev}
         
         \PY{n}{mnths}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{492}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{311}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{mnths}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{var2}\PY{o}{.}\PY{n}{T}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mmol/m3}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.contour(yu\PYZus{}ocean,potrho,np.mean(cntrl\PYZus{}gmoc[0:4,:,:],axis=0),levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=0.25)}
         \PY{c+c1}{\PYZsh{}plt.contour(yu\PYZus{}ocean,potrho,np.mean(cntrl\PYZus{}gmoc[0:4,:,:],axis=0),levels=[0.0,],colors=\PYZsq{}k\PYZsq{},linewidths=0.5)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1035))}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth (m}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Years}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.xlim([\PYZhy{}75,85])}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{70\PYZhy{}63S and 40W\PYZhy{}15E DIC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{,}\PY{o}{.}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}print clev}
         
         \PY{k}{print} \PY{n}{pDICz}\PY{o}{.}\PY{n}{shape}
         \PY{n}{a}\PY{o}{=}\PY{n}{pDICz}\PY{o}{\PYZhy{}}\PY{n}{cDICz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{pDICz}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{p}{:}\PY{p}{]}
         \PY{k}{print} \PY{n}{a}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{312}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{mnths}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{480}\PY{p}{]}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{a}\PY{o}{.}\PY{n}{T}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mmol/m3}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.contour(yu\PYZus{}ocean,potrho,np.mean(cntrl\PYZus{}gmoc[0:4,:,:],axis=0),levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=0.25)}
         \PY{c+c1}{\PYZsh{}plt.contour(yu\PYZus{}ocean,potrho,np.mean(cntrl\PYZus{}gmoc[0:4,:,:],axis=0),levels=[0.0,],colors=\PYZsq{}k\PYZsq{},linewidths=0.5)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1035))}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth (m}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Months}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.xlim([\PYZhy{}75,85])}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{70\PYZhy{}63S and 40W\PYZhy{}15E DIC Anom}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{o}{.}\PY{l+m+mi}{2}\PY{p}{,}\PY{o}{.}\PY{l+m+mi}{2}\PY{p}{,}\PY{o}{.}\PY{l+m+mo}{01}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}print clev}
         
         \PY{k}{print} \PY{n}{pDICz}\PY{o}{.}\PY{n}{shape}
         \PY{n}{a}\PY{o}{=}\PY{p}{(}\PY{n}{pDICz}\PY{o}{\PYZhy{}}\PY{n}{cDICz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{pDICz}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)}\PY{o}{/}\PY{n}{cDICz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{pDICz}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{100}
         \PY{k}{print} \PY{n}{a}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{313}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{mnths}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{480}\PY{p}{]}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{a}\PY{o}{.}\PY{n}{T}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.contour(yu\PYZus{}ocean,potrho,np.mean(cntrl\PYZus{}gmoc[0:4,:,:],axis=0),levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=0.25)}
         \PY{c+c1}{\PYZsh{}plt.contour(yu\PYZus{}ocean,potrho,np.mean(cntrl\PYZus{}gmoc[0:4,:,:],axis=0),levels=[0.0,],colors=\PYZsq{}k\PYZsq{},linewidths=0.5)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1035))}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth (m}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Months}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.xlim([\PYZhy{}75,85])}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{70\PYZhy{}63S and 40W\PYZhy{}15E DIC }\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{ Change}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Weddell\PYZus{}HovDIC.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(480, 50)
(588, 50)
[-1  0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19]
(21,)
(50,)
(492, 50)
(480, 50)
(480, 50)
(480, 50)
(480, 50)

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_97_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}71}]:} \PY{n}{Ocean\PYZus{}File} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Tdim\PYZus{}output197*/ocean\PYZus{}bgc\PYZus{}2d*.nc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{k}{print} \PY{n}{Ocean\PYZus{}File}
         \PY{n}{cntrl}\PY{o}{=}\PY{n}{xr}\PY{o}{.}\PY{n}{open\PYZus{}mfdataset}\PY{p}{(}\PY{n}{Ocean\PYZus{}File}\PY{p}{,}\PY{n}{engine}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{netcdf4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{concat\PYZus{}dim}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{decode\PYZus{}times}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         \PY{k}{print} \PY{n}{cntrl}\PY{o}{.}\PY{n}{stf\PYZus{}dic}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{Ocean\PYZus{}File} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{output*/ocean\PYZus{}bgc\PYZus{}2d*.nc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{k}{print} \PY{n}{Ocean\PYZus{}File}
         \PY{n}{cntrl2}\PY{o}{=}\PY{n}{xr}\PY{o}{.}\PY{n}{open\PYZus{}mfdataset}\PY{p}{(}\PY{n}{Ocean\PYZus{}File}\PY{p}{,}\PY{n}{engine}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{netcdf4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{concat\PYZus{}dim}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{decode\PYZus{}times}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         \PY{k}{print} \PY{n}{cntrl2}\PY{o}{.}\PY{n}{stf\PYZus{}dic}\PY{o}{.}\PY{n}{shape}
         
         
         \PY{n}{Ocean\PYZus{}File} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{output*/ocean\PYZus{}bgc\PYZus{}2d*.nc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{k}{print} \PY{n}{Ocean\PYZus{}File}
         \PY{n}{pert}\PY{o}{=}\PY{n}{xr}\PY{o}{.}\PY{n}{open\PYZus{}mfdataset}\PY{p}{(}\PY{n}{Ocean\PYZus{}File}\PY{p}{,}\PY{n}{engine}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{netcdf4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{concat\PYZus{}dim}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{decode\PYZus{}times}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         \PY{k}{print} \PY{n}{pert}\PY{o}{.}\PY{n}{stf\PYZus{}dic}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
/g/data1/v45/pas561/mom/archive/wombat\_jun16z/Tdim\_output197*/ocean\_bgc\_2d*.nc
(108, 1080, 1440)
/g/data1/v45/pas561/mom/archive/wombat\_jun16z/output*/ocean\_bgc\_2d*.nc
(480, 1080, 1440)
/g/data1/v45/pas561/mom/archive/wombat\_jun16z\_wp2\_74/output*/ocean\_bgc\_2d*.nc
(480, 1080, 1440)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}79}]:} \PY{k}{print} \PY{n}{cntrl}\PY{o}{.}\PY{n}{stf\PYZus{}dic}\PY{o}{.}\PY{n}{shape}
         \PY{k}{print} \PY{n}{pert}\PY{o}{.}\PY{n}{stf\PYZus{}dic}\PY{o}{.}\PY{n}{shape}
         \PY{c+c1}{\PYZsh{}var1=cntrl.stf\PYZus{}dic[:,0:500,:].mean(\PYZsq{}Time\PYZsq{}).load}
         
         \PY{c+c1}{\PYZsh{}plot surface flux of DIC}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{12.5}\PY{p}{,}\PY{l+m+mf}{9.5}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Surface DIC Flux Out of Ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         
         \PY{n}{cyrs}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1971}\PY{p}{,}\PY{l+m+mi}{2017}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{k}{print} \PY{n}{cyrs}\PY{p}{[}\PY{l+m+mi}{10}\PY{p}{:}\PY{l+m+mi}{20}\PY{p}{]}
         \PY{n}{pyrs}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1973}\PY{p}{,}\PY{l+m+mi}{2017}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{k}{print} \PY{n}{pyrs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{8}\PY{p}{]}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{o}{.}\PY{l+m+mo}{00005}\PY{p}{,}\PY{o}{.}\PY{l+m+mo}{00005}\PY{p}{,}\PY{o}{.}\PY{l+m+mo}{000001}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}print clev}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{40}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
         \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)} 
         \PY{c+c1}{\PYZsh{}cntrl starts 1971, pert in 1973.}
         \PY{c+c1}{\PYZsh{}cntrl Tdim ends in 1980, normal starts 1981}
         \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{cntrl}\PY{o}{.}\PY{n}{stf\PYZus{}dic}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mmol/m2/s}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}clev3 = np.arange(1000,5001,1000)}
         \PY{c+c1}{\PYZsh{}map.contour(X,Y,ht[0:500,:],levels=clev3,colors=\PYZsq{}k\PYZsq{},linewidths=1)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Control Flux}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}ax3 = plt.axes([0.99,0.68,0.015,0.25])}
         \PY{c+c1}{\PYZsh{}cb = plt.colorbar(p1,cax=ax3,orientation=\PYZsq{}vertical\PYZsq{})}
         \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
         \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}mmol/m2/s\PYZsq{})}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{300}\PY{p}{,}\PY{l+m+mi}{300}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{var1}\PY{o}{=}\PY{p}{(}\PY{n}{pert}\PY{o}{.}\PY{n}{stf\PYZus{}dic}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{8}\PY{o}{*}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl}\PY{o}{.}\PY{n}{stf\PYZus{}dic}\PY{p}{[}\PY{l+m+mi}{3}\PY{o}{*}\PY{l+m+mi}{12}\PY{p}{:}\PY{l+m+mi}{8}\PY{o}{*}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{o}{/}\PY{n}{cntrl}\PY{o}{.}\PY{n}{stf\PYZus{}dic}\PY{p}{[}\PY{l+m+mi}{3}\PY{o}{*}\PY{l+m+mi}{12}\PY{p}{:}\PY{l+m+mi}{8}\PY{o}{*}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{*}\PY{l+m+mi}{100}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{40}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
         \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)} 
         \PY{c+c1}{\PYZsh{}cntrl starts 1971, pert in 1973.}
         \PY{c+c1}{\PYZsh{}cntrl Tdim ends in 1980, normal starts 1981}
         \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{var1}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}clev3 = np.arange(1000,5001,1000)}
         \PY{c+c1}{\PYZsh{}map.contour(X,Y,ht[0:500,:],levels=clev3,colors=\PYZsq{}k\PYZsq{},linewidths=1)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1973\PYZhy{}1980 Anom}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{STFDICanom\PYZus{}73\PYZhy{}80.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}ax3 = plt.axes([0.92,0.38,0.015,0.25])}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(108, 1080, 1440)
(480, 1080, 1440)
[1981 1982 1983 1984 1985 1986 1987 1988 1989 1990]
[1973 1974 1975 1976 1977 1978 1979 1980]

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_100_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}82}]:} \PY{c+c1}{\PYZsh{}phytoplankton}
         \PY{k}{print} \PY{n}{cntrl}\PY{o}{.}\PY{n}{pprod\PYZus{}gross\PYZus{}2d}\PY{o}{.}\PY{n}{shape}
         \PY{k}{print} \PY{n}{pert}\PY{o}{.}\PY{n}{pprod\PYZus{}gross\PYZus{}2d}\PY{o}{.}\PY{n}{shape}
         \PY{c+c1}{\PYZsh{}var1=cntrl.stf\PYZus{}dic[:,0:500,:].mean(\PYZsq{}Time\PYZsq{}).load}
         
         \PY{c+c1}{\PYZsh{}plot surface flux of DIC}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{12.5}\PY{p}{,}\PY{l+m+mf}{9.5}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth Integrated Primary Production}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         
         \PY{n}{cyrs}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1971}\PY{p}{,}\PY{l+m+mi}{2017}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{k}{print} \PY{n}{cyrs}\PY{p}{[}\PY{l+m+mi}{10}\PY{p}{:}\PY{l+m+mi}{20}\PY{p}{]}
         \PY{n}{pyrs}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1973}\PY{p}{,}\PY{l+m+mi}{2017}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{k}{print} \PY{n}{pyrs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{8}\PY{p}{]}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{o}{.}\PY{l+m+mo}{005}\PY{p}{,}\PY{o}{.}\PY{l+m+mo}{005}\PY{p}{,}\PY{o}{.}\PY{l+m+mo}{0001}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}print clev}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{40}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
         \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)} 
         \PY{c+c1}{\PYZsh{}cntrl starts 1971, pert in 1973.}
         \PY{c+c1}{\PYZsh{}cntrl Tdim ends in 1980, normal starts 1981}
         \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{cntrl}\PY{o}{.}\PY{n}{pprod\PYZus{}gross\PYZus{}2d}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mmolN/m2/s}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}clev3 = np.arange(1000,5001,1000)}
         \PY{c+c1}{\PYZsh{}map.contour(X,Y,ht[0:500,:],levels=clev3,colors=\PYZsq{}k\PYZsq{},linewidths=1)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Control}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}ax3 = plt.axes([0.99,0.68,0.015,0.25])}
         \PY{c+c1}{\PYZsh{}cb = plt.colorbar(p1,cax=ax3,orientation=\PYZsq{}vertical\PYZsq{})}
         \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
         \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}mmol/m2/s\PYZsq{})}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{100}\PY{p}{,}\PY{l+m+mi}{100}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{var1}\PY{o}{=}\PY{p}{(}\PY{n}{pert}\PY{o}{.}\PY{n}{pprod\PYZus{}gross\PYZus{}2d}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{8}\PY{o}{*}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl}\PY{o}{.}\PY{n}{pprod\PYZus{}gross\PYZus{}2d}\PY{p}{[}\PY{l+m+mi}{3}\PY{o}{*}\PY{l+m+mi}{12}\PY{p}{:}\PY{l+m+mi}{8}\PY{o}{*}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{o}{/}\PY{n}{cntrl}\PY{o}{.}\PY{n}{pprod\PYZus{}gross\PYZus{}2d}\PY{p}{[}\PY{l+m+mi}{3}\PY{o}{*}\PY{l+m+mi}{12}\PY{p}{:}\PY{l+m+mi}{8}\PY{o}{*}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{*}\PY{l+m+mi}{100}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{40}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
         \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)} 
         \PY{c+c1}{\PYZsh{}cntrl starts 1971, pert in 1973.}
         \PY{c+c1}{\PYZsh{}cntrl Tdim ends in 1980, normal starts 1981}
         \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{var1}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}clev3 = np.arange(1000,5001,1000)}
         \PY{c+c1}{\PYZsh{}map.contour(X,Y,ht[0:500,:],levels=clev3,colors=\PYZsq{}k\PYZsq{},linewidths=1)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1973\PYZhy{}1980 Anom}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{tight\PYZus{}layout}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{PProdanom\PYZus{}73\PYZhy{}80.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}ax3 = plt.axes([0.92,0.38,0.015,0.25])}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(108, 1080, 1440)
(480, 1080, 1440)
[1981 1982 1983 1984 1985 1986 1987 1988 1989 1990]
[1973 1974 1975 1976 1977 1978 1979 1980]

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_101_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}66}]:} \PY{n}{var2}\PY{o}{=}\PY{n}{cntrl}\PY{o}{.}\PY{n}{pot\PYZus{}rho\PYZus{}0}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{ii}\PY{o}{=}\PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{yr} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{numyrs}\PY{p}{)}\PY{p}{:}
             \PY{c+c1}{\PYZsh{}print yr}
             \PY{n}{var1}\PY{o}{=}\PY{n}{pert}\PY{o}{.}\PY{n}{pot\PYZus{}rho\PYZus{}0}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}print var1.shape, var2.shape}
             
             \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{4}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{,}\PY{n}{yr}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}color}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.25}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{o}{.}\PY{l+m+mo}{01}\PY{p}{,}\PY{o}{.}\PY{l+m+mo}{01}\PY{p}{,}\PY{l+m+mi}{21}\PY{p}{)}
             
             \PY{n}{p1}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{]}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{var1}\PY{o}{\PYZhy{}}\PY{n}{var2}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.7)}
             \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}kg/m3\PYZsq{})}
             \PY{c+c1}{\PYZsh{}plt.contour(yt\PYZus{}ocean[0:500],st\PYZus{}ocean,pert\PYZus{}ztemp\PYZhy{}cntrl\PYZus{}ztemp,levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=0.25)}
             \PY{c+c1}{\PYZsh{}plt.contour(yt\PYZus{}ocean[0:500],st\PYZus{}ocean,pert\PYZus{}ztemp\PYZhy{}cntrl\PYZus{}ztemp,levels=[0.0,],colors=\PYZsq{}k\PYZsq{},linewidths=0.5)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}plt.gca().yaxis.set\PYZus{}major\PYZus{}formatter(x\PYZus{}formatter)}
             \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1034))}
             \PY{c+c1}{\PYZsh{}plt.ylabel(\PYZsq{}Depth (m)\PYZsq{})}
             \PY{c+c1}{\PYZsh{}plt.xlabel(\PYZsq{}Latitude (\PYZdl{}\PYZca{}\PYZbs{}circ\PYZdl{}S)\PYZsq{})}
             \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{50}\PY{p}{]}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{n}{yr}\PY{p}{]}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}plt.title(\PYZsq{}40W to 15E Temp Anomaly 1976\PYZsq{})}
         
         \PY{n}{ax3} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{axes}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.92}\PY{p}{,}\PY{l+m+mf}{0.38}\PY{p}{,}\PY{l+m+mf}{0.015}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{]}\PY{p}{)}
         \PY{n}{cb} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{p1}\PY{p}{,}\PY{n}{cax}\PY{o}{=}\PY{n}{ax3}\PY{p}{,}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{kg/m3}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}plt.subplot(224)}
         \PY{c+c1}{\PYZsh{}plt.gca().patch.set\PYZus{}color(\PYZsq{}.25\PYZsq{})}
         \PY{c+c1}{\PYZsh{}clev = np.arange(\PYZhy{}.5,.51,0.1)}
         \PY{c+c1}{\PYZsh{}plt.contourf(yt\PYZus{}ocean[0:500],st\PYZus{}ocean,np.mean(pert\PYZus{}temp[9,:,:,:],axis=2)\PYZhy{}np.mean(cntrl\PYZus{}temp[:,:,:],axis=2),cmap=plt.cm.PiYG,levels=clev,extend=\PYZsq{}both\PYZsq{})}
         \PY{c+c1}{\PYZsh{}plt.title(\PYZsq{}180W to 180E Temp Anomaly 1982\PYZsq{})}
         
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}zavTanom.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{zavRhoanom.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_102_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}67}]:} \PY{c+c1}{\PYZsh{}store time\PYZhy{}series between 60\PYZhy{}65S at different depths}
         \PY{c+c1}{\PYZsh{}pTz=np.zeros(pert\PYZus{}temp.shape[0],pert\PYZus{}temp.shape[1])}
         \PY{c+c1}{\PYZsh{}cTz=np.zeros(pert\PYZus{}temp.shape[0],pert\PYZus{}temp.shape[1])}
         \PY{c+c1}{\PYZsh{}print pTz.shape}
         
         \PY{n}{x1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{40}\PY{p}{)}
         \PY{n}{x2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{l+m+mi}{15}\PY{p}{)}
         \PY{n}{x1}\PY{o}{=}\PY{n}{x1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{x2}\PY{o}{=}\PY{n}{x2}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         
         \PY{n}{y1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{65}\PY{p}{)}
         \PY{n}{y2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{60}\PY{p}{)}
         \PY{n}{y1}\PY{o}{=}\PY{n}{y1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{y2}\PY{o}{=}\PY{n}{y2}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{k}{print} \PY{n}{x1}\PY{p}{,} \PY{n}{x2}
         \PY{k}{print} \PY{n}{y1}\PY{p}{,} \PY{n}{y2}
         
         \PY{c+c1}{\PYZsh{}cntrl\PYZus{}ztemp=ff.temp[0:5,:,0:500,859:1279].mean(\PYZsq{}time\PYZsq{}).mean(\PYZsq{}xt\PYZus{}ocean\PYZsq{}).load()}
         \PY{c+c1}{\PYZsh{}need to area average this ...}
         \PY{n}{cTz}\PY{o}{=}\PY{n}{cntrl}\PY{o}{.}\PY{n}{pot\PYZus{}rho\PYZus{}0}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{n}{y1}\PY{p}{:}\PY{n}{y2}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
         \PY{k}{print} \PY{n}{cTz}\PY{o}{.}\PY{n}{shape}
         
         \PY{c+c1}{\PYZsh{}pert\PYZus{}ztemp=ff.temp[0:5,:,0:500,859:1279].mean(\PYZsq{}time\PYZsq{}).mean(\PYZsq{}xt\PYZus{}ocean\PYZsq{}).load()}
         \PY{c+c1}{\PYZsh{}print pert\PYZus{}ztemp.shape}
         
         \PY{n}{pTz}\PY{o}{=}\PY{n}{pert}\PY{o}{.}\PY{n}{pot\PYZus{}rho\PYZus{}0}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{n}{y1}\PY{p}{:}\PY{n}{y2}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
         \PY{k}{print} \PY{n}{pTz}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[959] [1179]
[152] [195]
(9, 50)
(13, 50)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}68}]:} \PY{c+c1}{\PYZsh{}plot rho hovmoeller of depth vs time}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{9.5}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         
         \PY{n}{time} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{k}{print} \PY{n}{time}
         \PY{k}{print} \PY{n}{time}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{yrs}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1972}\PY{p}{,}\PY{l+m+mi}{2016}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{k}{print} \PY{n}{cTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{shape}
         \PY{n}{cn1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{expand\PYZus{}dims}\PY{p}{(}\PY{n}{cTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{k}{print} \PY{n}{cn1}\PY{o}{.}\PY{n}{shape}
         \PY{n}{cn} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{concatenate}\PY{p}{(}\PY{p}{(}\PY{n}{cn1}\PY{p}{,}\PY{n}{pTz}\PY{p}{)}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{k}{print} \PY{n}{cn}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mf}{1027.7}\PY{p}{,}\PY{l+m+mf}{1027.8}\PY{p}{,}\PY{l+m+mi}{51}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}print clev}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{211}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{numyrs}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{cn}\PY{o}{.}\PY{n}{T}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{kg/m3}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.contour(yu\PYZus{}ocean,potrho,np.mean(cntrl\PYZus{}gmoc[0:4,:,:],axis=0),levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=0.25)}
         \PY{c+c1}{\PYZsh{}plt.contour(yu\PYZus{}ocean,potrho,np.mean(cntrl\PYZus{}gmoc[0:4,:,:],axis=0),levels=[0.0,],colors=\PYZsq{}k\PYZsq{},linewidths=0.5)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1035))}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth (m}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Years}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.xlim([\PYZhy{}75,85])}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{60\PYZhy{}65S and 40W\PYZhy{}15E Rho}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{o}{.}\PY{l+m+mo}{01}\PY{p}{,}\PY{o}{.}\PY{l+m+mo}{01}\PY{p}{,}\PY{l+m+mi}{21}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}print clev}
         
         \PY{n}{time} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{k}{print} \PY{n}{time}
         \PY{k}{print} \PY{n}{time}\PY{o}{.}\PY{n}{shape}
         \PY{k}{print} \PY{n}{pTz}\PY{o}{.}\PY{n}{shape}
         \PY{n}{a}\PY{o}{=}\PY{n}{pTz}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cTz}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{k}{print} \PY{n}{a}\PY{o}{.}\PY{n}{shape}
         
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{212}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{numyrs}\PY{p}{]}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{a}\PY{o}{.}\PY{n}{T}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{kg/m3}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.contour(yu\PYZus{}ocean,potrho,np.mean(cntrl\PYZus{}gmoc[0:4,:,:],axis=0),levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=0.25)}
         \PY{c+c1}{\PYZsh{}plt.contour(yu\PYZus{}ocean,potrho,np.mean(cntrl\PYZus{}gmoc[0:4,:,:],axis=0),levels=[0.0,],colors=\PYZsq{}k\PYZsq{},linewidths=0.5)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1035))}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth (m}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Years}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.xlim([\PYZhy{}75,85])}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{60\PYZhy{}65S and 40W\PYZhy{}15E Rho Anom}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[-1  0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19]
(21,)
(50,)
(1, 50)
(14, 50)
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19]
(20,)
(13, 50)
(13, 50)

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}68}]:} Text(0.5,1,u'60-65S and 40W-15E Rho Anom')
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_104_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}69}]:} \PY{c+c1}{\PYZsh{}calc zonal average anomalies}
         \PY{c+c1}{\PYZsh{}Plot zonal average anomaly across weddell}
         \PY{n}{x1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{40}\PY{p}{)}
         \PY{n}{x2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{l+m+mi}{15}\PY{p}{)}
         \PY{n}{x1}\PY{o}{=}\PY{n}{x1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{x2}\PY{o}{=}\PY{n}{x2}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         
         \PY{n}{y1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{65}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}y2=np.argwhere(xt\PYZus{}ocean\PYZlt{}15)}
         \PY{n}{y1}\PY{o}{=}\PY{n}{y1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{c+c1}{\PYZsh{}y2=y2[\PYZhy{}1]}
         \PY{k}{print} \PY{n}{x1}\PY{p}{,} \PY{n}{x2}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[959] [1179]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}70}]:} \PY{c+c1}{\PYZsh{}plot control zavg temp, rho, salt }
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{9.5}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Control Zavg Tracers 40W\PYZhy{}15E}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{yr}\PY{o}{=}\PY{l+m+mi}{0}
         \PY{n}{var1}\PY{o}{=}\PY{n}{cntrl}\PY{o}{.}\PY{n}{pot\PYZus{}rho\PYZus{}0}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mf}{1027.7}\PY{p}{,}\PY{l+m+mf}{1027.8}\PY{p}{,}\PY{l+m+mi}{51}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}color}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.25}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{p1}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{]}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{var1}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{kg/m3}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.contour(yt\PYZus{}ocean[0:500],st\PYZus{}ocean,pert\PYZus{}ztemp\PYZhy{}cntrl\PYZus{}ztemp,levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=0.25)}
         \PY{c+c1}{\PYZsh{}plt.contour(yt\PYZus{}ocean[0:500],st\PYZus{}ocean,pert\PYZus{}ztemp\PYZhy{}cntrl\PYZus{}ztemp,levels=[0.0,],colors=\PYZsq{}k\PYZsq{},linewidths=0.5)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.gca().yaxis.set\PYZus{}major\PYZus{}formatter(x\PYZus{}formatter)}
         \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1034))}
         \PY{c+c1}{\PYZsh{}plt.ylabel(\PYZsq{}Depth (m)\PYZsq{})}
         \PY{c+c1}{\PYZsh{}plt.xlabel(\PYZsq{}Latitude (\PYZdl{}\PYZca{}\PYZbs{}circ\PYZdl{}S)\PYZsq{})}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{50}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Control Rho}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{var1}\PY{o}{=}\PY{n}{cntrl}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{51}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}color}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.25}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{p1}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{]}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{var1}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.contour(yt\PYZus{}ocean[0:500],st\PYZus{}ocean,pert\PYZus{}ztemp\PYZhy{}cntrl\PYZus{}ztemp,levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=0.25)}
         \PY{c+c1}{\PYZsh{}plt.contour(yt\PYZus{}ocean[0:500],st\PYZus{}ocean,pert\PYZus{}ztemp\PYZhy{}cntrl\PYZus{}ztemp,levels=[0.0,],colors=\PYZsq{}k\PYZsq{},linewidths=0.5)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.gca().yaxis.set\PYZus{}major\PYZus{}formatter(x\PYZus{}formatter)}
         \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1034))}
         \PY{c+c1}{\PYZsh{}plt.ylabel(\PYZsq{}Depth (m)\PYZsq{})}
         \PY{c+c1}{\PYZsh{}plt.xlabel(\PYZsq{}Latitude (\PYZdl{}\PYZca{}\PYZbs{}circ\PYZdl{}S)\PYZsq{})}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{50}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Control Temp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{var1}\PY{o}{=}\PY{n}{cntrl}\PY{o}{.}\PY{n}{salt}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mi}{34}\PY{p}{,}\PY{l+m+mi}{35}\PY{p}{,}\PY{l+m+mi}{51}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}color}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.25}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{p1}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{]}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{var1}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sa}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.contour(yt\PYZus{}ocean[0:500],st\PYZus{}ocean,pert\PYZus{}ztemp\PYZhy{}cntrl\PYZus{}ztemp,levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=0.25)}
         \PY{c+c1}{\PYZsh{}plt.contour(yt\PYZus{}ocean[0:500],st\PYZus{}ocean,pert\PYZus{}ztemp\PYZhy{}cntrl\PYZus{}ztemp,levels=[0.0,],colors=\PYZsq{}k\PYZsq{},linewidths=0.5)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.gca().yaxis.set\PYZus{}major\PYZus{}formatter(x\PYZus{}formatter)}
         \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1034))}
         \PY{c+c1}{\PYZsh{}plt.ylabel(\PYZsq{}Depth (m)\PYZsq{})}
         \PY{c+c1}{\PYZsh{}plt.xlabel(\PYZsq{}Latitude (\PYZdl{}\PYZca{}\PYZbs{}circ\PYZdl{}S)\PYZsq{})}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{50}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Control Salt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}70}]:} Text(0.5,1,u'Control Salt')
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_106_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{c+c1}{\PYZsh{}compare tracers to WOA13}
         \PY{c+c1}{\PYZsh{}Ocean\PYZus{}File = \PYZsq{}/g/data1/v45/pas561/mom/archive/woa13\PYZus{}mom025\PYZus{}ocean\PYZus{}temp\PYZus{}salt.res.nc\PYZsq{}}
         \PY{c+c1}{\PYZsh{}print Ocean\PYZus{}File}
         \PY{c+c1}{\PYZsh{}woa=xr.open\PYZus{}mfdataset(Ocean\PYZus{}File,engine=\PYZsq{}netcdf4\PYZsq{},concat\PYZus{}dim=\PYZsq{}time\PYZsq{},decode\PYZus{}times=False)}
         \PY{c+c1}{\PYZsh{}print woa.temp.shape}
         
         \PY{n}{nc} \PY{o}{=} \PY{n}{Dataset}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/g/data1/v45/pas561/mom/archive/woa13\PYZus{}mom025\PYZus{}ocean\PYZus{}temp\PYZus{}salt.res.nc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{mode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{} file handle, open in read only mode}
         \PY{n}{grid\PYZus{}xt} \PY{o}{=} \PY{n}{nc}\PY{o}{.}\PY{n}{variables}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GRID\PYZus{}X\PYZus{}T}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{]}
         \PY{n}{grid\PYZus{}yt} \PY{o}{=} \PY{n}{nc}\PY{o}{.}\PY{n}{variables}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GRID\PYZus{}Y\PYZus{}T}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{]}
         \PY{n}{zt} \PY{o}{=} \PY{n}{nc}\PY{o}{.}\PY{n}{variables}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ZT}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{]}
         \PY{n}{woa\PYZus{}temp} \PY{o}{=} \PY{n}{nc}\PY{o}{.}\PY{n}{variables}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{temp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{]}
         \PY{n}{woa\PYZus{}salt} \PY{o}{=} \PY{n}{nc}\PY{o}{.}\PY{n}{variables}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{salt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{]}
         \PY{n}{nc}\PY{o}{.}\PY{n}{close}\PY{p}{(}\PY{p}{)} \PY{c+c1}{\PYZsh{} close the file}
         
         \PY{k}{print} \PY{n}{woa\PYZus{}salt}\PY{o}{.}\PY{n}{shape}\PY{p}{,} \PY{n}{woa\PYZus{}temp}\PY{o}{.}\PY{n}{shape}\PY{p}{,} \PY{n}{grid\PYZus{}xt}\PY{o}{.}\PY{n}{shape}\PY{p}{,} \PY{n}{grid\PYZus{}yt}\PY{o}{.}\PY{n}{shape}\PY{p}{,} \PY{n}{zt}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{woa\PYZus{}temp}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{squeeze}\PY{p}{(}\PY{n}{woa\PYZus{}temp}\PY{p}{)}
         \PY{n}{woa\PYZus{}salt}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{squeeze}\PY{p}{(}\PY{n}{woa\PYZus{}salt}\PY{p}{)}
         
         \PY{k}{print} \PY{n}{woa\PYZus{}salt}\PY{o}{.}\PY{n}{shape}\PY{p}{,} \PY{n}{woa\PYZus{}temp}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(1, 50, 1080, 1440) (1, 50, 1080, 1440) (1440,) (1080,) (50,)
(50, 1080, 1440) (50, 1080, 1440)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}73}]:} \PY{c+c1}{\PYZsh{}mask bathy }
         \PY{c+c1}{\PYZsh{}msk=ma.getmask(cntrl.temp[0].load())}
         \PY{n}{msk}\PY{o}{=}\PY{n}{cntrl}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
         \PY{k}{print} \PY{n}{msk}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{500}\PY{p}{,}\PY{l+m+mi}{500}\PY{p}{]}
         \PY{k}{print} \PY{n}{woa\PYZus{}temp}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{500}\PY{p}{,}\PY{l+m+mi}{500}\PY{p}{]}
         
         
         \PY{n}{woa\PYZus{}temp}\PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{n}{isnan}\PY{p}{(}\PY{n}{msk}\PY{p}{)}\PY{p}{)}\PY{p}{]}\PY{o}{=}\PY{n}{nan}
         \PY{k}{print} \PY{n}{woa\PYZus{}temp}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{500}\PY{p}{,}\PY{l+m+mi}{500}\PY{p}{]}
         \PY{n}{woa\PYZus{}salt}\PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{n}{isnan}\PY{p}{(}\PY{n}{msk}\PY{p}{)}\PY{p}{)}\PY{p}{]}\PY{o}{=}\PY{n}{nan}
         \PY{k}{print} \PY{n}{woa\PYZus{}salt}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{500}\PY{p}{,}\PY{l+m+mi}{500}\PY{p}{]}
         
         \PY{c+c1}{\PYZsh{}woaT=numpy.ma.fix\PYZus{}invalid()}
         \PY{c+c1}{\PYZsh{}msk[np.where(msk\PYZlt{}\PYZhy{}1)]=0}
         \PY{c+c1}{\PYZsh{}msk[np.where(msk==\PYZhy{}1)]=1}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
<xarray.DataArray 'temp' (st\_ocean: 50)>
array([ 27.391373,  27.370281,  27.33518 ,  27.285015,  27.204884,  27.089434,
        26.876654,  26.565861,  25.865721,  24.812428,  23.600998,  21.820873,
        19.591003,  17.071674,  14.687031,  12.764536,  11.275241,  10.17234 ,
         9.40194 ,   8.853135,   8.389923,   7.868567,   7.334641,   6.811964,
         6.313274,   5.801466,   5.204368,   4.553436,   3.932255,   3.38131 ,
         2.965437,   2.637968,   2.373274,   2.158896,   1.967185,   1.801057,
         1.671383,   1.545439,   1.439953,   1.381891,   1.321449,   1.272832,
         1.231555,   1.187707,   1.099543,   1.060953,   1.045196,        nan,
              nan,        nan])
Coordinates:
    xt\_ocean  float64 -154.9
    yt\_ocean  float64 0.625
  * st\_ocean  (st\_ocean) float64 5.034 15.1 25.22 35.36 45.58 55.85 66.26 {\ldots}
Attributes:
    long\_name:      Potential temperature
    units:          degrees C
    valid\_range:    [ -10.  500.]
    cell\_methods:   time: mean
    time\_avg\_info:  average\_T1,average\_T2,average\_DT
    coordinates:    geolon\_t geolat\_t
    standard\_name:  sea\_water\_potential\_temperature
[ 26.62288433  26.55509282  26.51248013  26.47060121  26.42628751
  26.34202828  26.30725532  26.05351904  25.78953543  25.47626913
  24.963288    24.40705425  23.31743149  21.98282447  19.19183045
  16.45292385  14.41800094  12.86488164  12.31093566  11.77655512
  11.02814314  10.16895449   8.92929535   7.83689599   6.7422477
   5.85892407   5.0917536    4.53279654   3.99515214   3.37409238
   2.90915295   2.57976875   2.28671468   2.099215     1.8444547
   1.7537439    1.60414055   1.51508818   1.41625092   1.33820459
   1.22595487   1.15044001   1.10424622   1.05481327   0.98981575
   0.93587846   0.90652401   0.81356506   0.78894907   0.74133515]
[ 26.62288433  26.55509282  26.51248013  26.47060121  26.42628751
  26.34202828  26.30725532  26.05351904  25.78953543  25.47626913
  24.963288    24.40705425  23.31743149  21.98282447  19.19183045
  16.45292385  14.41800094  12.86488164  12.31093566  11.77655512
  11.02814314  10.16895449   8.92929535   7.83689599   6.7422477
   5.85892407   5.0917536    4.53279654   3.99515214   3.37409238
   2.90915295   2.57976875   2.28671468   2.099215     1.8444547
   1.7537439    1.60414055   1.51508818   1.41625092   1.33820459
   1.22595487   1.15044001   1.10424622   1.05481327   0.98981575
   0.93587846   0.90652401          nan          nan          nan]
[ 35.08054105  35.10070614  35.10332816  35.10862207  35.11781672
  35.12376322  35.12664451  35.14256954  35.15379239  35.14189377
  35.12583373  35.11074948  35.08381086  35.05126384  34.97703452
  34.91497418  34.89447022  34.87321432  34.86433317  34.83569721
  34.78888181  34.72485845  34.65148832  34.60550852  34.5707201
  34.5494606   34.5461499   34.55295022  34.56518732  34.58180882
  34.60020084  34.61921488  34.63259846  34.65113296  34.66535099
  34.67181601  34.67673236  34.68070488  34.67884662  34.68270334
  34.68876908  34.69320379  34.69545777  34.6992926   34.70199238
  34.70132551  34.70841073          nan          nan          nan]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}74}]:} \PY{c+c1}{\PYZsh{}calc zonal average anomalies}
         \PY{c+c1}{\PYZsh{}Plot zonal average anomaly across weddell}
         \PY{n}{x1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{grid\PYZus{}xt}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{40}\PY{p}{)}
         \PY{n}{x2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{grid\PYZus{}xt}\PY{o}{\PYZlt{}}\PY{l+m+mi}{15}\PY{p}{)}
         \PY{n}{x1}\PY{o}{=}\PY{n}{x1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{x2}\PY{o}{=}\PY{n}{x2}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         
         \PY{n}{y1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{grid\PYZus{}yt}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{65}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}y2=np.argwhere(xt\PYZus{}ocean\PYZlt{}15)}
         \PY{n}{y1}\PY{o}{=}\PY{n}{y1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{c+c1}{\PYZsh{}y2=y2[\PYZhy{}1]}
         \PY{k}{print} \PY{n}{x1}\PY{p}{,} \PY{n}{x2}\PY{p}{,} \PY{n}{grid\PYZus{}xt}\PY{p}{[}\PY{n}{x1}\PY{p}{]}\PY{p}{,}\PY{n}{grid\PYZus{}xt}\PY{p}{[}\PY{n}{x2}\PY{p}{]}\PY{p}{,} \PY{n}{grid\PYZus{}yt}\PY{p}{[}\PY{n}{y1}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[959] [1179] [-40.125] [ 14.875] [-65.02601527]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{n}{of}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/g/data1/v45/pas561/mom/archive/woa13\PYZus{}mom025\PYZus{}ocean\PYZus{}temp\PYZus{}salt\PYZus{}to\PYZus{}rho0.npy}\PY{l+s+s1}{\PYZsq{}}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}a=np.save(of,woa\PYZus{}rho0)}
         \PY{n}{woa\PYZus{}rho}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n}{of}\PY{p}{)}
         \PY{k}{print} \PY{n}{woa\PYZus{}rho}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(50, 1080, 1440)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{c+c1}{\PYZsh{}plot control zavg temp, rho, salt }
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{9.5}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{WOA13 Zavg Tracers 40W\PYZhy{}15E}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{yr}\PY{o}{=}\PY{l+m+mi}{0}
         \PY{n}{var1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{nanmean}\PY{p}{(}\PY{n}{woa\PYZus{}temp}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mf}{1027.7}\PY{p}{,}\PY{l+m+mf}{1027.8}\PY{p}{,}\PY{l+m+mi}{51}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}color}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.25}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{p1}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{]}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{woa\PYZus{}rho}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{kg/m3}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.gca().yaxis.set\PYZus{}major\PYZus{}formatter(x\PYZus{}formatter)}
         \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1034))}
         \PY{c+c1}{\PYZsh{}plt.ylabel(\PYZsq{}Depth (m)\PYZsq{})}
         \PY{c+c1}{\PYZsh{}plt.xlabel(\PYZsq{}Latitude (\PYZdl{}\PYZca{}\PYZbs{}circ\PYZdl{}S)\PYZsq{})}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{50}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{WOA13 Rho}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{yr}\PY{o}{=}\PY{l+m+mi}{0}
         
         \PY{n}{var1}\PY{o}{=}\PY{n}{cntrl}\PY{o}{.}\PY{n}{pot\PYZus{}rho\PYZus{}0}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}color}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.25}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{p1}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{]}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{var1}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{kg/m3}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.contour(yt\PYZus{}ocean[0:500],st\PYZus{}ocean,pert\PYZus{}ztemp\PYZhy{}cntrl\PYZus{}ztemp,levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=0.25)}
         \PY{c+c1}{\PYZsh{}plt.contour(yt\PYZus{}ocean[0:500],st\PYZus{}ocean,pert\PYZus{}ztemp\PYZhy{}cntrl\PYZus{}ztemp,levels=[0.0,],colors=\PYZsq{}k\PYZsq{},linewidths=0.5)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.gca().yaxis.set\PYZus{}major\PYZus{}formatter(x\PYZus{}formatter)}
         \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1034))}
         \PY{c+c1}{\PYZsh{}plt.ylabel(\PYZsq{}Depth (m)\PYZsq{})}
         \PY{c+c1}{\PYZsh{}plt.xlabel(\PYZsq{}Latitude (\PYZdl{}\PYZca{}\PYZbs{}circ\PYZdl{}S)\PYZsq{})}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{50}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Control Rho}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         
         \PY{n}{var1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{nanmean}\PY{p}{(}\PY{n}{woa\PYZus{}temp}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{51}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}color}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.25}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{p1}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{grid\PYZus{}yt}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{]}\PY{p}{,}\PY{n}{zt}\PY{p}{,}\PY{n}{var1}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.contour(yt\PYZus{}ocean[0:500],st\PYZus{}ocean,pert\PYZus{}ztemp\PYZhy{}cntrl\PYZus{}ztemp,levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=0.25)}
         \PY{c+c1}{\PYZsh{}plt.contour(yt\PYZus{}ocean[0:500],st\PYZus{}ocean,pert\PYZus{}ztemp\PYZhy{}cntrl\PYZus{}ztemp,levels=[0.0,],colors=\PYZsq{}k\PYZsq{},linewidths=0.5)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.gca().yaxis.set\PYZus{}major\PYZus{}formatter(x\PYZus{}formatter)}
         \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1034))}
         \PY{c+c1}{\PYZsh{}plt.ylabel(\PYZsq{}Depth (m)\PYZsq{})}
         \PY{c+c1}{\PYZsh{}plt.xlabel(\PYZsq{}Latitude (\PYZdl{}\PYZca{}\PYZbs{}circ\PYZdl{}S)\PYZsq{})}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{50}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{WOA13 Temp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{var1}\PY{o}{=}\PY{n}{cntrl}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{51}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}color}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.25}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{p1}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{]}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{var1}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.contour(yt\PYZus{}ocean[0:500],st\PYZus{}ocean,pert\PYZus{}ztemp\PYZhy{}cntrl\PYZus{}ztemp,levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=0.25)}
         \PY{c+c1}{\PYZsh{}plt.contour(yt\PYZus{}ocean[0:500],st\PYZus{}ocean,pert\PYZus{}ztemp\PYZhy{}cntrl\PYZus{}ztemp,levels=[0.0,],colors=\PYZsq{}k\PYZsq{},linewidths=0.5)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.gca().yaxis.set\PYZus{}major\PYZus{}formatter(x\PYZus{}formatter)}
         \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1034))}
         \PY{c+c1}{\PYZsh{}plt.ylabel(\PYZsq{}Depth (m)\PYZsq{})}
         \PY{c+c1}{\PYZsh{}plt.xlabel(\PYZsq{}Latitude (\PYZdl{}\PYZca{}\PYZbs{}circ\PYZdl{}S)\PYZsq{})}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{50}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Control Temp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{var1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{nanmean}\PY{p}{(}\PY{n}{woa\PYZus{}salt}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mi}{34}\PY{p}{,}\PY{l+m+mi}{35}\PY{p}{,}\PY{l+m+mi}{51}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}color}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.25}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{p1}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{grid\PYZus{}yt}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{]}\PY{p}{,}\PY{n}{zt}\PY{p}{,}\PY{n}{var1}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sa}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.contour(yt\PYZus{}ocean[0:500],st\PYZus{}ocean,pert\PYZus{}ztemp\PYZhy{}cntrl\PYZus{}ztemp,levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=0.25)}
         \PY{c+c1}{\PYZsh{}plt.contour(yt\PYZus{}ocean[0:500],st\PYZus{}ocean,pert\PYZus{}ztemp\PYZhy{}cntrl\PYZus{}ztemp,levels=[0.0,],colors=\PYZsq{}k\PYZsq{},linewidths=0.5)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.gca().yaxis.set\PYZus{}major\PYZus{}formatter(x\PYZus{}formatter)}
         \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1034))}
         \PY{c+c1}{\PYZsh{}plt.ylabel(\PYZsq{}Depth (m)\PYZsq{})}
         \PY{c+c1}{\PYZsh{}plt.xlabel(\PYZsq{}Latitude (\PYZdl{}\PYZca{}\PYZbs{}circ\PYZdl{}S)\PYZsq{})}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{50}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{WOA13 Salt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{var1}\PY{o}{=}\PY{n}{cntrl}\PY{o}{.}\PY{n}{salt}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mi}{34}\PY{p}{,}\PY{l+m+mi}{35}\PY{p}{,}\PY{l+m+mi}{51}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{6}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}color}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.25}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{p1}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{]}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{var1}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sa}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.contour(yt\PYZus{}ocean[0:500],st\PYZus{}ocean,pert\PYZus{}ztemp\PYZhy{}cntrl\PYZus{}ztemp,levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=0.25)}
         \PY{c+c1}{\PYZsh{}plt.contour(yt\PYZus{}ocean[0:500],st\PYZus{}ocean,pert\PYZus{}ztemp\PYZhy{}cntrl\PYZus{}ztemp,levels=[0.0,],colors=\PYZsq{}k\PYZsq{},linewidths=0.5)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.gca().yaxis.set\PYZus{}major\PYZus{}formatter(x\PYZus{}formatter)}
         \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1034))}
         \PY{c+c1}{\PYZsh{}plt.ylabel(\PYZsq{}Depth (m)\PYZsq{})}
         \PY{c+c1}{\PYZsh{}plt.xlabel(\PYZsq{}Latitude (\PYZdl{}\PYZca{}\PYZbs{}circ\PYZdl{}S)\PYZsq{})}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{50}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Control Salt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]

        ---------------------------------------------------------------------------

        NameError                                 Traceback (most recent call last)

        <ipython-input-11-5e0642c494af> in <module>()
          5 
          6 yr=0
    ----> 7 var1=np.nanmean(woa\_temp[:,0:500,x1:x2],axis=2)
          8 
          9 clev = np.linspace(1027.7,1027.8,51)


        NameError: name 'woa\_temp' is not defined

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_111_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{}stop current analysis here}
        \PY{c+c1}{\PYZsh{}\PYZsh{} Calc the AMOC from ty\PYZus{}trans for forcing cases}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{}calculate the AMOC mask}
        \PY{c+c1}{\PYZsh{}\PYZhy{}1 is Atl and Arctic, all other ocean is \PYZhy{}2, land is 0}
        \PY{c+c1}{\PYZsh{}reset to 1 and 0}
        \PY{n}{msk\PYZus{}file}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/g/data1/v45/pas561/mom/archive/gfdl\PYZus{}nyf\PYZus{}1080/basin\PYZus{}mask.nc}\PY{l+s+s1}{\PYZsq{}}
        \PY{n}{nc} \PY{o}{=} \PY{n}{Dataset}\PY{p}{(}\PY{n}{msk\PYZus{}file}\PY{p}{,} \PY{n}{mode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{} file handle, open in read only mode}
        \PY{n}{msk}\PY{o}{=} \PY{n}{nc}\PY{o}{.}\PY{n}{variables}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{kmt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{]}
        \PY{n}{nc}\PY{o}{.}\PY{n}{close}\PY{p}{(}\PY{p}{)} \PY{c+c1}{\PYZsh{} close the file}
        \PY{k}{print} \PY{n}{msk}\PY{o}{.}\PY{n}{shape}
        \PY{n}{msk}\PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{n}{msk}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}\PY{o}{=}\PY{l+m+mi}{0}
        \PY{n}{msk}\PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{n}{msk}\PY{o}{==}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}\PY{o}{=}\PY{l+m+mi}{1}
        
        \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{k}{print} \PY{n}{clev}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{211}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{,}\PY{n}{msk}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
        \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mask}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{AMOC Mask}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{}do AMOC in zspace}
        \PY{n}{Ocean\PYZus{}File} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{output5*/ocean.nc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{k}{print} \PY{n}{Ocean\PYZus{}File}
        
        \PY{n}{ff}\PY{o}{=}\PY{n}{xr}\PY{o}{.}\PY{n}{open\PYZus{}mfdataset}\PY{p}{(}\PY{n}{Ocean\PYZus{}File}\PY{p}{,}\PY{n}{engine}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{netcdf4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{concat\PYZus{}dim}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{decode\PYZus{}times}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
        \PY{k}{print} \PY{n}{ff}\PY{o}{.}\PY{n}{ty\PYZus{}trans}\PY{o}{.}\PY{n}{shape}
        
        \PY{c+c1}{\PYZsh{}tt=ff.ty\PYZus{}trans[1,:,500,500].load()}
        \PY{c+c1}{\PYZsh{}print \PYZsq{}no mask\PYZsq{}, tt}
        
        \PY{n}{ty}\PY{o}{=}\PY{n}{ff}\PY{o}{.}\PY{n}{ty\PYZus{}trans}\PY{o}{*}\PY{n}{msk}
        \PY{k}{print} \PY{n}{ty}\PY{o}{.}\PY{n}{shape}
        \PY{c+c1}{\PYZsh{}tt=ty[1,:,500,500].load()}
        \PY{c+c1}{\PYZsh{}print \PYZsq{}mask\PYZsq{},tt}
        
        \PY{n}{cntrl\PYZus{}amoc}\PY{o}{=}\PY{n}{ty}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{cumsum}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{st\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
        
        \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{amoc\PYZus{}z.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{a}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{cntrl\PYZus{}amoc}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{}do AMOC in zspace}
        \PY{n}{Ocean\PYZus{}File} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{output5*/ocean.nc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{k}{print} \PY{n}{Ocean\PYZus{}File}
        
        \PY{n}{ff}\PY{o}{=}\PY{n}{xr}\PY{o}{.}\PY{n}{open\PYZus{}mfdataset}\PY{p}{(}\PY{n}{Ocean\PYZus{}File}\PY{p}{,}\PY{n}{engine}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{netcdf4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{concat\PYZus{}dim}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{decode\PYZus{}times}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
        \PY{k}{print} \PY{n}{ff}\PY{o}{.}\PY{n}{ty\PYZus{}trans}\PY{o}{.}\PY{n}{shape}
        
        \PY{c+c1}{\PYZsh{}tt=ff.ty\PYZus{}trans[1,:,500,500].load()}
        \PY{c+c1}{\PYZsh{}print \PYZsq{}no mask\PYZsq{}, tt}
        
        \PY{n}{ty}\PY{o}{=}\PY{n}{ff}\PY{o}{.}\PY{n}{ty\PYZus{}trans}\PY{o}{*}\PY{n}{msk}
        \PY{k}{print} \PY{n}{ty}\PY{o}{.}\PY{n}{shape}
        \PY{c+c1}{\PYZsh{}tt=ty[1,:,500,500].load()}
        \PY{c+c1}{\PYZsh{}print \PYZsq{}mask\PYZsq{},tt}
        
        \PY{n}{pert\PYZus{}amoc}\PY{o}{=}\PY{n}{ty}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{cumsum}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{st\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
        
        \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{amoc\PYZus{}z.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{a}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{pert\PYZus{}amoc}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{amoc\PYZus{}z.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{pert\PYZus{}amoc}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n}{of}\PY{p}{)}
        \PY{k}{print} \PY{n}{pert\PYZus{}amoc}\PY{o}{.}\PY{n}{shape}
        
        \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{amoc\PYZus{}z.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{cntrl\PYZus{}amoc}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n}{of}\PY{p}{)}
        \PY{k}{print} \PY{n}{cntrl\PYZus{}amoc}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{}Amoc in Z space}
        \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{9.5}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{)}\PY{p}{)}
        \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
        
        \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{22}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{221}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}amoc}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
        \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}amoc}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}amoc}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{p}{[}\PY{l+m+mf}{0.0}\PY{p}{,}\PY{p}{]}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1035))}
        \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth (m)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Latitude (\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}N)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{30}\PY{p}{,}\PY{l+m+mi}{85}\PY{p}{]}\PY{p}{)}
        \PY{n}{tit}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Control Amoc}\PY{l+s+s1}{\PYZsq{}}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{tit}\PY{p}{)}
        
        \PY{n}{t1}\PY{o}{=}\PY{l+m+mi}{0}
        \PY{n}{t2}\PY{o}{=}\PY{l+m+mi}{5}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{222}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{pert\PYZus{}amoc}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
        \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{pert\PYZus{}amoc}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{pert\PYZus{}amoc}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{p}{[}\PY{l+m+mf}{0.0}\PY{p}{,}\PY{p}{]}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1035))}
        \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth (m)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Latitude (\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}N)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{30}\PY{p}{,}\PY{l+m+mi}{85}\PY{p}{]}\PY{p}{)}
        \PY{n}{tit}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Perturbed AMOC Years }\PY{l+s+s1}{\PYZsq{}}\PY{o}{+}\PY{n+nb}{str}\PY{p}{(}\PY{n}{t1}\PY{p}{)}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{+}\PY{n+nb}{str}\PY{p}{(}\PY{n}{t2}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{tit}\PY{p}{)}
        
        \PY{n}{t1}\PY{o}{=}\PY{l+m+mi}{0}
        \PY{n}{t2}\PY{o}{=}\PY{l+m+mi}{5}
        
        \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{6}\PY{p}{,}\PY{o}{.}\PY{l+m+mi}{5}\PY{p}{)}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{223}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{pert\PYZus{}amoc}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}amoc}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
        \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{pert\PYZus{}amoc}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}amoc}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{pert\PYZus{}amoc}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}amoc}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{p}{[}\PY{l+m+mf}{0.0}\PY{p}{,}\PY{p}{]}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1035))}
        \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth (m)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Latitude (\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}N)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{30}\PY{p}{,}\PY{l+m+mi}{85}\PY{p}{]}\PY{p}{)}
        \PY{n}{tit}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{AMOC Anom Years }\PY{l+s+s1}{\PYZsq{}}\PY{o}{+}\PY{n+nb}{str}\PY{p}{(}\PY{n}{t1}\PY{p}{)}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{+}\PY{n+nb}{str}\PY{p}{(}\PY{n}{t2}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{tit}\PY{p}{)}
        
        \PY{n}{t1}\PY{o}{=}\PY{l+m+mi}{6}
        \PY{n}{t2}\PY{o}{=}\PY{l+m+mi}{10}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{224}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{pert\PYZus{}amoc}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}amoc}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
        \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{pert\PYZus{}amoc}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}amoc}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{pert\PYZus{}amoc}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}amoc}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{p}{[}\PY{l+m+mf}{0.0}\PY{p}{,}\PY{p}{]}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1035))}
        \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth (m)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Latitude (\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}N)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{30}\PY{p}{,}\PY{l+m+mi}{85}\PY{p}{]}\PY{p}{)}
        \PY{n}{tit}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{AMOC Anom Years }\PY{l+s+s1}{\PYZsq{}}\PY{o}{+}\PY{n+nb}{str}\PY{p}{(}\PY{n}{t1}\PY{p}{)}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{+}\PY{n+nb}{str}\PY{p}{(}\PY{n}{t2}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{tit}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{}plot time series of AMOC in z space}
        \PY{n}{T}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{14}\PY{p}{)}
        \PY{k}{print} \PY{n}{T}\PY{o}{.}\PY{n}{shape}
        
        
        \PY{c+c1}{\PYZsh{} do lower cell average between lats 55\PYZhy{}60N}
        \PY{n}{j1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{l+m+mi}{55}\PY{p}{)}
        \PY{n}{j2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{l+m+mi}{60}\PY{p}{)}
        \PY{n}{j1}\PY{o}{=}\PY{n}{j1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{j2}\PY{o}{=}\PY{n}{j2}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        
        \PY{n}{z1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{st\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{l+m+mi}{500}\PY{p}{)}
        \PY{n}{z1}\PY{o}{=}\PY{n}{z1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        
        \PY{n}{uc\PYZus{}cntrl50\PYZus{}psj} \PY{o}{=} \PY{n}{cntrl\PYZus{}amoc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}
        \PY{n}{uc\PYZus{}cntrl50\PYZus{}psj\PYZus{}bar} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{uc\PYZus{}cntrl50\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{uc\PYZus{}cntrl50\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{uc\PYZus{}cntrl50\PYZus{}psj\PYZus{}bar}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
        
        \PY{n}{uc\PYZus{}pert50\PYZus{}psj} \PY{o}{=} \PY{n}{pert\PYZus{}amoc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}
        \PY{n}{uc\PYZus{}pert50\PYZus{}psj\PYZus{}bar} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{uc\PYZus{}pert50\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{uc\PYZus{}pert50\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{uc\PYZus{}pert50\PYZus{}psj\PYZus{}bar}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{n}{uc\PYZus{}pert50\PYZus{}psj\PYZus{}ts}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{insert}\PY{p}{(}\PY{n}{uc\PYZus{}pert50\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{uc\PYZus{}cntrl50\PYZus{}psj\PYZus{}ts}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
        
        
        \PY{c+c1}{\PYZsh{} do lower cell average between lats 40\PYZhy{}45N}
        \PY{n}{j1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{l+m+mi}{30}\PY{p}{)}
        \PY{n}{j2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{l+m+mi}{35}\PY{p}{)}
        \PY{n}{j1}\PY{o}{=}\PY{n}{j1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{j2}\PY{o}{=}\PY{n}{j2}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        
        \PY{n}{uc\PYZus{}cntrl40\PYZus{}psj} \PY{o}{=} \PY{n}{cntrl\PYZus{}amoc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}
        \PY{n}{uc\PYZus{}cntrl40\PYZus{}psj\PYZus{}bar} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{uc\PYZus{}cntrl40\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{uc\PYZus{}cntrl40\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{uc\PYZus{}cntrl40\PYZus{}psj\PYZus{}bar}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
        
        \PY{n}{uc\PYZus{}pert40\PYZus{}psj} \PY{o}{=} \PY{n}{pert\PYZus{}amoc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}
        \PY{n}{uc\PYZus{}pert40\PYZus{}psj\PYZus{}bar} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{uc\PYZus{}pert40\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{uc\PYZus{}pert40\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{uc\PYZus{}pert40\PYZus{}psj\PYZus{}bar}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{n}{uc\PYZus{}pert40\PYZus{}psj\PYZus{}ts}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{insert}\PY{p}{(}\PY{n}{uc\PYZus{}pert40\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{uc\PYZus{}cntrl40\PYZus{}psj\PYZus{}ts}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} do lower cell average between lats 20\PYZhy{}25N}
        \PY{n}{j1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{l+m+mi}{10}\PY{p}{)}
        \PY{n}{j2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{l+m+mi}{15}\PY{p}{)}
        \PY{n}{j1}\PY{o}{=}\PY{n}{j1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{j2}\PY{o}{=}\PY{n}{j2}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        
        \PY{n}{uc\PYZus{}cntrl20\PYZus{}psj} \PY{o}{=} \PY{n}{cntrl\PYZus{}amoc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}
        \PY{n}{uc\PYZus{}cntrl20\PYZus{}psj\PYZus{}bar} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{uc\PYZus{}cntrl20\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{uc\PYZus{}cntrl20\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{uc\PYZus{}cntrl20\PYZus{}psj\PYZus{}bar}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
        
        \PY{n}{uc\PYZus{}pert20\PYZus{}psj} \PY{o}{=} \PY{n}{pert\PYZus{}amoc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}
        \PY{n}{uc\PYZus{}pert20\PYZus{}psj\PYZus{}bar} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{uc\PYZus{}pert20\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{uc\PYZus{}pert20\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{uc\PYZus{}pert20\PYZus{}psj\PYZus{}bar}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{n}{uc\PYZus{}pert20\PYZus{}psj\PYZus{}ts}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{insert}\PY{p}{(}\PY{n}{uc\PYZus{}pert20\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{uc\PYZus{}cntrl20\PYZus{}psj\PYZus{}ts}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
        
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{211}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{uc\PYZus{}pert50\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{1.5}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{uc\PYZus{}cntrl50\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{55\PYZhy{}60\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}N}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{uc\PYZus{}pert40\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{1.5}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{uc\PYZus{}cntrl40\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{30\PYZhy{}35\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}N}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{uc\PYZus{}pert20\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{1.5}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{uc\PYZus{}cntrl20\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{10\PYZhy{}15\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}N}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1035))}
        \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Transport (Sv)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Years}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}plt.xlim([\PYZhy{}75,85])}
        \PY{n}{tit}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{AMOC Upper Cell Z \PYZgt{} }\PY{l+s+s1}{\PYZsq{}} \PY{o}{+}\PY{n+nb}{str}\PY{p}{(}\PY{n}{st\PYZus{}ocean}\PY{p}{[}\PY{n}{z1}\PY{p}{]}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{tit}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k}{print} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{fh}\PY{p}{[}\PY{l+m+mi}{540}\PY{p}{:}\PY{l+m+mi}{1080}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)}
        \PY{k}{print} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{fh}\PY{p}{[}\PY{l+m+mi}{540}\PY{p}{:}\PY{l+m+mi}{1080}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{}Hov of Sea Ice Conc. in Southern Ocean}
        \PY{k}{print} \PY{n}{xt\PYZus{}ocean}\PY{p}{[}\PY{l+m+mi}{1040}\PY{p}{]}
        \PY{k}{print} \PY{n}{xt\PYZus{}ocean}\PY{p}{[}\PY{l+m+mi}{878}\PY{p}{]}
        
        \PY{n}{Ocean\PYZus{}File} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{CntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{output5*/ice\PYZus{}month.nc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{ff}\PY{o}{=}\PY{n}{xr}\PY{o}{.}\PY{n}{open\PYZus{}mfdataset}\PY{p}{(}\PY{n}{Ocean\PYZus{}File}\PY{p}{,}\PY{n}{engine}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{netcdf4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{concat\PYZus{}dim}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{decode\PYZus{}times}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
        \PY{k}{print} \PY{n}{ff}\PY{o}{.}\PY{n}{CN}\PY{o}{.}\PY{n}{shape}
        \PY{n}{nyf\PYZus{}cn}\PY{o}{=}\PY{n}{ff}\PY{o}{.}\PY{n}{CN}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{878}\PY{p}{:}\PY{l+m+mi}{1040}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ct}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
        \PY{k}{print} \PY{n}{nyf\PYZus{}cn}\PY{o}{.}\PY{n}{shape}
        
        \PY{n}{Ocean\PYZus{}File} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{PertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{output*/ice\PYZus{}month.nc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{ff}\PY{o}{=}\PY{n}{xr}\PY{o}{.}\PY{n}{open\PYZus{}mfdataset}\PY{p}{(}\PY{n}{Ocean\PYZus{}File}\PY{p}{,}\PY{n}{engine}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{netcdf4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{concat\PYZus{}dim}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{decode\PYZus{}times}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
        \PY{k}{print} \PY{n}{ff}\PY{o}{.}\PY{n}{CN}\PY{o}{.}\PY{n}{shape}
        \PY{n}{pert\PYZus{}cn}\PY{o}{=}\PY{n}{ff}\PY{o}{.}\PY{n}{CN}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{878}\PY{p}{:}\PY{l+m+mi}{1040}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ct}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
        \PY{k}{print} \PY{n}{pert\PYZus{}cn}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k}{print} \PY{n}{nyf\PYZus{}cn}\PY{o}{.}\PY{n}{shape}
        \PY{k}{print} \PY{n}{pert\PYZus{}cn}\PY{o}{.}\PY{n}{shape}
        \PY{n}{cn} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{concatenate}\PY{p}{(}\PY{p}{(}\PY{n}{nyf\PYZus{}cn}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{12}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{pert\PYZus{}cn}\PY{p}{)}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
        \PY{k}{print} \PY{n}{cn}\PY{o}{.}\PY{n}{shape}
        
        \PY{n}{time} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{192}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}print time}
        \PY{k}{print} \PY{n}{time}\PY{o}{.}\PY{n}{shape}
        
        \PY{k}{print} \PY{n}{xt\PYZus{}ocean}\PY{p}{[}\PY{l+m+mi}{1040}\PY{p}{]}
        \PY{k}{print} \PY{n}{xt\PYZus{}ocean}\PY{p}{[}\PY{l+m+mi}{878}\PY{p}{]}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{9.5}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{)}\PY{p}{)}
        \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
        
        \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mf}{1.0}\PY{p}{,}\PY{l+m+mi}{11}\PY{p}{)}
        \PY{k}{print} \PY{n}{clev}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{211}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{time}\PY{p}{,}\PY{n}{yt\PYZus{}ocean}\PY{p}{,}\PY{n}{cn}\PY{o}{.}\PY{n}{T}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{CMRmap\PYZus{}r}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
        \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Concentration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}plt.contour(yu\PYZus{}ocean,potrho,np.mean(cntrl\PYZus{}gmoc[0:4,:,:],axis=0),levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=0.25)}
        \PY{c+c1}{\PYZsh{}plt.contour(yu\PYZus{}ocean,potrho,np.mean(cntrl\PYZus{}gmoc[0:4,:,:],axis=0),levels=[0.0,],colors=\PYZsq{}k\PYZsq{},linewidths=0.5)}
        \PY{c+c1}{\PYZsh{}plt.gca().invert\PYZus{}yaxis()}
        \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{53}\PY{p}{)}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1035))}
        \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Latitude (\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{})}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time (Months)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}plt.xlim([\PYZhy{}75,85])}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Strong/Shift Weddell Sea Sea Ice Concentration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    


    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
