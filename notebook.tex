
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{Wombat\_WP2\_3yr}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \hypertarget{wombat-jun16z-wed-poly-maude-rise-wind-isolation-3yr-perturbation}{%
\subsection{Wombat Jun16z Wed Poly Maude Rise wind isolation 3yr
perturbation}\label{wombat-jun16z-wed-poly-maude-rise-wind-isolation-3yr-perturbation}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{c+c1}{\PYZsh{} Load modules}
        \PY{o}{\PYZpc{}}\PY{k}{pylab} inline
        \PY{k+kn}{from} \PY{n+nn}{netCDF4} \PY{k+kn}{import} \PY{n}{Dataset} \PY{c+c1}{\PYZsh{} to work with NetCDF files}
        \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k+kn}{as} \PY{n+nn}{np}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib.pyplot} \PY{k+kn}{as} \PY{n+nn}{plt} \PY{c+c1}{\PYZsh{} to generate plots}
        \PY{k+kn}{from} \PY{n+nn}{mpl\PYZus{}toolkits.basemap} \PY{k+kn}{import} \PY{n}{Basemap} \PY{c+c1}{\PYZsh{} plot on map projections}
        \PY{k+kn}{from} \PY{n+nn}{os.path} \PY{k+kn}{import} \PY{n}{expanduser}
        \PY{n}{home} \PY{o}{=} \PY{n}{expanduser}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZti{}}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{} Get users home directory}
        \PY{k+kn}{import} \PY{n+nn}{os} \PY{c+c1}{\PYZsh{} operating system interface}
        \PY{k+kn}{import} \PY{n+nn}{scipy} \PY{k+kn}{as} \PY{n+nn}{sp}
        \PY{k+kn}{import} \PY{n+nn}{xarray} \PY{k+kn}{as} \PY{n+nn}{xr}
        \PY{k+kn}{from} \PY{n+nn}{xarray.ufuncs} \PY{k+kn}{import} \PY{n}{square}\PY{p}{,} \PY{n}{sqrt}
        \PY{k+kn}{import} \PY{n+nn}{scipy.interpolate}
        \PY{k+kn}{import} \PY{n+nn}{scipy.ndimage}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Populating the interactive namespace from numpy and matplotlib

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{c+c1}{\PYZsh{}extract the MOM model grid info \PYZhy{} 50 and 75 vertical levels}
        \PY{n}{hgrid\PYZus{}file} \PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/g/data1/v45/pas561/mom/archive/gfdl\PYZus{}nyf\PYZus{}1080/mom025\PYZus{}ocean\PYZus{}grid.nc}\PY{l+s+s1}{\PYZsq{}}
        \PY{n}{vgrid\PYZus{}file} \PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/g/data1/v45/pas561/mom/archive/gfdl\PYZus{}nyf\PYZus{}1080/ocean.ncra501\PYZhy{}520.nc}\PY{l+s+s1}{\PYZsq{}}
        
        \PY{c+c1}{\PYZsh{} Extract the variables}
        \PY{n}{nc} \PY{o}{=} \PY{n}{Dataset}\PY{p}{(}\PY{n}{hgrid\PYZus{}file}\PY{p}{,} \PY{n}{mode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{} file handle, open in read only mode}
        \PY{n}{geolon\PYZus{}t} \PY{o}{=} \PY{n}{nc}\PY{o}{.}\PY{n}{variables}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{geolon\PYZus{}t}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{]}
        \PY{n}{geolat\PYZus{}t} \PY{o}{=} \PY{n}{nc}\PY{o}{.}\PY{n}{variables}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{geolat\PYZus{}t}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{]}
        \PY{n}{area\PYZus{}t} \PY{o}{=} \PY{n}{nc}\PY{o}{.}\PY{n}{variables}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{area\PYZus{}t}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{]}
        \PY{n}{dxt} \PY{o}{=} \PY{n}{nc}\PY{o}{.}\PY{n}{variables}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dxt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{]}
        \PY{n}{dyt} \PY{o}{=} \PY{n}{nc}\PY{o}{.}\PY{n}{variables}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dyt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{]}
        \PY{n}{kmu} \PY{o}{=} \PY{n}{nc}\PY{o}{.}\PY{n}{variables}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{kmu}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{]}
        \PY{n}{kmt} \PY{o}{=} \PY{n}{nc}\PY{o}{.}\PY{n}{variables}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{kmt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{]}
        \PY{n}{ht} \PY{o}{=} \PY{n}{nc}\PY{o}{.}\PY{n}{variables}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ht}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{]}
        \PY{n}{fcor} \PY{o}{=} \PY{n}{nc}\PY{o}{.}\PY{n}{variables}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{f\PYZus{}coriolis}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{]}
        \PY{n}{nc}\PY{o}{.}\PY{n}{close}\PY{p}{(}\PY{p}{)} \PY{c+c1}{\PYZsh{} close the file}
        \PY{k}{print} \PY{n}{geolon\PYZus{}t}\PY{o}{.}\PY{n}{shape}
        
        \PY{n}{fh}\PY{o}{=}\PY{n}{fcor}\PY{o}{/}\PY{n}{ht}
        \PY{k}{print} \PY{n}{fh}\PY{o}{.}\PY{n}{shape}
        
        \PY{n}{nc} \PY{o}{=} \PY{n}{Dataset}\PY{p}{(}\PY{n}{vgrid\PYZus{}file}\PY{p}{,} \PY{n}{mode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{} file handle, open in read only mode}
        \PY{n}{sw\PYZus{}ocean} \PY{o}{=} \PY{n}{nc}\PY{o}{.}\PY{n}{variables}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sw\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{]}
        \PY{n}{st\PYZus{}ocean} \PY{o}{=} \PY{n}{nc}\PY{o}{.}\PY{n}{variables}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{st\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{]}
        \PY{n}{yt\PYZus{}ocean} \PY{o}{=} \PY{n}{nc}\PY{o}{.}\PY{n}{variables}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{]}
        \PY{n}{yu\PYZus{}ocean} \PY{o}{=} \PY{n}{nc}\PY{o}{.}\PY{n}{variables}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yu\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{]}
        \PY{n}{xt\PYZus{}ocean} \PY{o}{=} \PY{n}{nc}\PY{o}{.}\PY{n}{variables}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{]}
        \PY{n}{potrho} \PY{o}{=} \PY{n}{nc}\PY{o}{.}\PY{n}{variables}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{potrho}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{]}
        \PY{n}{nc}\PY{o}{.}\PY{n}{close}\PY{p}{(}\PY{p}{)} \PY{c+c1}{\PYZsh{} close the file}
        \PY{k}{print} \PY{n}{st\PYZus{}ocean}\PY{o}{.}\PY{n}{shape}
        \PY{k}{print} \PY{n}{potrho}\PY{o}{.}\PY{n}{shape}
        \PY{k}{print} \PY{n}{yt\PYZus{}ocean}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(1080, 1440)
(1080, 1440)
(50,)
(80,)
(1080,)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{c+c1}{\PYZsh{}A = xr.DataArray(np.arange(100))}
        \PY{c+c1}{\PYZsh{}A.cumsum(axis=0)}
        \PY{k}{print} \PY{p}{(}\PY{n}{xr}\PY{o}{.}\PY{n}{\PYZus{}\PYZus{}version\PYZus{}\PYZus{}}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{}my xarray version is old, no cumsum. Should be version 0.9.2 or newer?}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
0.10.0

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{n}{NYFCntrlDir} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/g/data1/v45/pas561/mom/archive/wombat\PYZus{}jun16z/}\PY{l+s+s1}{\PYZsq{}}
        \PY{c+c1}{\PYZsh{}this has 3 years of a wind perturbation \PYZhy{} get a nice 3 year polynya.}
        \PY{n}{NYFPertDir} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/g/data1/v45/pas561/mom/archive/wombat\PYZus{}jun16z\PYZus{}wp2/}\PY{l+s+s1}{\PYZsq{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{n}{Ocean\PYZus{}File} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{output197*/ocean\PYZus{}force*.nc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{k}{print} \PY{n}{Ocean\PYZus{}File}
        \PY{n}{cntrl}\PY{o}{=}\PY{n}{xr}\PY{o}{.}\PY{n}{open\PYZus{}mfdataset}\PY{p}{(}\PY{n}{Ocean\PYZus{}File}\PY{p}{,}\PY{n}{engine}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{netcdf4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{concat\PYZus{}dim}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{decode\PYZus{}times}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
        
        \PY{n}{Ocean\PYZus{}File} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{output19*/ocean\PYZus{}force*.nc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{k}{print} \PY{n}{Ocean\PYZus{}File}
        \PY{n}{pert}\PY{o}{=}\PY{n}{xr}\PY{o}{.}\PY{n}{open\PYZus{}mfdataset}\PY{p}{(}\PY{n}{Ocean\PYZus{}File}\PY{p}{,}\PY{n}{engine}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{netcdf4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{concat\PYZus{}dim}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{decode\PYZus{}times}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
/g/data1/v45/pas561/mom/archive/wombat\_jun16z/output197*/ocean\_force*.nc
/g/data1/v45/pas561/mom/archive/wombat\_jun16z\_wp2/output19*/ocean\_force*.nc

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{c+c1}{\PYZsh{}plot wind stress}
        \PY{k}{print} \PY{n}{cntrl}\PY{o}{.}\PY{n}{tau\PYZus{}x}\PY{o}{.}\PY{n}{shape}
        \PY{c+c1}{\PYZsh{}cntrl\PYZus{}tx=ff.tau\PYZus{}x.load()}
        \PY{c+c1}{\PYZsh{}cntrl\PYZus{}ty=ff.tau\PYZus{}y.load()}
        
        \PY{k}{print} \PY{n}{pert}\PY{o}{.}\PY{n}{tau\PYZus{}x}\PY{o}{.}\PY{n}{shape}
        \PY{c+c1}{\PYZsh{}pert\PYZus{}tx=ff.tau\PYZus{}x.load()}
        \PY{c+c1}{\PYZsh{}pert\PYZus{}ty=ff.tau\PYZus{}y.load()}
        \PY{c+c1}{\PYZsh{}print pert\PYZus{}tx.shape}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(108, 1080, 1440)
(348, 1080, 1440)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{k}{print} \PY{n}{pert}\PY{o}{.}\PY{n}{tau\PYZus{}x}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{shape}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{12.5}\PY{p}{,}\PY{l+m+mf}{9.5}\PY{p}{)}\PY{p}{)}
        \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}plt.suptitle(\PYZsq{}Wind Stress\PYZsq{})}
        
        \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{o}{.}\PY{l+m+mi}{2}\PY{p}{,}\PY{o}{.}\PY{l+m+mi}{2}\PY{p}{,}\PY{o}{.}\PY{l+m+mo}{01}\PY{p}{)}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{55}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
        \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{)} 
        \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{cntrl}\PY{o}{.}\PY{n}{tau\PYZus{}x}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{12}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
        \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.7)}
        \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}N/m2\PYZsq{})}
        \PY{n}{clev3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{5000}\PY{p}{,}\PY{l+m+mi}{1000}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{ht}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev3}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Control Zonal Wind Stress}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{}clev = np.arange(\PYZhy{}.1,.1,.01)}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{55}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
        \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{)} 
        \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{pert}\PY{o}{.}\PY{n}{tau\PYZus{}x}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{12}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl}\PY{o}{.}\PY{n}{tau\PYZus{}x}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{12}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
        \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.5)}
        \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}N/m2\PYZsq{})}
        \PY{n}{clev3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{5000}\PY{p}{,}\PY{l+m+mi}{1000}\PY{p}{)}
        \PY{n+nb}{map}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{ht}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev3}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Anomaly}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{n}{ax3} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{axes}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.92}\PY{p}{,}\PY{l+m+mf}{0.38}\PY{p}{,}\PY{l+m+mf}{0.015}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{]}\PY{p}{)}
        \PY{n}{cb} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{p1}\PY{p}{,}\PY{n}{cax}\PY{o}{=}\PY{n}{ax3}\PY{p}{,}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
        \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{N/m2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}tau\PYZus{}x.pdf\PYZsq{})}
        \PY{c+c1}{\PYZsh{}print of}
        \PY{c+c1}{\PYZsh{}plt.savefig(of)}
        \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{tau\PYZus{}x.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(1080, 1440)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/dask/array/numpy\_compat.py:45: RuntimeWarning: invalid value encountered in divide
  x = np.divide(x1, x2, out)

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_7_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}9}]:} \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{o}{.}\PY{l+m+mi}{2}\PY{p}{,}\PY{o}{.}\PY{l+m+mi}{2}\PY{p}{,}\PY{o}{.}\PY{l+m+mo}{01}\PY{p}{)}
        \PY{n}{clev3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{5000}\PY{p}{,}\PY{l+m+mi}{1000}\PY{p}{)}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{321}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}color}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.25}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{p1}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{p}{,}\PY{n}{yt\PYZus{}ocean}\PY{p}{,}\PY{n}{cntrl}\PY{o}{.}\PY{n}{tau\PYZus{}x}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{12}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.7)}
        \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}N/m\PYZca{}2\PYZsq{})}
        \PY{n}{clev3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{5000}\PY{p}{,}\PY{l+m+mi}{1000}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{p}{,}\PY{n}{yt\PYZus{}ocean}\PY{p}{,}\PY{n}{ht}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev3}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{55}\PY{p}{)}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Longitude (\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{})}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Latitude (\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{})}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{l+m+mi}{40}\PY{p}{]}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Control Zonal Wind Stress}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        
        \PY{n}{yrs}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1973}\PY{p}{,}\PY{l+m+mi}{2016}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
        
        \PY{n}{ii}\PY{o}{=}\PY{l+m+mi}{0}
        \PY{k}{for} \PY{n}{yr} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{)}\PY{p}{:}
            
            \PY{c+c1}{\PYZsh{}print yr*12, yr*12+12}
                
            \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{n}{yr}\PY{o}{+}\PY{l+m+mi}{2}\PY{p}{)}
            \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}color}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.25}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            \PY{n}{p1}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{p}{,}\PY{n}{yt\PYZus{}ocean}\PY{p}{,}\PY{n}{pert}\PY{o}{.}\PY{n}{tau\PYZus{}x}\PY{p}{[}\PY{n}{yr}\PY{o}{*}\PY{l+m+mi}{12}\PY{p}{:}\PY{n}{yr}\PY{o}{*}\PY{l+m+mi}{12}\PY{o}{+}\PY{l+m+mi}{12}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl}\PY{o}{.}\PY{n}{tau\PYZus{}x}\PY{p}{[}\PY{n}{yr}\PY{o}{*}\PY{l+m+mi}{12}\PY{p}{:}\PY{n}{yr}\PY{o}{*}\PY{l+m+mi}{12}\PY{o}{+}\PY{l+m+mi}{12}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.7)}
            \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}N/m\PYZca{}2\PYZsq{})}
            \PY{n}{clev3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{5000}\PY{p}{,}\PY{l+m+mi}{1000}\PY{p}{)}
            \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{p}{,}\PY{n}{yt\PYZus{}ocean}\PY{p}{,}\PY{n}{ht}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev3}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
            \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
            \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{55}\PY{p}{)}\PY{p}{)}
            \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Longitude (\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{})}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Latitude (\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{})}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
            \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{l+m+mi}{40}\PY{p}{]}\PY{p}{)}
            \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{n}{yr}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
            
            \PY{c+c1}{\PYZsh{}ii+=12}
            
        \PY{n}{ax3} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{axes}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.92}\PY{p}{,}\PY{l+m+mf}{0.38}\PY{p}{,}\PY{l+m+mf}{0.015}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{]}\PY{p}{)}
        \PY{n}{cb} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{p1}\PY{p}{,}\PY{n}{cax}\PY{o}{=}\PY{n}{ax3}\PY{p}{,}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
        \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{N/m\PYZca{}2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}wpm2\PYZus{}cn.pdf\PYZsq{})}
        \PY{c+c1}{\PYZsh{}print of}
        \PY{c+c1}{\PYZsh{}plt.savefig(of)}
        \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}wpm2\PYZus{}cn.png\PYZsq{})}
        \PY{c+c1}{\PYZsh{}plt.savefig(of,dpi=220)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}9}]:} Text(0.5,0,u'N/m\^{}2')
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_8_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{c+c1}{\PYZsh{}plot wind stress curl ... Ekman pumping anomalies.}
         \PY{c+c1}{\PYZsh{}(d(Tau\PYZus{}y/f) /dx \PYZhy{} d(Tau\PYZus{}x/f) / dy) /rho\PYZus{}0}
         
         \PY{c+c1}{\PYZsh{}drhodx=np.gradient(rho[0,:,:,:],dxt,axis=2)}
         \PY{c+c1}{\PYZsh{}print drhodx.shape}
         
         \PY{k}{print} \PY{n}{cntrl}\PY{o}{.}\PY{n}{tau\PYZus{}x}\PY{o}{.}\PY{n}{shape}
         \PY{n}{cntrl\PYZus{}Txf}\PY{o}{=}\PY{n}{cntrl}\PY{o}{.}\PY{n}{tau\PYZus{}x}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{12}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{/}\PY{n}{fcor}
         \PY{n}{cntrl\PYZus{}Tyf}\PY{o}{=}\PY{n}{cntrl}\PY{o}{.}\PY{n}{tau\PYZus{}y}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{12}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{/}\PY{n}{fcor}
         \PY{k}{print} \PY{n}{cntrl\PYZus{}Txf}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{cntrl\PYZus{}dTyfdx}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{gradient}\PY{p}{(}\PY{n}{cntrl\PYZus{}Tyf}\PY{p}{,}\PY{n}{dxt}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{k}{print} \PY{n}{cntrl\PYZus{}dTyfdx}\PY{o}{.}\PY{n}{shape}
         \PY{n}{cntrl\PYZus{}dTxfdy}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{gradient}\PY{p}{(}\PY{n}{cntrl\PYZus{}Txf}\PY{p}{,}\PY{n}{dyt}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{k}{print} \PY{n}{cntrl\PYZus{}dTxfdy}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{rho0}\PY{o}{=}\PY{l+m+mf}{1035.0}
         \PY{n}{cntrl\PYZus{}we}\PY{o}{=}\PY{p}{(}\PY{n}{cntrl\PYZus{}dTyfdx}\PY{o}{\PYZhy{}}\PY{n}{cntrl\PYZus{}dTxfdy}\PY{p}{)}\PY{o}{/}\PY{n}{rho0}
         
         
         \PY{k}{print} \PY{n}{pert}\PY{o}{.}\PY{n}{tau\PYZus{}x}\PY{o}{.}\PY{n}{shape}
         \PY{n}{pert\PYZus{}Txf}\PY{o}{=}\PY{n}{pert}\PY{o}{.}\PY{n}{tau\PYZus{}x}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{12}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{/}\PY{n}{fcor}
         \PY{n}{pert\PYZus{}Tyf}\PY{o}{=}\PY{n}{pert}\PY{o}{.}\PY{n}{tau\PYZus{}y}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{12}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{/}\PY{n}{fcor}
         \PY{k}{print} \PY{n}{pert\PYZus{}Tyf}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{pert\PYZus{}dTyfdx}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{gradient}\PY{p}{(}\PY{n}{pert\PYZus{}Tyf}\PY{p}{,}\PY{n}{dxt}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{k}{print} \PY{n}{pert\PYZus{}dTyfdx}\PY{o}{.}\PY{n}{shape}
         \PY{n}{pert\PYZus{}dTxfdy}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{gradient}\PY{p}{(}\PY{n}{pert\PYZus{}Txf}\PY{p}{,}\PY{n}{dyt}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{k}{print} \PY{n}{pert\PYZus{}dTxfdy}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{rho0}\PY{o}{=}\PY{l+m+mf}{1035.0}
         \PY{n}{pert\PYZus{}we}\PY{o}{=}\PY{p}{(}\PY{n}{pert\PYZus{}dTyfdx}\PY{o}{\PYZhy{}}\PY{n}{pert\PYZus{}dTxfdy}\PY{p}{)}\PY{o}{/}\PY{n}{rho0}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(108, 1080, 1440)
(1080, 1440)
(1080, 1440)
(1080, 1440)
(348, 1080, 1440)
(1080, 1440)
(1080, 1440)
(1080, 1440)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{n}{m}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{nanmax}\PY{p}{(}\PY{n}{cntrl\PYZus{}we}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{300}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)}
         \PY{k}{print} \PY{n}{m}
         \PY{n}{m}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{nanmin}\PY{p}{(}\PY{n}{cntrl\PYZus{}we}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{300}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)}
         \PY{k}{print} \PY{n}{m}
         
         \PY{n}{m}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{nanmax}\PY{p}{(}\PY{n}{pert\PYZus{}we}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{300}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)}
         \PY{k}{print} \PY{n}{m}
         \PY{n}{m}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{nanmin}\PY{p}{(}\PY{n}{pert\PYZus{}we}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{300}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)}
         \PY{k}{print} \PY{n}{m}
         
         \PY{c+c1}{\PYZsh{}convert from m/s to m/day}
         \PY{n}{s\PYZus{}day}\PY{o}{=}\PY{l+m+mi}{60}\PY{o}{*}\PY{l+m+mi}{60}\PY{o}{*}\PY{l+m+mi}{24}
         \PY{k}{print} \PY{n}{s\PYZus{}day}
         \PY{n}{cntrl\PYZus{}we}\PY{o}{=}\PY{n}{cntrl\PYZus{}we}\PY{o}{*}\PY{n}{s\PYZus{}day}
         \PY{n}{pert\PYZus{}we}\PY{o}{=}\PY{n}{pert\PYZus{}we}\PY{o}{*}\PY{n}{s\PYZus{}day}
         
         \PY{n}{m}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{nanmax}\PY{p}{(}\PY{n}{cntrl\PYZus{}we}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{300}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)}
         \PY{k}{print} \PY{n}{m}
         \PY{n}{m}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{nanmin}\PY{p}{(}\PY{n}{cntrl\PYZus{}we}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{300}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)}
         \PY{k}{print} \PY{n}{m}
         
         \PY{n}{m}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{nanmax}\PY{p}{(}\PY{n}{pert\PYZus{}we}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{300}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)}
         \PY{k}{print} \PY{n}{m}
         \PY{n}{m}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{nanmin}\PY{p}{(}\PY{n}{pert\PYZus{}we}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{300}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)}
         \PY{k}{print} \PY{n}{m}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
5.95872585237e-05
-5.08694792028e-05
5.96054007596e-05
-5.08209387875e-05
86400
5.14833913645
-4.39512300312
5.14990662563
-4.39092911124

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{k}{print} \PY{n}{cntrl\PYZus{}we}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(1080, 1440)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{12.5}\PY{p}{,}\PY{l+m+mf}{9.5}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Ekman Pumping}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{o}{.}\PY{l+m+mi}{4}\PY{p}{,}\PY{o}{.}\PY{l+m+mi}{4}\PY{p}{,}\PY{o}{.}\PY{l+m+mo}{02}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{50}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
         \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{)} 
         \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{cntrl\PYZus{}we}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cm/s}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{clev3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{5000}\PY{p}{,}\PY{l+m+mi}{1000}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{ht}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev3}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Control}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{50}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
         \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{)} 
         \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{pert\PYZus{}we}\PY{o}{\PYZhy{}}\PY{n}{cntrl\PYZus{}we}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cm/s}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{clev3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{5000}\PY{p}{,}\PY{l+m+mi}{1000}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{ht}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev3}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Anomaly}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}we.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{we.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_12_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{c+c1}{\PYZsh{}plot stamps of sea ice concentration.}
         \PY{n}{Ocean\PYZus{}File} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{output197*/ice\PYZus{}\PYZus{}*.nc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cntrl\PYZus{}i}\PY{o}{=}\PY{n}{xr}\PY{o}{.}\PY{n}{open\PYZus{}mfdataset}\PY{p}{(}\PY{n}{Ocean\PYZus{}File}\PY{p}{,}\PY{n}{engine}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{netcdf4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{concat\PYZus{}dim}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{decode\PYZus{}times}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         \PY{k}{print} \PY{n}{cntrl\PYZus{}i}\PY{o}{.}\PY{n}{CN}\PY{o}{.}\PY{n}{shape}
         \PY{c+c1}{\PYZsh{}nyf\PYZus{}cn=ff.CN.sum(\PYZsq{}ct\PYZsq{}).load()}
         \PY{c+c1}{\PYZsh{}print nyf\PYZus{}cn.shape}
         
         \PY{n}{Ocean\PYZus{}File} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{output19*/ice\PYZus{}\PYZus{}*.nc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{pert\PYZus{}i}\PY{o}{=}\PY{n}{xr}\PY{o}{.}\PY{n}{open\PYZus{}mfdataset}\PY{p}{(}\PY{n}{Ocean\PYZus{}File}\PY{p}{,}\PY{n}{engine}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{netcdf4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{concat\PYZus{}dim}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{decode\PYZus{}times}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         \PY{k}{print} \PY{n}{pert\PYZus{}i}\PY{o}{.}\PY{n}{CN}\PY{o}{.}\PY{n}{shape}
         \PY{c+c1}{\PYZsh{}pert\PYZus{}cn=ff.CN.sum(\PYZsq{}ct\PYZsq{}).load()}
         \PY{c+c1}{\PYZsh{}print pert\PYZus{}cn.shape}
         
         \PY{c+c1}{\PYZsh{}print nyf\PYZus{}cn.shape}
         \PY{c+c1}{\PYZsh{}print pert\PYZus{}cn.shape}
         \PY{c+c1}{\PYZsh{}cn = np.concatenate((nyf\PYZus{}cn[0:12,:],pert\PYZus{}cn),axis=0)}
         \PY{c+c1}{\PYZsh{}print cn.shape}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(108, 5, 1080, 1440)
(348, 5, 1080, 1440)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}15}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{12.5}\PY{p}{,}\PY{l+m+mf}{9.5}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sea Ice Conc.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{tits}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{June}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{July}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Aug.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sept.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Oct.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Nov.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{yrs}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1972}\PY{p}{,}\PY{l+m+mi}{2016}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{k}{print} \PY{n}{tits}
         
         
         \PY{n}{ii}\PY{o}{=}\PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{yr} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{:}
             \PY{c+c1}{\PYZsh{}print yr}
             \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{11}\PY{p}{)}\PY{p}{:} 
                 
                 \PY{c+c1}{\PYZsh{}print yr*12+i}
             
                 \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{o}{.}\PY{l+m+mi}{1}\PY{p}{)}
                 \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{6}\PY{p}{,}\PY{n}{ii}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}
                 \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}color}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.25}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                 
                 \PY{k}{if} \PY{n}{yr}\PY{o}{==}\PY{l+m+mi}{0}\PY{p}{:}
                     \PY{n}{p1}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{p}{,}\PY{n}{yt\PYZus{}ocean}\PY{p}{,}\PY{n}{cntrl\PYZus{}i}\PY{o}{.}\PY{n}{CN}\PY{p}{[}\PY{n}{yr}\PY{o}{*}\PY{l+m+mi}{12}\PY{o}{+}\PY{n}{i}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ct}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{CMRmap\PYZus{}r}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                 \PY{k}{else}\PY{p}{:}
                     \PY{n}{p1}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{p}{,}\PY{n}{yt\PYZus{}ocean}\PY{p}{,}\PY{n}{pert\PYZus{}i}\PY{o}{.}\PY{n}{CN}\PY{p}{[}\PY{p}{(}\PY{n}{yr}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{*}\PY{l+m+mi}{12}\PY{o}{+}\PY{n}{i}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ct}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{CMRmap\PYZus{}r}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
                     
                 \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.7)}
                 \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}Conc.\PYZsq{})}
                 \PY{c+c1}{\PYZsh{}clev3 = np.arange(0,5000,1000)}
                 \PY{c+c1}{\PYZsh{}plt.contour(xt\PYZus{}ocean,yt\PYZus{}ocean,ht,levels=clev3,colors=\PYZsq{}k\PYZsq{},linewidths=0.25)}
                 \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
                 \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{80}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{55}\PY{p}{)}\PY{p}{)}
                 \PY{c+c1}{\PYZsh{}plt.xlabel(\PYZsq{}Longitude (\PYZdl{}\PYZca{}\PYZbs{}circ\PYZdl{})\PYZsq{})}
                 \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{n}{yr}\PY{p}{]}\PY{p}{)}
                 \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{80}\PY{p}{,}\PY{l+m+mi}{40}\PY{p}{]}\PY{p}{)}
                 \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{tits}\PY{p}{[}\PY{n}{i}\PY{o}{\PYZhy{}}\PY{l+m+mi}{5}\PY{p}{]}\PY{p}{)}     
                 \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{axes}\PY{o}{.}\PY{n}{get\PYZus{}xaxis}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{set\PYZus{}ticks}\PY{p}{(}\PY{p}{[}\PY{p}{]}\PY{p}{)}
                 \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{axes}\PY{o}{.}\PY{n}{get\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{set\PYZus{}ticks}\PY{p}{(}\PY{p}{[}\PY{p}{]}\PY{p}{)}
                 
                 \PY{n}{ii}\PY{o}{+}\PY{o}{=}\PY{l+m+mi}{1}
         
         \PY{n}{ax3} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{axes}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.92}\PY{p}{,}\PY{l+m+mf}{0.38}\PY{p}{,}\PY{l+m+mf}{0.015}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{]}\PY{p}{)}
         \PY{n}{cb} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{p1}\PY{p}{,}\PY{n}{cax}\PY{o}{=}\PY{n}{ax3}\PY{p}{,}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Conc.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}cn.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cn.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
['June', 'July', 'Aug.', 'Sept.', 'Oct.', 'Nov.']

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_14_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{n}{Ocean\PYZus{}File} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{output197*/ocean\PYZus{}\PYZus{}*.nc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{k}{print} \PY{n}{Ocean\PYZus{}File}
         \PY{n}{cntrl}\PY{o}{=}\PY{n}{xr}\PY{o}{.}\PY{n}{open\PYZus{}mfdataset}\PY{p}{(}\PY{n}{Ocean\PYZus{}File}\PY{p}{,}\PY{n}{engine}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{netcdf4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{concat\PYZus{}dim}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{decode\PYZus{}times}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         
         \PY{n}{Ocean\PYZus{}File} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{output19*/ocean\PYZus{}\PYZus{}*.nc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{k}{print} \PY{n}{Ocean\PYZus{}File}
         \PY{n}{pert}\PY{o}{=}\PY{n}{xr}\PY{o}{.}\PY{n}{open\PYZus{}mfdataset}\PY{p}{(}\PY{n}{Ocean\PYZus{}File}\PY{p}{,}\PY{n}{engine}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{netcdf4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{concat\PYZus{}dim}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{decode\PYZus{}times}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
/g/data1/v45/pas561/mom/archive/wombat\_jun16z/output197*/ocean\_\_*.nc
/g/data1/v45/pas561/mom/archive/wombat\_jun16z\_wp2/output19*/ocean\_\_*.nc

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{k}{print} \PY{n}{cntrl}\PY{o}{.}\PY{n}{mld}\PY{o}{.}\PY{n}{shape}
         \PY{k}{print} \PY{n}{pert}\PY{o}{.}\PY{n}{mld}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(9, 1080, 1440)
(29, 1080, 1440)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{c+c1}{\PYZsh{}plot MLD}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{12.5}\PY{p}{,}\PY{l+m+mf}{9.5}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{MLD}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{2000}\PY{p}{,}\PY{l+m+mi}{50}\PY{p}{)}
         \PY{n}{yrs}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1972}\PY{p}{,}\PY{l+m+mi}{2016}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{4}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{55}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
         \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{)} 
         \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{cntrl}\PY{o}{.}\PY{n}{mld}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
         \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.7)}
         \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}N/m2\PYZsq{})}
         \PY{n}{clev3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{5000}\PY{p}{,}\PY{l+m+mi}{1000}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{ht}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev3}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
         
         
         \PY{n}{ii}\PY{o}{=}\PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{yr} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{15}\PY{p}{)}\PY{p}{:}
             \PY{c+c1}{\PYZsh{}print yr}
         
             \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{4}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{,}\PY{n}{yr}\PY{o}{+}\PY{l+m+mi}{2}\PY{p}{)}
             \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{55}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
             \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
             \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
             \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
             \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
             \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{)} 
             \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{pert}\PY{o}{.}\PY{n}{mld}\PY{p}{[}\PY{n}{yr}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
             \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.5)}
             \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}N/m2\PYZsq{})}
             \PY{n}{clev3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{5000}\PY{p}{,}\PY{l+m+mi}{1000}\PY{p}{)}
             \PY{n+nb}{map}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{ht}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev3}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{n}{yr}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
         
         \PY{n}{ax3} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{axes}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.92}\PY{p}{,}\PY{l+m+mf}{0.38}\PY{p}{,}\PY{l+m+mf}{0.015}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{]}\PY{p}{)}
         \PY{n}{cb} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{p1}\PY{p}{,}\PY{n}{cax}\PY{o}{=}\PY{n}{ax3}\PY{p}{,}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{m}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}mld.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mld.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_17_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}21}]:} \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{100}\PY{p}{,}\PY{l+m+mi}{2000}\PY{p}{,}\PY{l+m+mi}{100}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{55}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
         \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{)} 
         \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{pert}\PY{o}{.}\PY{n}{mld}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl}\PY{o}{.}\PY{n}{mld}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{m}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{clev3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1000}\PY{p}{,}\PY{l+m+mi}{5001}\PY{p}{,}\PY{l+m+mi}{1000}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{ht}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev3}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{MLD Anom 1975}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{55}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
         \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{)} 
         \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{pert}\PY{o}{.}\PY{n}{mld}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl}\PY{o}{.}\PY{n}{mld}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{m}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{clev3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1000}\PY{p}{,}\PY{l+m+mi}{5001}\PY{p}{,}\PY{l+m+mi}{1000}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{ht}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev3}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{MLD Anom 1976}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}mld\PYZus{}1975anom.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mld\PYZus{}1975anom.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_18_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \hypertarget{calc-the-gmoc-from-ty_trans_rho}{%
\subsection{Calc the GMOC from
ty\_trans\_rho}\label{calc-the-gmoc-from-ty_trans_rho}}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}22}]:} \PY{k}{print} \PY{n}{pert}\PY{o}{.}\PY{n}{ty\PYZus{}trans\PYZus{}rho}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{pert\PYZus{}gmoc}\PY{o}{=}\PY{n}{pert}\PY{o}{.}\PY{n}{ty\PYZus{}trans\PYZus{}rho}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{grid\PYZus{}xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{cumsum}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{potrho}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
         
         \PY{k}{print} \PY{n}{pert\PYZus{}gmoc}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gmoc\PYZus{}rho.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{a}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{pert\PYZus{}gmoc}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(29, 80, 1080, 1440)
(29, 80, 1080)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}23}]:} \PY{k}{print} \PY{n}{cntrl}\PY{o}{.}\PY{n}{ty\PYZus{}trans\PYZus{}rho}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{cntrl\PYZus{}gmoc}\PY{o}{=}\PY{n}{cntrl}\PY{o}{.}\PY{n}{ty\PYZus{}trans\PYZus{}rho}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{grid\PYZus{}xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{cumsum}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{potrho}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
         
         \PY{k}{print} \PY{n}{cntrl\PYZus{}gmoc}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gmoc\PYZus{}rho.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{a}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{cntrl\PYZus{}gmoc}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(9, 80, 1080, 1440)
(9, 80, 1080)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}24}]:} \PY{c+c1}{\PYZsh{}load gmoc in rho space}
         \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gmoc\PYZus{}rho.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{pert\PYZus{}gmoc}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n}{of}\PY{p}{)}
         \PY{k}{print} \PY{n}{pert\PYZus{}gmoc}\PY{o}{.}\PY{n}{shape}
         
         \PY{c+c1}{\PYZsh{}of=os.path.join(NYFCntrlDir,\PYZsq{}cntrl\PYZus{}gmocs.npy\PYZsq{})}
         \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gmoc\PYZus{}rho.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cntrl\PYZus{}gmoc}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n}{of}\PY{p}{)}
         \PY{k}{print} \PY{n}{cntrl\PYZus{}gmoc}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(29, 80, 1080)
(9, 80, 1080)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}26}]:} \PY{n}{yrs}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1973}\PY{p}{,}\PY{l+m+mi}{2016}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{k}{print} \PY{n}{yrs}
         \PY{k}{print} \PY{n}{yrs}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[1973 1974 1975 1976 1977 1978 1979 1980 1981 1982 1983 1984 1985 1986 1987
 1988 1989 1990 1991 1992 1993 1994 1995 1996 1997 1998 1999 2000 2001 2002
 2003 2004 2005 2006 2007 2008 2009 2010 2011 2012 2013 2014 2015]
['1973' '1974' '1975' '1976' '1977' '1978' '1979' '1980' '1981' '1982'
 '1983' '1984' '1985' '1986' '1987' '1988' '1989' '1990' '1991' '1992'
 '1993' '1994' '1995' '1996' '1997' '1998' '1999' '2000' '2001' '2002'
 '2003' '2004' '2005' '2006' '2007' '2008' '2009' '2010' '2011' '2012'
 '2013' '2014' '2015']

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}27}]:} \PY{c+c1}{\PYZsh{}plot gmoc in rho space}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{9.5}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Annual Mean GMOC}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{30}\PY{p}{,}\PY{l+m+mi}{32}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         
         \PY{n}{t1}\PY{o}{=}\PY{l+m+mi}{0}
         \PY{n}{t2}\PY{o}{=}\PY{l+m+mi}{5}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{541}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{p}{[}\PY{l+m+mf}{0.0}\PY{p}{,}\PY{p}{]}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{(}\PY{l+m+mf}{1037.2}\PY{p}{,}\PY{l+m+mi}{1036}\PY{p}{)}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Density (kg m\PYZdl{}\PYZca{}\PYZob{}\PYZhy{}3\PYZcb{}\PYZdl{})}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Latitude (\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{})}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{)}
         \PY{n}{tit}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1972}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{tit}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{1036.86}\PY{p}{,}\PY{l+m+mf}{1036.86}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         
         \PY{n}{ii}\PY{o}{=}\PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{yr} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{19}\PY{p}{)}\PY{p}{:}
             
             \PY{c+c1}{\PYZsh{}np.mean(pert\PYZus{}gmoc[t1:t2,:,:],axis=0)\PYZhy{}np.mean(cntrl\PYZus{}gmoc[t1:t2,:,:],axis=0)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{,}\PY{n}{yr}\PY{o}{+}\PY{l+m+mi}{2}\PY{p}{)}
             \PY{n}{p1}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{pert\PYZus{}gmoc}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.7)}
             \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}Sv\PYZsq{})}
             \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{pert\PYZus{}gmoc}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{pert\PYZus{}gmoc}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{p}{[}\PY{l+m+mf}{0.0}\PY{p}{,}\PY{p}{]}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{(}\PY{l+m+mf}{1037.2}\PY{p}{,}\PY{l+m+mi}{1036}\PY{p}{)}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}plt.ylabel(\PYZsq{}Density (kg m\PYZdl{}\PYZca{}\PYZob{}\PYZhy{}3\PYZcb{}\PYZdl{})\PYZsq{})}
             \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Latitude (\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{})}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{)}
             \PY{n}{tit}\PY{o}{=}\PY{n}{yrs}\PY{p}{[}\PY{n}{yr}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{n}{yr}\PY{p}{]}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{1036.86}\PY{p}{,}\PY{l+m+mf}{1036.86}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         
         \PY{n}{ax3} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{axes}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.92}\PY{p}{,}\PY{l+m+mf}{0.38}\PY{p}{,}\PY{l+m+mf}{0.015}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{]}\PY{p}{)}
         \PY{n}{cb} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{p1}\PY{p}{,}\PY{n}{cax}\PY{o}{=}\PY{n}{ax3}\PY{p}{,}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}wpm2\PYZus{}cn.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}wpm2\PYZus{}cn.png\PYZsq{})}
         \PY{c+c1}{\PYZsh{}plt.savefig(of,dpi=220)}
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}gmoc.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gmoc.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_24_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}29}]:} \PY{c+c1}{\PYZsh{}plot gmoc anom in rho space}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{9.5}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GMOC Anomaly}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{30}\PY{p}{,}\PY{l+m+mi}{32}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         
         \PY{n}{t1}\PY{o}{=}\PY{l+m+mi}{0}
         \PY{n}{t2}\PY{o}{=}\PY{l+m+mi}{5}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{541}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{p}{[}\PY{l+m+mf}{0.0}\PY{p}{,}\PY{p}{]}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{(}\PY{l+m+mf}{1037.2}\PY{p}{,}\PY{l+m+mf}{1036.4}\PY{p}{)}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Density (kg m\PYZdl{}\PYZca{}\PYZob{}\PYZhy{}3\PYZcb{}\PYZdl{})}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Latitude (\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{})}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{)}
         \PY{n}{tit}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Control}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{tit}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{1036.86}\PY{p}{,}\PY{l+m+mf}{1036.86}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{yrs}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1973}\PY{p}{,}\PY{l+m+mi}{2016}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{ii}\PY{o}{=}\PY{l+m+mi}{0}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mf}{5.25}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{)}
         
         
         \PY{k}{for} \PY{n}{yr} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{19}\PY{p}{)}\PY{p}{:}
             
             \PY{c+c1}{\PYZsh{}np.mean(pert\PYZus{}gmoc[t1:t2,:,:],axis=0)\PYZhy{}np.mean(cntrl\PYZus{}gmoc[t1:t2,:,:],axis=0)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{,}\PY{n}{yr}\PY{o}{+}\PY{l+m+mi}{2}\PY{p}{)}
             \PY{n}{p1}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{potrho}\PY{p}{,}\PY{n}{pert\PYZus{}gmoc}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.7)}
             \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}Sv\PYZsq{})}
             \PY{c+c1}{\PYZsh{}plt.contour(yu\PYZus{}ocean,potrho,pert\PYZus{}gmoc[yr,:,:]\PYZhy{}cntrl\PYZus{}gmoc[yr,:,:],levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=0.25)}
             \PY{c+c1}{\PYZsh{}plt.contour(yu\PYZus{}ocean,potrho,pert\PYZus{}gmoc[yr,:,:]\PYZhy{}cntrl\PYZus{}gmoc[yr,:,:],levels=[0.0,],colors=\PYZsq{}k\PYZsq{},linewidths=0.5)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{(}\PY{l+m+mf}{1037.2}\PY{p}{,}\PY{l+m+mf}{1036.4}\PY{p}{)}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}plt.ylabel(\PYZsq{}Density (kg m\PYZdl{}\PYZca{}\PYZob{}\PYZhy{}3\PYZcb{}\PYZdl{})\PYZsq{})}
             \PY{c+c1}{\PYZsh{}plt.xlabel(\PYZsq{}Latitude (\PYZdl{}\PYZca{}\PYZbs{}circ\PYZdl{})\PYZsq{})}
             \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{)}
             \PY{n}{tit}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Anom. }\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{yrs}\PY{p}{[}\PY{n}{yr}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{n}{yr}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{20}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{1036.86}\PY{p}{,}\PY{l+m+mf}{1036.86}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
             
         \PY{n}{ax3} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{axes}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.92}\PY{p}{,}\PY{l+m+mf}{0.38}\PY{p}{,}\PY{l+m+mf}{0.015}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{]}\PY{p}{)}
         \PY{n}{cb} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{p1}\PY{p}{,}\PY{n}{cax}\PY{o}{=}\PY{n}{ax3}\PY{p}{,}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}wpm2\PYZus{}cn.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}wpm2\PYZus{}cn.png\PYZsq{})}
         \PY{c+c1}{\PYZsh{}plt.savefig(of,dpi=220)}
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}gmoc\PYZus{}anom.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gmoc\PYZus{}anom.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_25_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}30}]:} \PY{c+c1}{\PYZsh{}plot time series of AABW}
         \PY{n}{T}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{50}\PY{p}{)}
         \PY{k}{print} \PY{n}{T}\PY{o}{.}\PY{n}{shape}
         
         
         \PY{n}{z1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{potrho}\PY{o}{\PYZlt{}}\PY{l+m+mf}{1036.86}\PY{p}{)}
         \PY{n}{z1}\PY{o}{=}\PY{n}{z1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         
         \PY{n}{ts}\PY{o}{=}\PY{n}{pert\PYZus{}gmoc}\PY{o}{.}\PY{n}{shape}
         \PY{n}{ts}\PY{o}{=}\PY{n}{ts}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         \PY{k}{print} \PY{n}{ts}
         
         \PY{c+c1}{\PYZsh{} do lower cell average between lats 60\PYZhy{}65S}
         \PY{n}{j1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mf}{69.9}\PY{p}{)}
         \PY{n}{j2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{60}\PY{p}{)}
         \PY{n}{j1}\PY{o}{=}\PY{n}{j1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{j2}\PY{o}{=}\PY{n}{j2}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         
         \PY{n}{lc\PYZus{}cntrl60\PYZus{}psj} \PY{o}{=} \PY{n}{cntrl\PYZus{}gmoc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}
         \PY{n}{lc\PYZus{}cntrl60\PYZus{}psj\PYZus{}bar} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{lc\PYZus{}cntrl60\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{lc\PYZus{}cntrl60\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{lc\PYZus{}cntrl60\PYZus{}psj\PYZus{}bar}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{lc\PYZus{}pert60\PYZus{}psj} \PY{o}{=} \PY{n}{pert\PYZus{}gmoc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}
         \PY{n}{lc\PYZus{}pert60\PYZus{}psj\PYZus{}bar} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{lc\PYZus{}pert60\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{lc\PYZus{}pert60\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{lc\PYZus{}pert60\PYZus{}psj\PYZus{}bar}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{lc\PYZus{}anom60\PYZus{}psj} \PY{o}{=} \PY{n}{pert\PYZus{}gmoc}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{ts}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{n}{lc\PYZus{}max\PYZus{}anom60\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{lc\PYZus{}anom60\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{lc\PYZus{}max\PYZus{}anom60\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{lc\PYZus{}max\PYZus{}anom60\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{lc\PYZus{}max\PYZus{}anom60\PYZus{}psj\PYZus{}ts}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{insert}\PY{p}{(}\PY{n}{lc\PYZus{}max\PYZus{}anom60\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{n}{lc\PYZus{}max60\PYZus{}ts} \PY{o}{=} \PY{n}{lc\PYZus{}max\PYZus{}anom60\PYZus{}psj\PYZus{}ts} \PY{o}{+} \PY{n}{lc\PYZus{}cntrl60\PYZus{}psj\PYZus{}ts}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         
         \PY{n}{lc\PYZus{}min\PYZus{}anom60\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{lc\PYZus{}anom60\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{lc\PYZus{}min\PYZus{}anom60\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{lc\PYZus{}min\PYZus{}anom60\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{lc\PYZus{}min\PYZus{}anom60\PYZus{}psj\PYZus{}ts}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{insert}\PY{p}{(}\PY{n}{lc\PYZus{}min\PYZus{}anom60\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{n}{lc\PYZus{}min60\PYZus{}ts} \PY{o}{=} \PY{n}{lc\PYZus{}min\PYZus{}anom60\PYZus{}psj\PYZus{}ts} \PY{o}{+} \PY{n}{lc\PYZus{}cntrl60\PYZus{}psj\PYZus{}ts}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         
         \PY{c+c1}{\PYZsh{}print lc\PYZus{}max\PYZus{}ts}
         \PY{c+c1}{\PYZsh{}print lc\PYZus{}min\PYZus{}ts}
         
         \PY{c+c1}{\PYZsh{} do lower cell average between lats 40\PYZhy{}45S}
         \PY{n}{j1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mf}{49.9}\PY{p}{)}
         \PY{n}{j2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{40}\PY{p}{)}
         \PY{n}{j1}\PY{o}{=}\PY{n}{j1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{j2}\PY{o}{=}\PY{n}{j2}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         
         \PY{n}{lc\PYZus{}cntrl40\PYZus{}psj} \PY{o}{=} \PY{n}{cntrl\PYZus{}gmoc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}
         \PY{n}{lc\PYZus{}cntrl40\PYZus{}psj\PYZus{}bar} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{lc\PYZus{}cntrl40\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{lc\PYZus{}cntrl40\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{lc\PYZus{}cntrl40\PYZus{}psj\PYZus{}bar}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{lc\PYZus{}pert40\PYZus{}psj} \PY{o}{=} \PY{n}{pert\PYZus{}gmoc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}
         \PY{n}{lc\PYZus{}pert40\PYZus{}psj\PYZus{}bar} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{lc\PYZus{}pert40\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{lc\PYZus{}pert40\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{lc\PYZus{}pert40\PYZus{}psj\PYZus{}bar}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{lc\PYZus{}anom40\PYZus{}psj} \PY{o}{=} \PY{n}{pert\PYZus{}gmoc}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{ts}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
         
         \PY{n}{lc\PYZus{}max\PYZus{}anom40\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{lc\PYZus{}anom40\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{lc\PYZus{}max\PYZus{}anom40\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{lc\PYZus{}max\PYZus{}anom40\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{lc\PYZus{}max\PYZus{}anom40\PYZus{}psj\PYZus{}ts}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{insert}\PY{p}{(}\PY{n}{lc\PYZus{}max\PYZus{}anom40\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{n}{lc\PYZus{}max40\PYZus{}ts} \PY{o}{=} \PY{n}{lc\PYZus{}max\PYZus{}anom40\PYZus{}psj\PYZus{}ts} \PY{o}{+} \PY{n}{lc\PYZus{}cntrl40\PYZus{}psj\PYZus{}ts}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         
         \PY{n}{lc\PYZus{}min\PYZus{}anom40\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{lc\PYZus{}anom40\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{lc\PYZus{}min\PYZus{}anom40\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{lc\PYZus{}min\PYZus{}anom40\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{lc\PYZus{}min\PYZus{}anom40\PYZus{}psj\PYZus{}ts}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{insert}\PY{p}{(}\PY{n}{lc\PYZus{}min\PYZus{}anom40\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{n}{lc\PYZus{}min40\PYZus{}ts} \PY{o}{=} \PY{n}{lc\PYZus{}min\PYZus{}anom40\PYZus{}psj\PYZus{}ts} \PY{o}{+} \PY{n}{lc\PYZus{}cntrl40\PYZus{}psj\PYZus{}ts}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         
         \PY{c+c1}{\PYZsh{} do lower cell average between lats 20\PYZhy{}25S}
         \PY{n}{j1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mf}{59.9}\PY{p}{)}
         \PY{n}{j2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{50}\PY{p}{)}
         \PY{n}{j1}\PY{o}{=}\PY{n}{j1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{j2}\PY{o}{=}\PY{n}{j2}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         
         \PY{n}{lc\PYZus{}cntrl50\PYZus{}psj} \PY{o}{=} \PY{n}{cntrl\PYZus{}gmoc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}
         \PY{n}{lc\PYZus{}cntrl50\PYZus{}psj\PYZus{}bar} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{lc\PYZus{}cntrl50\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{lc\PYZus{}cntrl50\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{lc\PYZus{}cntrl50\PYZus{}psj\PYZus{}bar}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{lc\PYZus{}pert50\PYZus{}psj} \PY{o}{=} \PY{n}{pert\PYZus{}gmoc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}
         \PY{n}{lc\PYZus{}pert50\PYZus{}psj\PYZus{}bar} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{lc\PYZus{}pert50\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{lc\PYZus{}pert50\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{lc\PYZus{}pert50\PYZus{}psj\PYZus{}bar}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{lc\PYZus{}anom50\PYZus{}psj} \PY{o}{=} \PY{n}{pert\PYZus{}gmoc}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{ts}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}gmoc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
         
         \PY{n}{lc\PYZus{}max\PYZus{}anom50\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{lc\PYZus{}anom50\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{lc\PYZus{}max\PYZus{}anom50\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{lc\PYZus{}max\PYZus{}anom50\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{lc\PYZus{}max\PYZus{}anom50\PYZus{}psj\PYZus{}ts}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{insert}\PY{p}{(}\PY{n}{lc\PYZus{}max\PYZus{}anom50\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{n}{lc\PYZus{}max50\PYZus{}ts} \PY{o}{=} \PY{n}{lc\PYZus{}max\PYZus{}anom50\PYZus{}psj\PYZus{}ts} \PY{o}{+} \PY{n}{lc\PYZus{}cntrl50\PYZus{}psj\PYZus{}ts}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         
         \PY{n}{lc\PYZus{}min\PYZus{}anom50\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{lc\PYZus{}anom50\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{lc\PYZus{}min\PYZus{}anom50\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{lc\PYZus{}min\PYZus{}anom50\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{lc\PYZus{}min\PYZus{}anom50\PYZus{}psj\PYZus{}ts}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{insert}\PY{p}{(}\PY{n}{lc\PYZus{}min\PYZus{}anom50\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{n}{lc\PYZus{}min50\PYZus{}ts} \PY{o}{=} \PY{n}{lc\PYZus{}min\PYZus{}anom50\PYZus{}psj\PYZus{}ts} \PY{o}{+} \PY{n}{lc\PYZus{}cntrl50\PYZus{}psj\PYZus{}ts}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{211}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{lc\PYZus{}cntrl60\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{60\PYZhy{}70\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}S}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{lc\PYZus{}pert60\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{60\PYZhy{}70\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}S}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{lc\PYZus{}cntrl50\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{50\PYZhy{}60\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}S}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{lc\PYZus{}pert50\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{50\PYZhy{}60\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}S}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{lc\PYZus{}cntrl40\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{40\PYZhy{}50\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}S}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{lc\PYZus{}pert40\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{40\PYZhy{}50\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}S}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.plot(lc\PYZus{}max40\PYZus{}ts,linestyle=\PYZsq{}:\PYZsq{},color=\PYZsq{}g\PYZsq{},linewidth=1.5)}
         \PY{c+c1}{\PYZsh{}plt.plot(lc\PYZus{}min40\PYZus{}ts,linestyle=\PYZsq{}:\PYZsq{},color=\PYZsq{}b\PYZsq{},linewidth=1.5)}
         \PY{c+c1}{\PYZsh{}plt.plot(lc\PYZus{}cntrl40\PYZus{}psj\PYZus{}ts,linestyle=\PYZsq{}:\PYZsq{},color=\PYZsq{}k\PYZsq{},label=\PYZsq{}40\PYZhy{}50\PYZdl{}\PYZca{}\PYZbs{}circ\PYZdl{}S\PYZsq{},linewidth=2)}
         \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1035))}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Transport (Sv)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Years}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.xlim([\PYZhy{}75,85])}
         \PY{n}{tit}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GMOC Lower Cell Rho \PYZgt{} }\PY{l+s+s1}{\PYZsq{}} \PY{o}{+}\PY{n+nb}{str}\PY{p}{(}\PY{n}{potrho}\PY{p}{[}\PY{n}{z1}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{tit}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{212}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{lc\PYZus{}max60\PYZus{}ts}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max 60\PYZhy{}70\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}S}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{1.5}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{lc\PYZus{}min60\PYZus{}ts}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{min 60\PYZhy{}70\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}S}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{1.5}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{lc\PYZus{}cntrl60\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{60\PYZhy{}70\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}S}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{lc\PYZus{}max50\PYZus{}ts}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{max 50\PYZhy{}60\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}S}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{1.5}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{lc\PYZus{}min50\PYZus{}ts}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{min 50\PYZhy{}60\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}S}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{1.5}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{lc\PYZus{}cntrl50\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{50\PYZhy{}60\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}S}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.plot(lc\PYZus{}max40\PYZus{}ts,linestyle=\PYZsq{}:\PYZsq{},color=\PYZsq{}g\PYZsq{},linewidth=1.5)}
         \PY{c+c1}{\PYZsh{}plt.plot(lc\PYZus{}min40\PYZus{}ts,linestyle=\PYZsq{}:\PYZsq{},color=\PYZsq{}b\PYZsq{},linewidth=1.5)}
         \PY{c+c1}{\PYZsh{}plt.plot(lc\PYZus{}cntrl40\PYZus{}psj\PYZus{}ts,linestyle=\PYZsq{}:\PYZsq{},color=\PYZsq{}k\PYZsq{},label=\PYZsq{}40\PYZhy{}50\PYZdl{}\PYZca{}\PYZbs{}circ\PYZdl{}S\PYZsq{},linewidth=2)}
         \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1035))}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Transport (Sv)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Years}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.xlim([\PYZhy{}75,85])}
         \PY{n}{tit}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GMOC Lower Cell Rho Min/Max Anom \PYZgt{} }\PY{l+s+s1}{\PYZsq{}} \PY{o}{+}\PY{n+nb}{str}\PY{p}{(}\PY{n}{potrho}\PY{p}{[}\PY{n}{z1}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{tit}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}gmoc\PYZus{}ts.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gmoc\PYZus{}ts.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(50,)
29

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/ipykernel/\_\_main\_\_.py:19: VisibleDeprecationWarning: converting an array with ndim > 0 to an index will result in an error in the future
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/ipykernel/\_\_main\_\_.py:23: VisibleDeprecationWarning: converting an array with ndim > 0 to an index will result in an error in the future
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/ipykernel/\_\_main\_\_.py:27: VisibleDeprecationWarning: converting an array with ndim > 0 to an index will result in an error in the future
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/ipykernel/\_\_main\_\_.py:47: VisibleDeprecationWarning: converting an array with ndim > 0 to an index will result in an error in the future
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/ipykernel/\_\_main\_\_.py:51: VisibleDeprecationWarning: converting an array with ndim > 0 to an index will result in an error in the future
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/ipykernel/\_\_main\_\_.py:55: VisibleDeprecationWarning: converting an array with ndim > 0 to an index will result in an error in the future
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/ipykernel/\_\_main\_\_.py:73: VisibleDeprecationWarning: converting an array with ndim > 0 to an index will result in an error in the future
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/ipykernel/\_\_main\_\_.py:77: VisibleDeprecationWarning: converting an array with ndim > 0 to an index will result in an error in the future
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/ipykernel/\_\_main\_\_.py:81: VisibleDeprecationWarning: converting an array with ndim > 0 to an index will result in an error in the future

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_26_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}31}]:} \PY{c+c1}{\PYZsh{}calc tx transport, acc transport}
         \PY{n}{cntrl\PYZus{}psi}\PY{o}{=}\PY{n}{cntrl}\PY{o}{.}\PY{n}{tx\PYZus{}trans}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{st\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{cumsum}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
         \PY{k}{print} \PY{n}{cntrl\PYZus{}psi}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{psi.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{a}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{cntrl\PYZus{}psi}\PY{p}{)}
         
         
         \PY{c+c1}{\PYZsh{}pert\PYZus{}psi=ff.tx\PYZus{}trans[:,:,:,:].sum(\PYZsq{}st\PYZus{}ocean\PYZsq{}).cumsum(\PYZsq{}yt\PYZus{}ocean\PYZsq{}).load()}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(9, 1080, 1440)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}32}]:} \PY{c+c1}{\PYZsh{}calc tx transport, acc transport}
         \PY{n}{pert\PYZus{}psi}\PY{o}{=}\PY{n}{pert}\PY{o}{.}\PY{n}{tx\PYZus{}trans}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{st\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{cumsum}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
         \PY{k}{print} \PY{n}{pert\PYZus{}psi}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{psi.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{a}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{pert\PYZus{}psi}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(29, 1080, 1440)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}33}]:} \PY{c+c1}{\PYZsh{}load acc psi}
         \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{psi.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{pert\PYZus{}psi}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n}{of}\PY{p}{)}
         \PY{k}{print} \PY{n}{pert\PYZus{}psi}\PY{o}{.}\PY{n}{shape}
         
         \PY{c+c1}{\PYZsh{}of=os.path.join(NYFCntrlDir,\PYZsq{}cntrl\PYZus{}gmocs.npy\PYZsq{})}
         \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{psi.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cntrl\PYZus{}psi}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n}{of}\PY{p}{)}
         \PY{k}{print} \PY{n}{cntrl\PYZus{}psi}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(29, 1080, 1440)
(9, 1080, 1440)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}34}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{9.5}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plot ACC transport}
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{200}\PY{p}{,}\PY{l+m+mi}{200}\PY{p}{,}\PY{l+m+mi}{21}\PY{p}{)}
         \PY{k}{print} \PY{n}{clev}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{45}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
         \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{)} 
         \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}psi}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{5}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}clev3 = np.arange(0,200,20)}
         \PY{c+c1}{\PYZsh{}print clev3}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}psi}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{5}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{clev3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1000}\PY{p}{,}\PY{l+m+mi}{5001}\PY{p}{,}\PY{l+m+mi}{1000}\PY{p}{)}
         \PY{k}{print} \PY{n}{clev3}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{ht}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev3}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{c}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}    
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Control Psi}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{45}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
         \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{)} 
         \PY{n}{clev3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{5600}\PY{p}{,}\PY{l+m+mi}{100}\PY{p}{)}
         \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{ht}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev3}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{m}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}clev3 = np.arange(0,200,20)}
         \PY{c+c1}{\PYZsh{}print clev3}
         
         \PY{n}{clev3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1000}\PY{p}{,}\PY{l+m+mi}{5001}\PY{p}{,}\PY{l+m+mi}{1000}\PY{p}{)}
         \PY{k}{print} \PY{n}{clev3}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{ht}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev3}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}    
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Control Bathy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[-200. -180. -160. -140. -120. -100.  -80.  -60.  -40.  -20.    0.   20.
   40.   60.   80.  100.  120.  140.  160.  180.  200.]
[1000 2000 3000 4000 5000]
[1000 2000 3000 4000 5000]

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}34}]:} Text(0.5,1,u'Control Bathy')
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_31_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}36}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{9.5}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Psi Anom}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plot ACC transport}
         \PY{n}{yrs}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1973}\PY{p}{,}\PY{l+m+mi}{2016}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{ii}\PY{o}{=}\PY{l+m+mi}{0}
         
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{21}\PY{p}{)}
         
         \PY{k}{for} \PY{n}{yr} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{19}\PY{p}{)}\PY{p}{:}
             
             \PY{c+c1}{\PYZsh{}np.mean(pert\PYZus{}gmoc[t1:t2,:,:],axis=0)\PYZhy{}np.mean(cntrl\PYZus{}gmoc[t1:t2,:,:],axis=0)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{,}\PY{n}{yr}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{45}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
             \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
             \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
             \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
             \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
             \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{)} 
             \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{pert\PYZus{}psi}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}psi}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
             \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.7)}
             \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}Sv\PYZsq{})}
             \PY{c+c1}{\PYZsh{}clev3 = np.arange(0,200,20)}
             \PY{c+c1}{\PYZsh{}print clev3}
             \PY{c+c1}{\PYZsh{}map.contour(X,Y,np.mean(cntrl\PYZus{}psi[0:5],axis=0),levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=1)}
             
             \PY{n}{tit}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Anom.}\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{yrs}\PY{p}{[}\PY{n}{yr}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{tit}\PY{p}{)}
             
             
         \PY{n}{ax3} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{axes}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.92}\PY{p}{,}\PY{l+m+mf}{0.38}\PY{p}{,}\PY{l+m+mf}{0.015}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{]}\PY{p}{)}
         \PY{n}{cb} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{p1}\PY{p}{,}\PY{n}{cax}\PY{o}{=}\PY{n}{ax3}\PY{p}{,}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}wpm2\PYZus{}cn.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}wpm2\PYZus{}cn.png\PYZsq{})}
         \PY{c+c1}{\PYZsh{}plt.savefig(of,dpi=220)}
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}gmoc\PYZus{}anom.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{psi\PYZus{}anom.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_32_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}37}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{9.5}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{21}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{45}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
         \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{)} 
         \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{pert\PYZus{}psi}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{l+m+mi}{5}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}psi}\PY{p}{[}\PY{l+m+mi}{5}\PY{p}{:}\PY{l+m+mi}{9}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
         \PY{c+c1}{\PYZsh{}p1=map.contourf(X,Y,np.mean(pert\PYZus{}psi[0:5],axis=0)\PYZhy{}np.mean(cntrl\PYZus{}psi[0:5],axis=0), cmap=plt.cm.PiYG, levels=clev, extend=\PYZsq{}both\PYZsq{}) \PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}clev3 = np.arange(0,200,20)}
         \PY{c+c1}{\PYZsh{}print clev3}
         \PY{c+c1}{\PYZsh{}map.contour(X,Y,np.mean(pert\PYZus{}psi[0:5],axis=0)\PYZhy{}np.mean(cntrl\PYZus{}psi[0:5],axis=0),levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=1)}
         \PY{n}{clev3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1000}\PY{p}{,}\PY{l+m+mi}{5001}\PY{p}{,}\PY{l+m+mi}{1000}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{ht}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev3}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}    
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Yr 1\PYZhy{}5 Anom.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}ax3 = plt.axes([0.92,0.38,0.015,0.25])}
         \PY{c+c1}{\PYZsh{}cb = plt.colorbar(p1,cax=ax3,orientation=\PYZsq{}vertical\PYZsq{})}
         \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}ylabel(\PYZsq{}Sv\PYZsq{})}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{45}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
         \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{)} 
         \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{pert\PYZus{}psi}\PY{p}{[}\PY{l+m+mi}{5}\PY{p}{:}\PY{l+m+mi}{10}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}psi}\PY{p}{[}\PY{l+m+mi}{5}\PY{p}{:}\PY{l+m+mi}{9}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}clev3 = np.arange(0,200,20)}
         \PY{c+c1}{\PYZsh{}print clev3}
         \PY{c+c1}{\PYZsh{}map.contour(X,Y,np.mean(pert\PYZus{}psi[4:7],axis=0)\PYZhy{}np.mean(cntrl\PYZus{}psi[4:7],axis=0),levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=1)}
         \PY{n}{clev3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1000}\PY{p}{,}\PY{l+m+mi}{5001}\PY{p}{,}\PY{l+m+mi}{1000}\PY{p}{)}
         \PY{k}{print} \PY{n}{clev3}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{ht}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev3}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}    
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Yr 6\PYZhy{}10 Anom.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}ax3 = plt.axes([0.92,0.38,0.015,0.25])}
         \PY{c+c1}{\PYZsh{}cb = plt.colorbar(p1,cax=ax3,orientation=\PYZsq{}vertical\PYZsq{})}
         \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}ylabel(\PYZsq{}Sv\PYZsq{})}
         
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}psi.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{psi\PYZus{}anom.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[1000 2000 3000 4000 5000]

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_33_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}38}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{45}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
         \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{)} 
         \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{pert\PYZus{}psi}\PY{p}{[}\PY{l+m+mi}{5}\PY{p}{:}\PY{l+m+mi}{10}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}psi}\PY{p}{[}\PY{l+m+mi}{5}\PY{p}{:}\PY{l+m+mi}{9}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}clev3 = np.arange(0,200,20)}
         \PY{c+c1}{\PYZsh{}print clev3}
         \PY{c+c1}{\PYZsh{}map.contour(X,Y,np.mean(pert\PYZus{}psi[4:7],axis=0)\PYZhy{}np.mean(cntrl\PYZus{}psi[4:7],axis=0),levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=1)}
         \PY{n}{clev3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1000}\PY{p}{,}\PY{l+m+mi}{5001}\PY{p}{,}\PY{l+m+mi}{1000}\PY{p}{)}
         \PY{k}{print} \PY{n}{clev3}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{ht}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev3}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}    
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{PSI Pert Yr 6\PYZhy{}10 Anom.}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[1000 2000 3000 4000 5000]

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}38}]:} Text(0.5,1,u'PSI Pert Yr 6-10 Anom.')
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_34_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}39}]:} \PY{c+c1}{\PYZsh{} do psi max between lon 67\PYZhy{}69S}
         \PY{n}{i1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{69}\PY{p}{)}
         \PY{n}{i2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{67}\PY{p}{)}
         \PY{n}{i1}\PY{o}{=}\PY{n}{i1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{i2}\PY{o}{=}\PY{n}{i2}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         
         \PY{n}{j1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{54}\PY{p}{)}
         \PY{n}{j1}\PY{o}{=}\PY{n}{j1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         
         \PY{k}{print} \PY{n}{j1}\PY{p}{,} \PY{n}{i1}\PY{p}{,} \PY{n}{i2}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[239] [843] [851]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}40}]:} \PY{c+c1}{\PYZsh{}plot Drake Passage time series}
         \PY{n}{T}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{50}\PY{p}{)}
         \PY{k}{print} \PY{n}{T}\PY{o}{.}\PY{n}{shape}
         
         \PY{c+c1}{\PYZsh{} do psi max between lon 67\PYZhy{}69S}
         \PY{n}{i1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{69}\PY{p}{)}
         \PY{n}{i2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{67}\PY{p}{)}
         \PY{n}{i1}\PY{o}{=}\PY{n}{i1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{i2}\PY{o}{=}\PY{n}{i2}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         
         \PY{n}{j1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{54}\PY{p}{)}
         \PY{n}{j1}\PY{o}{=}\PY{n}{j1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         
         \PY{k}{print} \PY{n}{j1}\PY{p}{,} \PY{n}{i1}\PY{p}{,} \PY{n}{i2}
         
         \PY{n}{cntrl\PYZus{}dp} \PY{o}{=} \PY{n}{cntrl\PYZus{}psi}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{j1}\PY{p}{,}\PY{n}{i1}\PY{p}{:}\PY{n}{i2}\PY{p}{]}
         \PY{n}{cntrl\PYZus{}dp\PYZus{}bar} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}dp}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{cntrl\PYZus{}dp\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{cntrl\PYZus{}dp\PYZus{}bar}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{pert\PYZus{}dp} \PY{o}{=} \PY{n}{pert\PYZus{}psi}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{n}{j1}\PY{p}{,}\PY{n}{i1}\PY{p}{:}\PY{n}{i2}\PY{p}{]}
         \PY{n}{pert\PYZus{}dp\PYZus{}bar} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{pert\PYZus{}dp}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{pert\PYZus{}dp\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{pert\PYZus{}dp\PYZus{}bar}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{211}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{cntrl\PYZus{}dp\PYZus{}ts}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Control}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{1.5}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{pert\PYZus{}dp\PYZus{}ts}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Perturbed}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1035))}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Transport (Sv)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Years}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.xlim([\PYZhy{}75,85])}
         \PY{n}{tit}\PY{o}{=}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Drake Passage Transport}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{tit}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
         
         
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}dp\PYZus{}ts.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dp\PYZus{}ts.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(50,)
[239] [843] [851]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/ipykernel/\_\_main\_\_.py:16: VisibleDeprecationWarning: converting an array with ndim > 0 to an index will result in an error in the future
/g/data3/hh5/public/apps/miniconda3/envs/analysis27/lib/python2.7/site-packages/ipykernel/\_\_main\_\_.py:20: VisibleDeprecationWarning: converting an array with ndim > 0 to an index will result in an error in the future

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_36_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}41}]:} \PY{c+c1}{\PYZsh{}plot temp}
         \PY{k}{print} \PY{n}{cntrl}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}
         \PY{k}{print} \PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(9, 50, 1080, 1440)
(29, 50, 1080, 1440)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}43}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{12.5}\PY{p}{,}\PY{l+m+mf}{9.5}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Temp Anomaly 55m}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{yrs}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1973}\PY{p}{,}\PY{l+m+mi}{2016}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{41}\PY{p}{)}
         \PY{k}{print} \PY{n}{clev}
         \PY{n}{st}\PY{o}{=}\PY{l+m+mi}{5}
         \PY{k}{print} \PY{n}{st\PYZus{}ocean}\PY{p}{[}\PY{n}{st}\PY{p}{]}
         \PY{n}{ii}\PY{o}{=}\PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{yr} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{)}\PY{p}{:}
             \PY{c+c1}{\PYZsh{}print yr}
         
             \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{,}\PY{n}{yr}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{55}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
             \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
             \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
             \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
             \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
             \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)} 
             \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
             \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.5)}
             \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}N/m2\PYZsq{})}
             \PY{n}{clev3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{5000}\PY{p}{,}\PY{l+m+mi}{1000}\PY{p}{)}
             \PY{n+nb}{map}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{ht}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev3}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{n}{yr}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{ax3} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{axes}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.92}\PY{p}{,}\PY{l+m+mf}{0.38}\PY{p}{,}\PY{l+m+mf}{0.015}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{]}\PY{p}{)}
         \PY{n}{cb} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{p1}\PY{p}{,}\PY{n}{cax}\PY{o}{=}\PY{n}{ax3}\PY{p}{,}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}temp\PYZus{}55m.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{temp\PYZus{}55m.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[-2.  -1.9 -1.8 -1.7 -1.6 -1.5 -1.4 -1.3 -1.2 -1.1 -1.  -0.9 -0.8 -0.7 -0.6
 -0.5 -0.4 -0.3 -0.2 -0.1  0.   0.1  0.2  0.3  0.4  0.5  0.6  0.7  0.8  0.9
  1.   1.1  1.2  1.3  1.4  1.5  1.6  1.7  1.8  1.9  2. ]
55.8532485962

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_38_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}45}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{12.5}\PY{p}{,}\PY{l+m+mf}{9.5}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Temp Anomaly 1500m}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{yrs}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1973}\PY{p}{,}\PY{l+m+mi}{2016}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{o}{.}\PY{l+m+mi}{5}\PY{p}{,}\PY{o}{.}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{41}\PY{p}{)}
         \PY{k}{print} \PY{n}{clev}
         \PY{n}{st}\PY{o}{=}\PY{l+m+mi}{30}
         \PY{k}{print} \PY{n}{st\PYZus{}ocean}\PY{p}{[}\PY{n}{st}\PY{p}{]}
         \PY{n}{ii}\PY{o}{=}\PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{yr} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{)}\PY{p}{:}
             \PY{c+c1}{\PYZsh{}print yr}
         
             \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{,}\PY{n}{yr}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{55}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
             \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
             \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
             \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
             \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
             \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)} 
             \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
             \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.5)}
             \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}N/m2\PYZsq{})}
             \PY{n}{clev3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{5000}\PY{p}{,}\PY{l+m+mi}{1000}\PY{p}{)}
             \PY{n+nb}{map}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{ht}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev3}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{n}{yr}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{ax3} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{axes}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.92}\PY{p}{,}\PY{l+m+mf}{0.38}\PY{p}{,}\PY{l+m+mf}{0.015}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{]}\PY{p}{)}
         \PY{n}{cb} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{p1}\PY{p}{,}\PY{n}{cax}\PY{o}{=}\PY{n}{ax3}\PY{p}{,}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}temp\PYZus{}1500m.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{temp\PYZus{}1500m.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[-0.5   -0.475 -0.45  -0.425 -0.4   -0.375 -0.35  -0.325 -0.3   -0.275
 -0.25  -0.225 -0.2   -0.175 -0.15  -0.125 -0.1   -0.075 -0.05  -0.025  0.
  0.025  0.05   0.075  0.1    0.125  0.15   0.175  0.2    0.225  0.25
  0.275  0.3    0.325  0.35   0.375  0.4    0.425  0.45   0.475  0.5  ]
1497.56188965

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_39_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}46}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{12.5}\PY{p}{,}\PY{l+m+mf}{9.5}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Temp Anomaly 4000m}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{yrs}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1973}\PY{p}{,}\PY{l+m+mi}{2016}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{o}{.}\PY{l+m+mi}{5}\PY{p}{,}\PY{o}{.}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{41}\PY{p}{)}
         \PY{k}{print} \PY{n}{clev}
         \PY{n}{st}\PY{o}{=}\PY{l+m+mi}{42}
         \PY{k}{print} \PY{n}{st\PYZus{}ocean}\PY{p}{[}\PY{n}{st}\PY{p}{]}
         \PY{n}{ii}\PY{o}{=}\PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{yr} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{)}\PY{p}{:}
             \PY{c+c1}{\PYZsh{}print yr}
         
             \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{,}\PY{n}{yr}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{55}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
             \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
             \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
             \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
             \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
             \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)} 
             \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
             \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.5)}
             \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}N/m2\PYZsq{})}
             \PY{n}{clev3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{5000}\PY{p}{,}\PY{l+m+mi}{1000}\PY{p}{)}
             \PY{n+nb}{map}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{ht}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev3}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{n}{yr}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{ax3} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{axes}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.92}\PY{p}{,}\PY{l+m+mf}{0.38}\PY{p}{,}\PY{l+m+mf}{0.015}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{]}\PY{p}{)}
         \PY{n}{cb} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{p1}\PY{p}{,}\PY{n}{cax}\PY{o}{=}\PY{n}{ax3}\PY{p}{,}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}temp\PYZus{}4000m.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{temp\PYZus{}4000m.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[-0.5   -0.475 -0.45  -0.425 -0.4   -0.375 -0.35  -0.325 -0.3   -0.275
 -0.25  -0.225 -0.2   -0.175 -0.15  -0.125 -0.1   -0.075 -0.05  -0.025  0.
  0.025  0.05   0.075  0.1    0.125  0.15   0.175  0.2    0.225  0.25
  0.275  0.3    0.325  0.35   0.375  0.4    0.425  0.45   0.475  0.5  ]
3926.81274414

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_40_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}47}]:} \PY{k}{print} \PY{n}{st\PYZus{}ocean}\PY{p}{[}\PY{l+m+mi}{45}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
4555.56591797

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}48}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{12.5}\PY{p}{,}\PY{l+m+mf}{9.5}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{o}{.}\PY{l+m+mi}{2}\PY{p}{,}\PY{o}{.}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{21}\PY{p}{)}
         \PY{k}{print} \PY{n}{clev}
         \PY{n}{st}\PY{o}{=}\PY{l+m+mi}{30}
         \PY{k}{print} \PY{n}{st\PYZus{}ocean}\PY{p}{[}\PY{n}{st}\PY{p}{]}
         \PY{n}{yr}\PY{o}{=}\PY{l+m+mi}{5}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{45}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
         \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)} 
         \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{clev3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1000}\PY{p}{,}\PY{l+m+mi}{5001}\PY{p}{,}\PY{l+m+mi}{500}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{ht}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev3}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Temp Anom at 1500m }\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{yrs}\PY{p}{[}\PY{n}{yr}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         
         
         
         \PY{c+c1}{\PYZsh{}ax3 = plt.axes([0.92,0.38,0.015,0.25])}
         \PY{c+c1}{\PYZsh{}cb = plt.colorbar(p1,cax=ax3,orientation=\PYZsq{}vertical\PYZsq{})}
         \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
         \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}C\PYZsq{})}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[-0.2  -0.18 -0.16 -0.14 -0.12 -0.1  -0.08 -0.06 -0.04 -0.02  0.    0.02
  0.04  0.06  0.08  0.1   0.12  0.14  0.16  0.18  0.2 ]
1497.56188965

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}48}]:} Text(0.5,1,u'Temp Anom at 1500m 1978')
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_42_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}49}]:} \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{o}{.}\PY{l+m+mi}{5}\PY{p}{,}\PY{o}{.}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{21}\PY{p}{)}
         \PY{k}{print} \PY{n}{clev}
         
         \PY{n}{st}\PY{o}{=}\PY{l+m+mi}{45}
         \PY{k}{print} \PY{n}{st\PYZus{}ocean}\PY{p}{[}\PY{l+m+mi}{45}\PY{p}{]}
         \PY{n}{yr}\PY{o}{=}\PY{l+m+mi}{5}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{45}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
         \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)} 
         \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{n}{st}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{clev3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1000}\PY{p}{,}\PY{l+m+mi}{5001}\PY{p}{,}\PY{l+m+mi}{500}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{ht}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev3}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Temp Anom at 4500m }\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{yrs}\PY{p}{[}\PY{n}{yr}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
                 
         \PY{c+c1}{\PYZsh{}ax3 = plt.axes([0.92,0.38,0.015,0.25])}
         \PY{c+c1}{\PYZsh{}cb = plt.colorbar(p1,cax=ax3,orientation=\PYZsq{}vertical\PYZsq{})}
         \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
         \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}C\PYZsq{})}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[-0.5  -0.45 -0.4  -0.35 -0.3  -0.25 -0.2  -0.15 -0.1  -0.05  0.    0.05
  0.1   0.15  0.2   0.25  0.3   0.35  0.4   0.45  0.5 ]
4555.56591797

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}49}]:} Text(0.5,1,u'Temp Anom at 4500m 1978')
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_43_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}50}]:} \PY{c+c1}{\PYZsh{}calc zonal average temp anomalies}
         \PY{c+c1}{\PYZsh{}Plot zonal average temp anomaly across weddell}
         \PY{n}{x1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{40}\PY{p}{)}
         \PY{n}{x2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{l+m+mi}{15}\PY{p}{)}
         \PY{n}{x1}\PY{o}{=}\PY{n}{x1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{x2}\PY{o}{=}\PY{n}{x2}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         
         \PY{n}{y1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{65}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}y2=np.argwhere(xt\PYZus{}ocean\PYZlt{}15)}
         \PY{n}{y1}\PY{o}{=}\PY{n}{y1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{c+c1}{\PYZsh{}y2=y2[\PYZhy{}1]}
         \PY{k}{print} \PY{n}{x1}\PY{p}{,} \PY{n}{x2}
         
         \PY{c+c1}{\PYZsh{}print xt\PYZus{}ocean[x1:x2]}
         \PY{c+c1}{\PYZsh{}print yt\PYZus{}ocean[:y1]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[959] [1179]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}53}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{12.5}\PY{p}{,}\PY{l+m+mf}{9.5}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{suptitle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Zonal Average Temp Anom 40W\PYZhy{}15E}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}print cntrl.temp.shape}
         \PY{c+c1}{\PYZsh{}print pert.temp.shape}
         
         \PY{c+c1}{\PYZsh{}plt.subplot(211)}
         \PY{c+c1}{\PYZsh{}clev = np.arange(\PYZhy{}2,20,1)}
         \PY{c+c1}{\PYZsh{}plt.contourf(yt\PYZus{}ocean[0:500],st\PYZus{}ocean,np.mean(cntrl\PYZus{}temp[:,:,x1:x2],axis=2),cmap=plt.cm.PiYG,levels=clev,extend=\PYZsq{}both\PYZsq{})}
         \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.7)}
         \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}Temp\PYZsq{})}
         \PY{c+c1}{\PYZsh{}plt.contour(yt\PYZus{}ocean[0:500],st\PYZus{}ocean,np.mean(cntrl\PYZus{}temp[:,:,x1:x2],axis=2),levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=0.25)}
         \PY{c+c1}{\PYZsh{}plt.contour(yt\PYZus{}ocean[0:500],st\PYZus{}ocean,np.mean(cntrl\PYZus{}temp[:,:,x1:x2],axis=2),levels=[0.0,],colors=\PYZsq{}k\PYZsq{},linewidths=0.5)}
         \PY{c+c1}{\PYZsh{}plt.gca().invert\PYZus{}yaxis()}
         \PY{c+c1}{\PYZsh{}\PYZsh{}plt.gca().yaxis.set\PYZus{}major\PYZus{}formatter(x\PYZus{}formatter)}
         \PY{c+c1}{\PYZsh{}\PYZsh{}plt.ylim((1037.5,1034))}
         \PY{c+c1}{\PYZsh{}plt.ylabel(\PYZsq{}Depth (m)\PYZsq{})}
         \PY{c+c1}{\PYZsh{}plt.xlabel(\PYZsq{}Latitude (\PYZdl{}\PYZca{}\PYZbs{}circ\PYZdl{}S)\PYZsq{})}
         \PY{c+c1}{\PYZsh{}plt.xlim([\PYZhy{}75,\PYZhy{}50])}
         \PY{c+c1}{\PYZsh{}plt.title(\PYZsq{}Control Temp\PYZsq{})}
         
         \PY{n}{ii}\PY{o}{=}\PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{yr} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{)}\PY{p}{:}
             \PY{c+c1}{\PYZsh{}print yr}
         
             \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{4}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{,}\PY{n}{yr}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}color}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.25}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{o}{.}\PY{l+m+mi}{7}\PY{p}{,}\PY{o}{.}\PY{l+m+mi}{71}\PY{p}{,}\PY{l+m+mf}{0.1}\PY{p}{)}
             \PY{n}{p1}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{]}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.7)}
             \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}kg/m3\PYZsq{})}
             \PY{c+c1}{\PYZsh{}plt.contour(yt\PYZus{}ocean[0:500],st\PYZus{}ocean,pert\PYZus{}ztemp\PYZhy{}cntrl\PYZus{}ztemp,levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=0.25)}
             \PY{c+c1}{\PYZsh{}plt.contour(yt\PYZus{}ocean[0:500],st\PYZus{}ocean,pert\PYZus{}ztemp\PYZhy{}cntrl\PYZus{}ztemp,levels=[0.0,],colors=\PYZsq{}k\PYZsq{},linewidths=0.5)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}plt.gca().yaxis.set\PYZus{}major\PYZus{}formatter(x\PYZus{}formatter)}
             \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1034))}
             \PY{c+c1}{\PYZsh{}plt.ylabel(\PYZsq{}Depth (m)\PYZsq{})}
             \PY{c+c1}{\PYZsh{}plt.xlabel(\PYZsq{}Latitude (\PYZdl{}\PYZca{}\PYZbs{}circ\PYZdl{}S)\PYZsq{})}
             \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{50}\PY{p}{]}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{n}{yr}\PY{p}{]}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}plt.title(\PYZsq{}40W to 15E Temp Anomaly 1976\PYZsq{})}
         
         \PY{n}{ax3} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{axes}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.92}\PY{p}{,}\PY{l+m+mf}{0.38}\PY{p}{,}\PY{l+m+mf}{0.015}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{]}\PY{p}{)}
         \PY{n}{cb} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{p1}\PY{p}{,}\PY{n}{cax}\PY{o}{=}\PY{n}{ax3}\PY{p}{,}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}plt.subplot(224)}
         \PY{c+c1}{\PYZsh{}plt.gca().patch.set\PYZus{}color(\PYZsq{}.25\PYZsq{})}
         \PY{c+c1}{\PYZsh{}clev = np.arange(\PYZhy{}.5,.51,0.1)}
         \PY{c+c1}{\PYZsh{}plt.contourf(yt\PYZus{}ocean[0:500],st\PYZus{}ocean,np.mean(pert\PYZus{}temp[9,:,:,:],axis=2)\PYZhy{}np.mean(cntrl\PYZus{}temp[:,:,:],axis=2),cmap=plt.cm.PiYG,levels=clev,extend=\PYZsq{}both\PYZsq{})}
         \PY{c+c1}{\PYZsh{}plt.title(\PYZsq{}180W to 180E Temp Anomaly 1982\PYZsq{})}
         
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}zavTanom.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{zavTanom.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_45_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}54}]:} \PY{c+c1}{\PYZsh{}store time\PYZhy{}series between 60\PYZhy{}65S at different depths}
         \PY{c+c1}{\PYZsh{}pTz=np.zeros(pert\PYZus{}temp.shape[0],pert\PYZus{}temp.shape[1])}
         \PY{c+c1}{\PYZsh{}cTz=np.zeros(pert\PYZus{}temp.shape[0],pert\PYZus{}temp.shape[1])}
         \PY{c+c1}{\PYZsh{}print pTz.shape}
         
         \PY{n}{x1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{40}\PY{p}{)}
         \PY{n}{x2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{l+m+mi}{15}\PY{p}{)}
         \PY{n}{x1}\PY{o}{=}\PY{n}{x1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{x2}\PY{o}{=}\PY{n}{x2}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         
         \PY{n}{y1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{65}\PY{p}{)}
         \PY{n}{y2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{60}\PY{p}{)}
         \PY{n}{y1}\PY{o}{=}\PY{n}{y1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{y2}\PY{o}{=}\PY{n}{y2}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{k}{print} \PY{n}{x1}\PY{p}{,} \PY{n}{x2}
         \PY{k}{print} \PY{n}{y1}\PY{p}{,} \PY{n}{y2}
         
         \PY{n}{cTz}\PY{o}{=}\PY{n}{cntrl}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{n}{y1}\PY{p}{:}\PY{n}{y2}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
         \PY{k}{print} \PY{n}{cTz}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{pTz}\PY{o}{=}\PY{n}{pert}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{n}{y1}\PY{p}{:}\PY{n}{y2}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
         \PY{k}{print} \PY{n}{pTz}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[959] [1179]
[152] [195]
(9, 50)
(29, 50)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}59}]:} \PY{c+c1}{\PYZsh{}plot temp hovmoeller of depth vs time}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{9.5}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         
         \PY{n}{time} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{k}{print} \PY{n}{time}
         \PY{k}{print} \PY{n}{time}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{yrs}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1972}\PY{p}{,}\PY{l+m+mi}{2016}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{k}{print} \PY{n}{cTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{shape}
         \PY{n}{var1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{expand\PYZus{}dims}\PY{p}{(}\PY{n}{cTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{k}{print} \PY{n}{var1}\PY{o}{.}\PY{n}{shape}
         \PY{n}{var2} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{concatenate}\PY{p}{(}\PY{p}{(}\PY{n}{var1}\PY{p}{,}\PY{n}{pTz}\PY{p}{)}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{k}{print} \PY{n}{var2}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{o}{.}\PY{l+m+mo}{05}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}print clev}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{211}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{30}\PY{p}{]}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{var2}\PY{o}{.}\PY{n}{T}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.contour(yu\PYZus{}ocean,potrho,np.mean(cntrl\PYZus{}gmoc[0:4,:,:],axis=0),levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=0.25)}
         \PY{c+c1}{\PYZsh{}plt.contour(yu\PYZus{}ocean,potrho,np.mean(cntrl\PYZus{}gmoc[0:4,:,:],axis=0),levels=[0.0,],colors=\PYZsq{}k\PYZsq{},linewidths=0.5)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1035))}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth (m}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Years}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.xlim([\PYZhy{}75,85])}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{60\PYZhy{}65S and 40W\PYZhy{}15E Temp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{o}{.}\PY{l+m+mi}{5}\PY{p}{,}\PY{o}{.}\PY{l+m+mi}{5}\PY{p}{,}\PY{o}{.}\PY{l+m+mo}{05}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}print clev}
         
         \PY{n}{time} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{k}{print} \PY{n}{time}
         \PY{k}{print} \PY{n}{time}\PY{o}{.}\PY{n}{shape}
         \PY{k}{print} \PY{n}{pTz}\PY{o}{.}\PY{n}{shape}
         \PY{n}{a}\PY{o}{=}\PY{n}{pTz}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cTz}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{k}{print} \PY{n}{a}\PY{o}{.}\PY{n}{shape}
         
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{212}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{l+m+mi}{30}\PY{p}{]}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{a}\PY{o}{.}\PY{n}{T}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.contour(yu\PYZus{}ocean,potrho,np.mean(cntrl\PYZus{}gmoc[0:4,:,:],axis=0),levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=0.25)}
         \PY{c+c1}{\PYZsh{}plt.contour(yu\PYZus{}ocean,potrho,np.mean(cntrl\PYZus{}gmoc[0:4,:,:],axis=0),levels=[0.0,],colors=\PYZsq{}k\PYZsq{},linewidths=0.5)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1035))}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth (m}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Years}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.xlim([\PYZhy{}75,85])}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{60\PYZhy{}65S and 40W\PYZhy{}15E Temp Anom}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[-1  0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19]
(21,)
(50,)
(1, 50)
(30, 50)
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19]
(20,)
(29, 50)
(29, 50)

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}59}]:} Text(0.5,1,u'60-65S and 40W-15E Temp Anom')
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_47_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}60}]:} \PY{c+c1}{\PYZsh{}plot density}
         \PY{k}{print} \PY{n}{cntrl}\PY{o}{.}\PY{n}{pot\PYZus{}rho\PYZus{}0}\PY{o}{.}\PY{n}{shape}
         \PY{k}{print} \PY{n}{pert}\PY{o}{.}\PY{n}{pot\PYZus{}rho\PYZus{}0}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(9, 50, 1080, 1440)
(29, 50, 1080, 1440)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}61}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{9.5}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{o}{.}\PY{l+m+mo}{02}\PY{p}{,}\PY{o}{.}\PY{l+m+mo}{02}\PY{p}{,}\PY{l+m+mi}{21}\PY{p}{)}
         \PY{k}{print} \PY{n}{clev}
         \PY{k}{print} \PY{n}{st\PYZus{}ocean}\PY{p}{[}\PY{l+m+mi}{5}\PY{p}{]}
         \PY{n}{yr}\PY{o}{=}\PY{l+m+mi}{5}
         \PY{n}{yrs}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1973}\PY{p}{,}\PY{l+m+mi}{2016}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{45}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
         \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)} 
         \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{pert}\PY{o}{.}\PY{n}{pot\PYZus{}rho\PYZus{}0}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl}\PY{o}{.}\PY{n}{pot\PYZus{}rho\PYZus{}0}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{kg/m3}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{clev3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1000}\PY{p}{,}\PY{l+m+mi}{5001}\PY{p}{,}\PY{l+m+mi}{500}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{ht}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev3}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Anom at 55m }\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{yrs}\PY{p}{[}\PY{n}{yr}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         
         \PY{k}{print} \PY{n}{st\PYZus{}ocean}\PY{p}{[}\PY{l+m+mi}{42}\PY{p}{]}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n+nb}{map} \PY{o}{=} \PY{n}{Basemap}\PY{p}{(}\PY{n}{projection}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spstere}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{boundinglat}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{45}\PY{p}{,}\PY{n}{lon\PYZus{}0}\PY{o}{=}\PY{l+m+mi}{90}\PY{p}{,}\PY{n}{resolution}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{l}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{round}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawcoastlines}\PY{p}{(}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{fillcontinents}\PY{p}{(}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{lake\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gray}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} draw parallels and meridians.}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawparallels}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{80.}\PY{p}{,}\PY{l+m+mf}{81.}\PY{p}{,}\PY{l+m+mf}{15.}\PY{p}{)}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{drawmeridians}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mf}{160.}\PY{p}{,}\PY{l+m+mf}{181.}\PY{p}{,}\PY{l+m+mf}{40.}\PY{p}{)}\PY{p}{,}\PY{n}{labels}\PY{o}{=}\PY{p}{[}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{,}\PY{n+nb+bp}{True}\PY{p}{]}\PY{p}{)}
         \PY{n}{X}\PY{p}{,} \PY{n}{Y} \PY{o}{=} \PY{n+nb}{map}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)} 
         \PY{n}{p1}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{pert}\PY{o}{.}\PY{n}{pot\PYZus{}rho\PYZus{}0}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{l+m+mi}{42}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{cntrl}\PY{o}{.}\PY{n}{pot\PYZus{}rho\PYZus{}0}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{l+m+mi}{42}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{bwr}\PY{p}{,} \PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,} \PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}CMRmap\PYZus{}r, gist\PYZus{}stern\PYZus{}r}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{kg/m3}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{clev3} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1000}\PY{p}{,}\PY{l+m+mi}{5001}\PY{p}{,}\PY{l+m+mi}{500}\PY{p}{)}
         \PY{n+nb}{map}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{Y}\PY{p}{,}\PY{n}{ht}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev3}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Anom at 4000m }\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{yrs}\PY{p}{[}\PY{n}{yr}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
             
         \PY{c+c1}{\PYZsh{}ax3 = plt.axes([0.92,0.38,0.015,0.25])}
         \PY{c+c1}{\PYZsh{}cb = plt.colorbar(p1,cax=ax3,orientation=\PYZsq{}vertical\PYZsq{})}
         \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
         \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}C\PYZsq{})}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[-0.02  -0.018 -0.016 -0.014 -0.012 -0.01  -0.008 -0.006 -0.004 -0.002  0.
  0.002  0.004  0.006  0.008  0.01   0.012  0.014  0.016  0.018  0.02 ]
55.8532485962
3926.81274414

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}61}]:} Text(0.5,1,u'Anom at 4000m 1978')
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_49_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}62}]:} \PY{c+c1}{\PYZsh{}calc zonal average anomalies}
         \PY{c+c1}{\PYZsh{}Plot zonal average anomaly across weddell}
         \PY{n}{x1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{40}\PY{p}{)}
         \PY{n}{x2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{l+m+mi}{15}\PY{p}{)}
         \PY{n}{x1}\PY{o}{=}\PY{n}{x1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{x2}\PY{o}{=}\PY{n}{x2}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         
         \PY{n}{y1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{65}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}y2=np.argwhere(xt\PYZus{}ocean\PYZlt{}15)}
         \PY{n}{y1}\PY{o}{=}\PY{n}{y1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{c+c1}{\PYZsh{}y2=y2[\PYZhy{}1]}
         \PY{k}{print} \PY{n}{x1}\PY{p}{,} \PY{n}{x2}
         
         \PY{c+c1}{\PYZsh{}print xt\PYZus{}ocean[x1:x2]}
         \PY{c+c1}{\PYZsh{}print yt\PYZus{}ocean[:y1]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[959] [1179]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}64}]:} \PY{n}{var2}\PY{o}{=}\PY{n}{cntrl}\PY{o}{.}\PY{n}{pot\PYZus{}rho\PYZus{}0}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{ii}\PY{o}{=}\PY{l+m+mi}{0}
         \PY{k}{for} \PY{n}{yr} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{)}\PY{p}{:}
             \PY{c+c1}{\PYZsh{}print yr}
             \PY{n}{var1}\PY{o}{=}\PY{n}{pert}\PY{o}{.}\PY{n}{pot\PYZus{}rho\PYZus{}0}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}print var1.shape, var2.shape}
             
             \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{4}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{,}\PY{n}{yr}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}color}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.25}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{o}{.}\PY{l+m+mo}{01}\PY{p}{,}\PY{o}{.}\PY{l+m+mo}{01}\PY{p}{,}\PY{l+m+mi}{21}\PY{p}{)}
             
             \PY{n}{p1}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{]}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{var1}\PY{o}{\PYZhy{}}\PY{n}{var2}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}cb=plt.colorbar(orientation=\PYZsq{}vertical\PYZsq{},shrink = 0.7)}
             \PY{c+c1}{\PYZsh{}cb.ax.set\PYZus{}xlabel(\PYZsq{}kg/m3\PYZsq{})}
             \PY{c+c1}{\PYZsh{}plt.contour(yt\PYZus{}ocean[0:500],st\PYZus{}ocean,pert\PYZus{}ztemp\PYZhy{}cntrl\PYZus{}ztemp,levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=0.25)}
             \PY{c+c1}{\PYZsh{}plt.contour(yt\PYZus{}ocean[0:500],st\PYZus{}ocean,pert\PYZus{}ztemp\PYZhy{}cntrl\PYZus{}ztemp,levels=[0.0,],colors=\PYZsq{}k\PYZsq{},linewidths=0.5)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}plt.gca().yaxis.set\PYZus{}major\PYZus{}formatter(x\PYZus{}formatter)}
             \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1034))}
             \PY{c+c1}{\PYZsh{}plt.ylabel(\PYZsq{}Depth (m)\PYZsq{})}
             \PY{c+c1}{\PYZsh{}plt.xlabel(\PYZsq{}Latitude (\PYZdl{}\PYZca{}\PYZbs{}circ\PYZdl{}S)\PYZsq{})}
             \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{50}\PY{p}{]}\PY{p}{)}
             \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{n}{yr}\PY{p}{]}\PY{p}{)}
             \PY{c+c1}{\PYZsh{}plt.title(\PYZsq{}40W to 15E Temp Anomaly 1976\PYZsq{})}
         
         \PY{n}{ax3} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{axes}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.92}\PY{p}{,}\PY{l+m+mf}{0.38}\PY{p}{,}\PY{l+m+mf}{0.015}\PY{p}{,}\PY{l+m+mf}{0.25}\PY{p}{]}\PY{p}{)}
         \PY{n}{cb} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{p1}\PY{p}{,}\PY{n}{cax}\PY{o}{=}\PY{n}{ax3}\PY{p}{,}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}ticks=[0, 500, 1000, 1500, 2000]}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{kg/m3}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}plt.subplot(224)}
         \PY{c+c1}{\PYZsh{}plt.gca().patch.set\PYZus{}color(\PYZsq{}.25\PYZsq{})}
         \PY{c+c1}{\PYZsh{}clev = np.arange(\PYZhy{}.5,.51,0.1)}
         \PY{c+c1}{\PYZsh{}plt.contourf(yt\PYZus{}ocean[0:500],st\PYZus{}ocean,np.mean(pert\PYZus{}temp[9,:,:,:],axis=2)\PYZhy{}np.mean(cntrl\PYZus{}temp[:,:,:],axis=2),cmap=plt.cm.PiYG,levels=clev,extend=\PYZsq{}both\PYZsq{})}
         \PY{c+c1}{\PYZsh{}plt.title(\PYZsq{}180W to 180E Temp Anomaly 1982\PYZsq{})}
         
         \PY{c+c1}{\PYZsh{}of = os.path.join(NYFPertDir,\PYZsq{}zavTanom.pdf\PYZsq{})}
         \PY{c+c1}{\PYZsh{}print of}
         \PY{c+c1}{\PYZsh{}plt.savefig(of)}
         \PY{n}{of} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{zavRhoanom.png}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{savefig}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{220}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_51_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}65}]:} \PY{c+c1}{\PYZsh{}store time\PYZhy{}series between 60\PYZhy{}65S at different depths}
         \PY{c+c1}{\PYZsh{}pTz=np.zeros(pert\PYZus{}temp.shape[0],pert\PYZus{}temp.shape[1])}
         \PY{c+c1}{\PYZsh{}cTz=np.zeros(pert\PYZus{}temp.shape[0],pert\PYZus{}temp.shape[1])}
         \PY{c+c1}{\PYZsh{}print pTz.shape}
         
         \PY{n}{x1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{40}\PY{p}{)}
         \PY{n}{x2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{l+m+mi}{15}\PY{p}{)}
         \PY{n}{x1}\PY{o}{=}\PY{n}{x1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{x2}\PY{o}{=}\PY{n}{x2}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         
         \PY{n}{y1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{65}\PY{p}{)}
         \PY{n}{y2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{60}\PY{p}{)}
         \PY{n}{y1}\PY{o}{=}\PY{n}{y1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{y2}\PY{o}{=}\PY{n}{y2}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{k}{print} \PY{n}{x1}\PY{p}{,} \PY{n}{x2}
         \PY{k}{print} \PY{n}{y1}\PY{p}{,} \PY{n}{y2}
         
         \PY{c+c1}{\PYZsh{}cntrl\PYZus{}ztemp=ff.temp[0:5,:,0:500,859:1279].mean(\PYZsq{}time\PYZsq{}).mean(\PYZsq{}xt\PYZus{}ocean\PYZsq{}).load()}
         \PY{c+c1}{\PYZsh{}need to area average this ...}
         \PY{n}{cTz}\PY{o}{=}\PY{n}{cntrl}\PY{o}{.}\PY{n}{pot\PYZus{}rho\PYZus{}0}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{n}{y1}\PY{p}{:}\PY{n}{y2}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
         \PY{k}{print} \PY{n}{cTz}\PY{o}{.}\PY{n}{shape}
         
         \PY{c+c1}{\PYZsh{}pert\PYZus{}ztemp=ff.temp[0:5,:,0:500,859:1279].mean(\PYZsq{}time\PYZsq{}).mean(\PYZsq{}xt\PYZus{}ocean\PYZsq{}).load()}
         \PY{c+c1}{\PYZsh{}print pert\PYZus{}ztemp.shape}
         
         \PY{n}{pTz}\PY{o}{=}\PY{n}{pert}\PY{o}{.}\PY{n}{pot\PYZus{}rho\PYZus{}0}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{n}{y1}\PY{p}{:}\PY{n}{y2}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
         \PY{k}{print} \PY{n}{pTz}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[959] [1179]
[152] [195]
(9, 50)
(29, 50)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}69}]:} \PY{c+c1}{\PYZsh{}plot rho hovmoeller of depth vs time}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{9.5}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         
         \PY{n}{time} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{k}{print} \PY{n}{time}
         \PY{k}{print} \PY{n}{time}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{yrs}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{1972}\PY{p}{,}\PY{l+m+mi}{2016}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         
         \PY{k}{print} \PY{n}{cTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{shape}
         \PY{n}{cn1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{expand\PYZus{}dims}\PY{p}{(}\PY{n}{cTz}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{k}{print} \PY{n}{cn1}\PY{o}{.}\PY{n}{shape}
         \PY{n}{cn} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{concatenate}\PY{p}{(}\PY{p}{(}\PY{n}{cn1}\PY{p}{,}\PY{n}{pTz}\PY{p}{)}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{k}{print} \PY{n}{cn}\PY{o}{.}\PY{n}{shape}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mf}{1027.7}\PY{p}{,}\PY{l+m+mf}{1027.8}\PY{p}{,}\PY{l+m+mi}{51}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}print clev}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{211}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{30}\PY{p}{]}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{cn}\PY{o}{.}\PY{n}{T}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{kg/m3}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.contour(yu\PYZus{}ocean,potrho,np.mean(cntrl\PYZus{}gmoc[0:4,:,:],axis=0),levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=0.25)}
         \PY{c+c1}{\PYZsh{}plt.contour(yu\PYZus{}ocean,potrho,np.mean(cntrl\PYZus{}gmoc[0:4,:,:],axis=0),levels=[0.0,],colors=\PYZsq{}k\PYZsq{},linewidths=0.5)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1035))}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth (m}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Years}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.xlim([\PYZhy{}75,85])}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{60\PYZhy{}65S and 40W\PYZhy{}15E Rho}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{o}{.}\PY{l+m+mo}{01}\PY{p}{,}\PY{o}{.}\PY{l+m+mo}{01}\PY{p}{,}\PY{l+m+mi}{21}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}print clev}
         
         \PY{n}{time} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{k}{print} \PY{n}{time}
         \PY{k}{print} \PY{n}{time}\PY{o}{.}\PY{n}{shape}
         \PY{k}{print} \PY{n}{pTz}\PY{o}{.}\PY{n}{shape}
         \PY{n}{a}\PY{o}{=}\PY{n}{pTz}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cTz}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{k}{print} \PY{n}{a}\PY{o}{.}\PY{n}{shape}
         
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{212}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yrs}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{:}\PY{l+m+mi}{30}\PY{p}{]}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{a}\PY{o}{.}\PY{n}{T}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{kg/m3}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.contour(yu\PYZus{}ocean,potrho,np.mean(cntrl\PYZus{}gmoc[0:4,:,:],axis=0),levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=0.25)}
         \PY{c+c1}{\PYZsh{}plt.contour(yu\PYZus{}ocean,potrho,np.mean(cntrl\PYZus{}gmoc[0:4,:,:],axis=0),levels=[0.0,],colors=\PYZsq{}k\PYZsq{},linewidths=0.5)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1035))}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth (m}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Years}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.xlim([\PYZhy{}75,85])}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{60\PYZhy{}65S and 40W\PYZhy{}15E Rho Anom}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[-1  0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19]
(21,)
(50,)
(1, 50)
(30, 50)
[ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19]
(20,)
(29, 50)
(29, 50)

    \end{Verbatim}

\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}69}]:} Text(0.5,1,u'60-65S and 40W-15E Rho Anom')
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_53_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}70}]:} \PY{c+c1}{\PYZsh{}calc zonal average anomalies}
         \PY{c+c1}{\PYZsh{}Plot zonal average anomaly across weddell}
         \PY{n}{x1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{40}\PY{p}{)}
         \PY{n}{x2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{xt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{l+m+mi}{15}\PY{p}{)}
         \PY{n}{x1}\PY{o}{=}\PY{n}{x1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{x2}\PY{o}{=}\PY{n}{x2}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         
         \PY{n}{y1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{65}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}y2=np.argwhere(xt\PYZus{}ocean\PYZlt{}15)}
         \PY{n}{y1}\PY{o}{=}\PY{n}{y1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{c+c1}{\PYZsh{}y2=y2[\PYZhy{}1]}
         \PY{k}{print} \PY{n}{x1}\PY{p}{,} \PY{n}{x2}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
[959] [1179]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}72}]:} \PY{c+c1}{\PYZsh{}plot control zavg temp, rho, salt }
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{9.5}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{)}\PY{p}{)}
         \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Control Zavg Tracers 40W\PYZhy{}15E}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{yr}\PY{o}{=}\PY{l+m+mi}{0}
         \PY{n}{var1}\PY{o}{=}\PY{n}{cntrl}\PY{o}{.}\PY{n}{pot\PYZus{}rho\PYZus{}0}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mf}{1027.7}\PY{p}{,}\PY{l+m+mf}{1027.8}\PY{p}{,}\PY{l+m+mi}{51}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}color}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.25}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{p1}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{]}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{var1}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{kg/m3}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.contour(yt\PYZus{}ocean[0:500],st\PYZus{}ocean,pert\PYZus{}ztemp\PYZhy{}cntrl\PYZus{}ztemp,levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=0.25)}
         \PY{c+c1}{\PYZsh{}plt.contour(yt\PYZus{}ocean[0:500],st\PYZus{}ocean,pert\PYZus{}ztemp\PYZhy{}cntrl\PYZus{}ztemp,levels=[0.0,],colors=\PYZsq{}k\PYZsq{},linewidths=0.5)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.gca().yaxis.set\PYZus{}major\PYZus{}formatter(x\PYZus{}formatter)}
         \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1034))}
         \PY{c+c1}{\PYZsh{}plt.ylabel(\PYZsq{}Depth (m)\PYZsq{})}
         \PY{c+c1}{\PYZsh{}plt.xlabel(\PYZsq{}Latitude (\PYZdl{}\PYZca{}\PYZbs{}circ\PYZdl{}S)\PYZsq{})}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{50}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Control Rho}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{var1}\PY{o}{=}\PY{n}{cntrl}\PY{o}{.}\PY{n}{temp}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{51}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}color}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.25}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{p1}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{]}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{var1}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.contour(yt\PYZus{}ocean[0:500],st\PYZus{}ocean,pert\PYZus{}ztemp\PYZhy{}cntrl\PYZus{}ztemp,levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=0.25)}
         \PY{c+c1}{\PYZsh{}plt.contour(yt\PYZus{}ocean[0:500],st\PYZus{}ocean,pert\PYZus{}ztemp\PYZhy{}cntrl\PYZus{}ztemp,levels=[0.0,],colors=\PYZsq{}k\PYZsq{},linewidths=0.5)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.gca().yaxis.set\PYZus{}major\PYZus{}formatter(x\PYZus{}formatter)}
         \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1034))}
         \PY{c+c1}{\PYZsh{}plt.ylabel(\PYZsq{}Depth (m)\PYZsq{})}
         \PY{c+c1}{\PYZsh{}plt.xlabel(\PYZsq{}Latitude (\PYZdl{}\PYZca{}\PYZbs{}circ\PYZdl{}S)\PYZsq{})}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{50}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Control Temp}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{n}{var1}\PY{o}{=}\PY{n}{cntrl}\PY{o}{.}\PY{n}{salt}\PY{p}{[}\PY{n}{yr}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{,}\PY{n}{x1}\PY{p}{:}\PY{n}{x2}\PY{p}{]}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mi}{34}\PY{p}{,}\PY{l+m+mi}{35}\PY{p}{,}\PY{l+m+mi}{51}\PY{p}{)}
         
         \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{patch}\PY{o}{.}\PY{n}{set\PYZus{}color}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{.25}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{p1}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{500}\PY{p}{]}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{var1}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
         \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sa}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.contour(yt\PYZus{}ocean[0:500],st\PYZus{}ocean,pert\PYZus{}ztemp\PYZhy{}cntrl\PYZus{}ztemp,levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=0.25)}
         \PY{c+c1}{\PYZsh{}plt.contour(yt\PYZus{}ocean[0:500],st\PYZus{}ocean,pert\PYZus{}ztemp\PYZhy{}cntrl\PYZus{}ztemp,levels=[0.0,],colors=\PYZsq{}k\PYZsq{},linewidths=0.5)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
         \PY{c+c1}{\PYZsh{}plt.gca().yaxis.set\PYZus{}major\PYZus{}formatter(x\PYZus{}formatter)}
         \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1034))}
         \PY{c+c1}{\PYZsh{}plt.ylabel(\PYZsq{}Depth (m)\PYZsq{})}
         \PY{c+c1}{\PYZsh{}plt.xlabel(\PYZsq{}Latitude (\PYZdl{}\PYZca{}\PYZbs{}circ\PYZdl{}S)\PYZsq{})}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{50}\PY{p}{]}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Control Salt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}72}]:} Text(0.5,1,u'Control Salt')
\end{Verbatim}
            
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_55_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{}\PYZsh{} Calc the AMOC from ty\PYZus{}trans for forcing cases}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{}calculate the AMOC mask}
        \PY{c+c1}{\PYZsh{}\PYZhy{}1 is Atl and Arctic, all other ocean is \PYZhy{}2, land is 0}
        \PY{c+c1}{\PYZsh{}reset to 1 and 0}
        \PY{n}{msk\PYZus{}file}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{/g/data1/v45/pas561/mom/archive/gfdl\PYZus{}nyf\PYZus{}1080/basin\PYZus{}mask.nc}\PY{l+s+s1}{\PYZsq{}}
        \PY{n}{nc} \PY{o}{=} \PY{n}{Dataset}\PY{p}{(}\PY{n}{msk\PYZus{}file}\PY{p}{,} \PY{n}{mode}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{} file handle, open in read only mode}
        \PY{n}{msk}\PY{o}{=} \PY{n}{nc}\PY{o}{.}\PY{n}{variables}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{kmt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{[}\PY{p}{:}\PY{p}{]}
        \PY{n}{nc}\PY{o}{.}\PY{n}{close}\PY{p}{(}\PY{p}{)} \PY{c+c1}{\PYZsh{} close the file}
        \PY{k}{print} \PY{n}{msk}\PY{o}{.}\PY{n}{shape}
        \PY{n}{msk}\PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{n}{msk}\PY{o}{\PYZlt{}}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}\PY{o}{=}\PY{l+m+mi}{0}
        \PY{n}{msk}\PY{p}{[}\PY{n}{np}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{n}{msk}\PY{o}{==}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}\PY{o}{=}\PY{l+m+mi}{1}
        
        \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{k}{print} \PY{n}{clev}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{211}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{geolon\PYZus{}t}\PY{p}{,}\PY{n}{geolat\PYZus{}t}\PY{p}{,}\PY{n}{msk}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
        \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Mask}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{AMOC Mask}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{}do AMOC in zspace}
        \PY{n}{Ocean\PYZus{}File} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{output5*/ocean.nc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{k}{print} \PY{n}{Ocean\PYZus{}File}
        
        \PY{n}{ff}\PY{o}{=}\PY{n}{xr}\PY{o}{.}\PY{n}{open\PYZus{}mfdataset}\PY{p}{(}\PY{n}{Ocean\PYZus{}File}\PY{p}{,}\PY{n}{engine}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{netcdf4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{concat\PYZus{}dim}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{decode\PYZus{}times}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
        \PY{k}{print} \PY{n}{ff}\PY{o}{.}\PY{n}{ty\PYZus{}trans}\PY{o}{.}\PY{n}{shape}
        
        \PY{c+c1}{\PYZsh{}tt=ff.ty\PYZus{}trans[1,:,500,500].load()}
        \PY{c+c1}{\PYZsh{}print \PYZsq{}no mask\PYZsq{}, tt}
        
        \PY{n}{ty}\PY{o}{=}\PY{n}{ff}\PY{o}{.}\PY{n}{ty\PYZus{}trans}\PY{o}{*}\PY{n}{msk}
        \PY{k}{print} \PY{n}{ty}\PY{o}{.}\PY{n}{shape}
        \PY{c+c1}{\PYZsh{}tt=ty[1,:,500,500].load()}
        \PY{c+c1}{\PYZsh{}print \PYZsq{}mask\PYZsq{},tt}
        
        \PY{n}{cntrl\PYZus{}amoc}\PY{o}{=}\PY{n}{ty}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{cumsum}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{st\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
        
        \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{amoc\PYZus{}z.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{a}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{cntrl\PYZus{}amoc}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{}do AMOC in zspace}
        \PY{n}{Ocean\PYZus{}File} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{output5*/ocean.nc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{k}{print} \PY{n}{Ocean\PYZus{}File}
        
        \PY{n}{ff}\PY{o}{=}\PY{n}{xr}\PY{o}{.}\PY{n}{open\PYZus{}mfdataset}\PY{p}{(}\PY{n}{Ocean\PYZus{}File}\PY{p}{,}\PY{n}{engine}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{netcdf4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{concat\PYZus{}dim}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{decode\PYZus{}times}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
        \PY{k}{print} \PY{n}{ff}\PY{o}{.}\PY{n}{ty\PYZus{}trans}\PY{o}{.}\PY{n}{shape}
        
        \PY{c+c1}{\PYZsh{}tt=ff.ty\PYZus{}trans[1,:,500,500].load()}
        \PY{c+c1}{\PYZsh{}print \PYZsq{}no mask\PYZsq{}, tt}
        
        \PY{n}{ty}\PY{o}{=}\PY{n}{ff}\PY{o}{.}\PY{n}{ty\PYZus{}trans}\PY{o}{*}\PY{n}{msk}
        \PY{k}{print} \PY{n}{ty}\PY{o}{.}\PY{n}{shape}
        \PY{c+c1}{\PYZsh{}tt=ty[1,:,500,500].load()}
        \PY{c+c1}{\PYZsh{}print \PYZsq{}mask\PYZsq{},tt}
        
        \PY{n}{pert\PYZus{}amoc}\PY{o}{=}\PY{n}{ty}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{cumsum}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{st\PYZus{}ocean}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
        
        \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{amoc\PYZus{}z.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{a}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{save}\PY{p}{(}\PY{n}{of}\PY{p}{,}\PY{n}{pert\PYZus{}amoc}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFPertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{amoc\PYZus{}z.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{pert\PYZus{}amoc}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n}{of}\PY{p}{)}
        \PY{k}{print} \PY{n}{pert\PYZus{}amoc}\PY{o}{.}\PY{n}{shape}
        
        \PY{n}{of}\PY{o}{=}\PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{NYFCntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{amoc\PYZus{}z.npy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{cntrl\PYZus{}amoc}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n}{of}\PY{p}{)}
        \PY{k}{print} \PY{n}{cntrl\PYZus{}amoc}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{}Amoc in Z space}
        \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{9.5}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{)}\PY{p}{)}
        \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
        
        \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{22}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{221}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}amoc}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
        \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}amoc}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}amoc}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{p}{[}\PY{l+m+mf}{0.0}\PY{p}{,}\PY{p}{]}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1035))}
        \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth (m)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Latitude (\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}N)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{30}\PY{p}{,}\PY{l+m+mi}{85}\PY{p}{]}\PY{p}{)}
        \PY{n}{tit}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Control Amoc}\PY{l+s+s1}{\PYZsq{}}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{tit}\PY{p}{)}
        
        \PY{n}{t1}\PY{o}{=}\PY{l+m+mi}{0}
        \PY{n}{t2}\PY{o}{=}\PY{l+m+mi}{5}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{222}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{pert\PYZus{}amoc}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
        \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{pert\PYZus{}amoc}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{pert\PYZus{}amoc}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{p}{[}\PY{l+m+mf}{0.0}\PY{p}{,}\PY{p}{]}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1035))}
        \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth (m)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Latitude (\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}N)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{30}\PY{p}{,}\PY{l+m+mi}{85}\PY{p}{]}\PY{p}{)}
        \PY{n}{tit}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Perturbed AMOC Years }\PY{l+s+s1}{\PYZsq{}}\PY{o}{+}\PY{n+nb}{str}\PY{p}{(}\PY{n}{t1}\PY{p}{)}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{+}\PY{n+nb}{str}\PY{p}{(}\PY{n}{t2}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{tit}\PY{p}{)}
        
        \PY{n}{t1}\PY{o}{=}\PY{l+m+mi}{0}
        \PY{n}{t2}\PY{o}{=}\PY{l+m+mi}{5}
        
        \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{5}\PY{p}{,}\PY{l+m+mi}{6}\PY{p}{,}\PY{o}{.}\PY{l+m+mi}{5}\PY{p}{)}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{223}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{pert\PYZus{}amoc}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}amoc}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
        \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{pert\PYZus{}amoc}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}amoc}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{pert\PYZus{}amoc}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}amoc}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{p}{[}\PY{l+m+mf}{0.0}\PY{p}{,}\PY{p}{]}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1035))}
        \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth (m)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Latitude (\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}N)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{30}\PY{p}{,}\PY{l+m+mi}{85}\PY{p}{]}\PY{p}{)}
        \PY{n}{tit}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{AMOC Anom Years }\PY{l+s+s1}{\PYZsq{}}\PY{o}{+}\PY{n+nb}{str}\PY{p}{(}\PY{n}{t1}\PY{p}{)}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{+}\PY{n+nb}{str}\PY{p}{(}\PY{n}{t2}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{tit}\PY{p}{)}
        
        \PY{n}{t1}\PY{o}{=}\PY{l+m+mi}{6}
        \PY{n}{t2}\PY{o}{=}\PY{l+m+mi}{10}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{224}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{pert\PYZus{}amoc}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}amoc}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{PiYG}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
        \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{pert\PYZus{}amoc}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}amoc}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.25}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{contour}\PY{p}{(}\PY{n}{yu\PYZus{}ocean}\PY{p}{,}\PY{n}{st\PYZus{}ocean}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{pert\PYZus{}amoc}\PY{p}{[}\PY{n}{t1}\PY{p}{:}\PY{n}{t2}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{\PYZhy{}}\PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{cntrl\PYZus{}amoc}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{p}{[}\PY{l+m+mf}{0.0}\PY{p}{,}\PY{p}{]}\PY{p}{,}\PY{n}{colors}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidths}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{invert\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1035))}
        \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Depth (m)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Latitude (\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}N)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{xlim}\PY{p}{(}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{30}\PY{p}{,}\PY{l+m+mi}{85}\PY{p}{]}\PY{p}{)}
        \PY{n}{tit}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{AMOC Anom Years }\PY{l+s+s1}{\PYZsq{}}\PY{o}{+}\PY{n+nb}{str}\PY{p}{(}\PY{n}{t1}\PY{p}{)}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{+}\PY{n+nb}{str}\PY{p}{(}\PY{n}{t2}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{tit}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{}plot time series of AMOC in z space}
        \PY{n}{T}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{14}\PY{p}{)}
        \PY{k}{print} \PY{n}{T}\PY{o}{.}\PY{n}{shape}
        
        
        \PY{c+c1}{\PYZsh{} do lower cell average between lats 55\PYZhy{}60N}
        \PY{n}{j1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{l+m+mi}{55}\PY{p}{)}
        \PY{n}{j2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{l+m+mi}{60}\PY{p}{)}
        \PY{n}{j1}\PY{o}{=}\PY{n}{j1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{j2}\PY{o}{=}\PY{n}{j2}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        
        \PY{n}{z1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{st\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{l+m+mi}{500}\PY{p}{)}
        \PY{n}{z1}\PY{o}{=}\PY{n}{z1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        
        \PY{n}{uc\PYZus{}cntrl50\PYZus{}psj} \PY{o}{=} \PY{n}{cntrl\PYZus{}amoc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}
        \PY{n}{uc\PYZus{}cntrl50\PYZus{}psj\PYZus{}bar} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{uc\PYZus{}cntrl50\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{uc\PYZus{}cntrl50\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{uc\PYZus{}cntrl50\PYZus{}psj\PYZus{}bar}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
        
        \PY{n}{uc\PYZus{}pert50\PYZus{}psj} \PY{o}{=} \PY{n}{pert\PYZus{}amoc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}
        \PY{n}{uc\PYZus{}pert50\PYZus{}psj\PYZus{}bar} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{uc\PYZus{}pert50\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{uc\PYZus{}pert50\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{uc\PYZus{}pert50\PYZus{}psj\PYZus{}bar}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{n}{uc\PYZus{}pert50\PYZus{}psj\PYZus{}ts}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{insert}\PY{p}{(}\PY{n}{uc\PYZus{}pert50\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{uc\PYZus{}cntrl50\PYZus{}psj\PYZus{}ts}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
        
        
        \PY{c+c1}{\PYZsh{} do lower cell average between lats 40\PYZhy{}45N}
        \PY{n}{j1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{l+m+mi}{30}\PY{p}{)}
        \PY{n}{j2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{l+m+mi}{35}\PY{p}{)}
        \PY{n}{j1}\PY{o}{=}\PY{n}{j1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{j2}\PY{o}{=}\PY{n}{j2}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        
        \PY{n}{uc\PYZus{}cntrl40\PYZus{}psj} \PY{o}{=} \PY{n}{cntrl\PYZus{}amoc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}
        \PY{n}{uc\PYZus{}cntrl40\PYZus{}psj\PYZus{}bar} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{uc\PYZus{}cntrl40\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{uc\PYZus{}cntrl40\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{uc\PYZus{}cntrl40\PYZus{}psj\PYZus{}bar}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
        
        \PY{n}{uc\PYZus{}pert40\PYZus{}psj} \PY{o}{=} \PY{n}{pert\PYZus{}amoc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}
        \PY{n}{uc\PYZus{}pert40\PYZus{}psj\PYZus{}bar} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{uc\PYZus{}pert40\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{uc\PYZus{}pert40\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{uc\PYZus{}pert40\PYZus{}psj\PYZus{}bar}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{n}{uc\PYZus{}pert40\PYZus{}psj\PYZus{}ts}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{insert}\PY{p}{(}\PY{n}{uc\PYZus{}pert40\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{uc\PYZus{}cntrl40\PYZus{}psj\PYZus{}ts}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} do lower cell average between lats 20\PYZhy{}25N}
        \PY{n}{j1}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{l+m+mi}{10}\PY{p}{)}
        \PY{n}{j2}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{argwhere}\PY{p}{(}\PY{n}{yt\PYZus{}ocean}\PY{o}{\PYZlt{}}\PY{l+m+mi}{15}\PY{p}{)}
        \PY{n}{j1}\PY{o}{=}\PY{n}{j1}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        \PY{n}{j2}\PY{o}{=}\PY{n}{j2}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}
        
        \PY{n}{uc\PYZus{}cntrl20\PYZus{}psj} \PY{o}{=} \PY{n}{cntrl\PYZus{}amoc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}
        \PY{n}{uc\PYZus{}cntrl20\PYZus{}psj\PYZus{}bar} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{uc\PYZus{}cntrl20\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{uc\PYZus{}cntrl20\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{uc\PYZus{}cntrl20\PYZus{}psj\PYZus{}bar}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
        
        \PY{n}{uc\PYZus{}pert20\PYZus{}psj} \PY{o}{=} \PY{n}{pert\PYZus{}amoc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{z1}\PY{p}{:}\PY{p}{,}\PY{n}{j1}\PY{p}{:}\PY{n}{j2}\PY{p}{]}
        \PY{n}{uc\PYZus{}pert20\PYZus{}psj\PYZus{}bar} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{n}{uc\PYZus{}pert20\PYZus{}psj}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{uc\PYZus{}pert20\PYZus{}psj\PYZus{}ts} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{uc\PYZus{}pert20\PYZus{}psj\PYZus{}bar}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{n}{uc\PYZus{}pert20\PYZus{}psj\PYZus{}ts}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{insert}\PY{p}{(}\PY{n}{uc\PYZus{}pert20\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{uc\PYZus{}cntrl20\PYZus{}psj\PYZus{}ts}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
        
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{211}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{uc\PYZus{}pert50\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{1.5}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{uc\PYZus{}cntrl50\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{55\PYZhy{}60\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}N}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{uc\PYZus{}pert40\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{1.5}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{uc\PYZus{}cntrl40\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{30\PYZhy{}35\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}N}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{uc\PYZus{}pert20\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mf}{1.5}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{uc\PYZus{}cntrl20\PYZus{}psj\PYZus{}ts}\PY{p}{,}\PY{n}{linestyle}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{10\PYZhy{}15\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{}N}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1035))}
        \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Transport (Sv)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Years}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}plt.xlim([\PYZhy{}75,85])}
        \PY{n}{tit}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{AMOC Upper Cell Z \PYZgt{} }\PY{l+s+s1}{\PYZsq{}} \PY{o}{+}\PY{n+nb}{str}\PY{p}{(}\PY{n}{st\PYZus{}ocean}\PY{p}{[}\PY{n}{z1}\PY{p}{]}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{tit}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k}{print} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{fh}\PY{p}{[}\PY{l+m+mi}{540}\PY{p}{:}\PY{l+m+mi}{1080}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)}
        \PY{k}{print} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{fh}\PY{p}{[}\PY{l+m+mi}{540}\PY{p}{:}\PY{l+m+mi}{1080}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{}Hov of Sea Ice Conc. in Southern Ocean}
        \PY{k}{print} \PY{n}{xt\PYZus{}ocean}\PY{p}{[}\PY{l+m+mi}{1040}\PY{p}{]}
        \PY{k}{print} \PY{n}{xt\PYZus{}ocean}\PY{p}{[}\PY{l+m+mi}{878}\PY{p}{]}
        
        \PY{n}{Ocean\PYZus{}File} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{CntrlDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{output5*/ice\PYZus{}month.nc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{ff}\PY{o}{=}\PY{n}{xr}\PY{o}{.}\PY{n}{open\PYZus{}mfdataset}\PY{p}{(}\PY{n}{Ocean\PYZus{}File}\PY{p}{,}\PY{n}{engine}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{netcdf4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{concat\PYZus{}dim}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{decode\PYZus{}times}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
        \PY{k}{print} \PY{n}{ff}\PY{o}{.}\PY{n}{CN}\PY{o}{.}\PY{n}{shape}
        \PY{n}{nyf\PYZus{}cn}\PY{o}{=}\PY{n}{ff}\PY{o}{.}\PY{n}{CN}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{878}\PY{p}{:}\PY{l+m+mi}{1040}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ct}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
        \PY{k}{print} \PY{n}{nyf\PYZus{}cn}\PY{o}{.}\PY{n}{shape}
        
        \PY{n}{Ocean\PYZus{}File} \PY{o}{=} \PY{n}{os}\PY{o}{.}\PY{n}{path}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{PertDir}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{output*/ice\PYZus{}month.nc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{ff}\PY{o}{=}\PY{n}{xr}\PY{o}{.}\PY{n}{open\PYZus{}mfdataset}\PY{p}{(}\PY{n}{Ocean\PYZus{}File}\PY{p}{,}\PY{n}{engine}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{netcdf4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{concat\PYZus{}dim}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{time}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{decode\PYZus{}times}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
        \PY{k}{print} \PY{n}{ff}\PY{o}{.}\PY{n}{CN}\PY{o}{.}\PY{n}{shape}
        \PY{n}{pert\PYZus{}cn}\PY{o}{=}\PY{n}{ff}\PY{o}{.}\PY{n}{CN}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{878}\PY{p}{:}\PY{l+m+mi}{1040}\PY{p}{]}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ct}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{mean}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{p}{)}
        \PY{k}{print} \PY{n}{pert\PYZus{}cn}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k}{print} \PY{n}{nyf\PYZus{}cn}\PY{o}{.}\PY{n}{shape}
        \PY{k}{print} \PY{n}{pert\PYZus{}cn}\PY{o}{.}\PY{n}{shape}
        \PY{n}{cn} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{concatenate}\PY{p}{(}\PY{p}{(}\PY{n}{nyf\PYZus{}cn}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{12}\PY{p}{,}\PY{p}{:}\PY{p}{]}\PY{p}{,}\PY{n}{pert\PYZus{}cn}\PY{p}{)}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
        \PY{k}{print} \PY{n}{cn}\PY{o}{.}\PY{n}{shape}
        
        \PY{n}{time} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{12}\PY{p}{,}\PY{l+m+mi}{192}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}print time}
        \PY{k}{print} \PY{n}{time}\PY{o}{.}\PY{n}{shape}
        
        \PY{k}{print} \PY{n}{xt\PYZus{}ocean}\PY{p}{[}\PY{l+m+mi}{1040}\PY{p}{]}
        \PY{k}{print} \PY{n}{xt\PYZus{}ocean}\PY{p}{[}\PY{l+m+mi}{878}\PY{p}{]}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{p}{(}\PY{l+m+mf}{9.5}\PY{p}{,}\PY{l+m+mi}{12}\PY{p}{)}\PY{p}{)}
        \PY{n}{x\PYZus{}formatter} \PY{o}{=} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{ticker}\PY{o}{.}\PY{n}{ScalarFormatter}\PY{p}{(}\PY{n}{useOffset}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
        
        \PY{n}{clev} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mf}{1.0}\PY{p}{,}\PY{l+m+mi}{11}\PY{p}{)}
        \PY{k}{print} \PY{n}{clev}
        
        \PY{n}{plt}\PY{o}{.}\PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{211}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{contourf}\PY{p}{(}\PY{n}{time}\PY{p}{,}\PY{n}{yt\PYZus{}ocean}\PY{p}{,}\PY{n}{cn}\PY{o}{.}\PY{n}{T}\PY{p}{,}\PY{n}{cmap}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{cm}\PY{o}{.}\PY{n}{CMRmap\PYZus{}r}\PY{p}{,}\PY{n}{levels}\PY{o}{=}\PY{n}{clev}\PY{p}{,}\PY{n}{extend}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{both}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{cb}\PY{o}{=}\PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{orientation}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{vertical}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{shrink} \PY{o}{=} \PY{l+m+mf}{0.7}\PY{p}{)}
        \PY{n}{cb}\PY{o}{.}\PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Concentration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}plt.contour(yu\PYZus{}ocean,potrho,np.mean(cntrl\PYZus{}gmoc[0:4,:,:],axis=0),levels=clev,colors=\PYZsq{}k\PYZsq{},linewidths=0.25)}
        \PY{c+c1}{\PYZsh{}plt.contour(yu\PYZus{}ocean,potrho,np.mean(cntrl\PYZus{}gmoc[0:4,:,:],axis=0),levels=[0.0,],colors=\PYZsq{}k\PYZsq{},linewidths=0.5)}
        \PY{c+c1}{\PYZsh{}plt.gca().invert\PYZus{}yaxis()}
        \PY{n}{plt}\PY{o}{.}\PY{n}{gca}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{yaxis}\PY{o}{.}\PY{n}{set\PYZus{}major\PYZus{}formatter}\PY{p}{(}\PY{n}{x\PYZus{}formatter}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{ylim}\PY{p}{(}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{75}\PY{p}{,}\PY{o}{\PYZhy{}}\PY{l+m+mi}{53}\PY{p}{)}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}plt.ylim((1037.5,1035))}
        \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Latitude (\PYZdl{}\PYZca{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{circ\PYZdl{})}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time (Months)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{c+c1}{\PYZsh{}plt.xlim([\PYZhy{}75,85])}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Strong/Shift Weddell Sea Sea Ice Concentration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    


    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
